Version 1
SubGoalCombiner SGC_AND
INITSECTION
DB_Dialogs(S_GOB_SecludedSpot_Goblin_b811fc94-bcd7-4be3-a53a-0663cbc16c34, (DIALOGRESOURCE)S_GOB_SecludedSpot_Goblin_5bfd5735-129c-4534-64e9-0832472aebba);

DB_SpotPlayers(S_GOB_SecludedSpot_Goblin_b811fc94-bcd7-4be3-a53a-0663cbc16c34, "GOB_SecludedSpot", NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);
DB_SpotPlayers_SpotTrigger(S_GOB_SecludedSpot_Goblin_b811fc94-bcd7-4be3-a53a-0663cbc16c34, "GOB_SecludedSpot", S_GOB_SecludedSpot_SpottingTrigger_6b7d0014-b923-4f23-bbf3-08ec1f1a26c5);
DB_SpotPlayers_SpotterIgnoreCantTalk(S_GOB_SecludedSpot_Goblin_b811fc94-bcd7-4be3-a53a-0663cbc16c34, "GOB_SecludedSpot");
DB_SpotPlayers_TargetIgnoreCantTalk(S_GOB_SecludedSpot_Goblin_b811fc94-bcd7-4be3-a53a-0663cbc16c34, "GOB_SecludedSpot");
DB_SpotPlayers_IncludeWildshapedPlayers(S_GOB_SecludedSpot_Goblin_b811fc94-bcd7-4be3-a53a-0663cbc16c34, "GOB_SecludedSpot");
DB_SpotPlayers_IncludeFollowers(S_GOB_SecludedSpot_Goblin_b811fc94-bcd7-4be3-a53a-0663cbc16c34, "GOB_SecludedSpot");
DB_SpotPlayers_IncludeSummons(S_GOB_SecludedSpot_Goblin_b811fc94-bcd7-4be3-a53a-0663cbc16c34, "GOB_SecludedSpot");

DB_SpotPlayers(S_GOB_SecludedSpot_Goblin_b811fc94-bcd7-4be3-a53a-0663cbc16c34, "GOB_SecludedSpot_AccessArea", NULL_00000000-0000-0000-0000-000000000000, NULL_00000000-0000-0000-0000-000000000000);
DB_SpotPlayers_SpotTrigger(S_GOB_SecludedSpot_Goblin_b811fc94-bcd7-4be3-a53a-0663cbc16c34, "GOB_SecludedSpot_AccessArea", S_GOB_SecludedSpot_AccessArea_4c6cfa95-d2c0-4c1f-abb5-a3ee61aca95a);
DB_SpotPlayers_Continuous(S_GOB_SecludedSpot_Goblin_b811fc94-bcd7-4be3-a53a-0663cbc16c34, "GOB_SecludedSpot_AccessArea");
DB_SpotPlayers_SpotterIgnoreCantTalk(S_GOB_SecludedSpot_Goblin_b811fc94-bcd7-4be3-a53a-0663cbc16c34, "GOB_SecludedSpot_AccessArea");
DB_SpotPlayers_TargetIgnoreCantTalk(S_GOB_SecludedSpot_Goblin_b811fc94-bcd7-4be3-a53a-0663cbc16c34, "GOB_SecludedSpot_AccessArea");
DB_SpotPlayers_IncludeWildshapedPlayers(S_GOB_SecludedSpot_Goblin_b811fc94-bcd7-4be3-a53a-0663cbc16c34, "GOB_SecludedSpot_AccessArea");
DB_SpotPlayers_IncludeFollowers(S_GOB_SecludedSpot_Goblin_b811fc94-bcd7-4be3-a53a-0663cbc16c34, "GOB_SecludedSpot_AccessArea");
DB_SpotPlayers_IncludeSummons(S_GOB_SecludedSpot_Goblin_b811fc94-bcd7-4be3-a53a-0663cbc16c34, "GOB_SecludedSpot_AccessArea");
KBSECTION
IF
FlagSet(GOB_Checkpoint_State_GainedAccess_46279ae3-9662-01b0-25a5-a46e1b80d057, NULL_00000000-0000-0000-0000-000000000000, _)
THEN
PROC_SpotPlayers_StopSpotting(S_GOB_SecludedSpot_Goblin_b811fc94-bcd7-4be3-a53a-0663cbc16c34, "GOB_SecludedSpot");
PROC_SpotPlayers_StopSpotting(S_GOB_SecludedSpot_Goblin_b811fc94-bcd7-4be3-a53a-0663cbc16c34, "GOB_SecludedSpot_AccessArea");

// If the goblin spots the player from the Festivities Area side he ignores them
PROC
PROC_SpotPlayers_Spotted(S_GOB_SecludedSpot_Goblin_b811fc94-bcd7-4be3-a53a-0663cbc16c34, "GOB_SecludedSpot_AccessArea", _Player)
AND
GetFlag(GOB_SecludedSpot_Ignore_04b8a841-fd7f-4297-81e1-79309dde071d, _Player, 0)
THEN
SetFlag(GOB_SecludedSpot_Ignore_04b8a841-fd7f-4297-81e1-79309dde071d, _Player);

//failling to start the dialog results in temprorarily hostility
PROC
PROC_SpotPlayers_Spotted(S_GOB_SecludedSpot_Goblin_b811fc94-bcd7-4be3-a53a-0663cbc16c34, "GOB_SecludedSpot", _Player)
AND
GetFlag(GOB_SecludedSpot_Ignore_04b8a841-fd7f-4297-81e1-79309dde071d, _Player, 0)
AND
QRY_IsPlayerActor(_Player)
AND
NOT QRY_StartDialog(GOB_SecludedSpot_Trespassing_9eb570dd-c45d-96a4-671c-805e1fecbb6c, S_GOB_SecludedSpot_Goblin_b811fc94-bcd7-4be3-a53a-0663cbc16c34, _Player)
THEN
PROC_SetRelationTemporaryHostile(S_GOB_SecludedSpot_Goblin_b811fc94-bcd7-4be3-a53a-0663cbc16c34, _Player);

//spotting non-player characters results in temporarily hostility
PROC
PROC_SpotPlayers_Spotted(S_GOB_SecludedSpot_Goblin_b811fc94-bcd7-4be3-a53a-0663cbc16c34, "GOB_SecludedSpot", _Player)
AND
GetFlag(GOB_SecludedSpot_Ignore_04b8a841-fd7f-4297-81e1-79309dde071d, _Player, 0)
AND
NOT QRY_IsPlayerActor(_Player)
THEN
PROC_SetRelationTemporaryHostile(S_GOB_SecludedSpot_Goblin_b811fc94-bcd7-4be3-a53a-0663cbc16c34, _Player);

// dialog was interrupted or ended with hostility (with the player potentially immediately fleeing) - restart spotting
IF
DialogEnded(GOB_SecludedSpot_Trespassing_9eb570dd-c45d-96a4-671c-805e1fecbb6c, _)
AND
GetFlag(GOB_Checkpoint_State_GainedAccess_46279ae3-9662-01b0-25a5-a46e1b80d057, NULL_00000000-0000-0000-0000-000000000000, 0)
THEN
PROC_SpotPlayers_RestartSpotting(S_GOB_SecludedSpot_Goblin_b811fc94-bcd7-4be3-a53a-0663cbc16c34, "GOB_SecludedSpot");

IF
AutomatedDialogEnded((DIALOGRESOURCE)GOB_SecludedSpot_AD_Warning_460a58a5-0ae9-0953-74d1-32efccd56ff6, _)
THEN
PROC_GOB_MakeFestivitiesAreaHostile();
ClearFlag(GOB_SecludedSpot_State_NeedToWarnCamp_7a2c87d3-e736-4a17-bb95-ae5c202a4688, S_GOB_SecludedSpot_Goblin_b811fc94-bcd7-4be3-a53a-0663cbc16c34);
EndTurn(S_GOB_SecludedSpot_Goblin_b811fc94-bcd7-4be3-a53a-0663cbc16c34);
EXITSECTION

ENDEXITSECTION
ParentTargetEdge "Act1"
