Version 1
SubGoalCombiner SGC_AND
INITSECTION
DB_TWN_BrewerData("Acid","Projectile_Belch_Acid_Brewer","TWN_DISTILLERY_UNLOCK_ACID");
DB_TWN_BrewerData("Cold","Projectile_Belch_Cold_Brewer","TWN_DISTILLERY_UNLOCK_COLD");
DB_TWN_BrewerData("Lightning","Projectile_Belch_Lightning_Brewer","TWN_DISTILLERY_UNLOCK_LIGHTNING");
DB_TWN_BrewerData("Thunder","Projectile_Belch_Lightning_Brewer","TWN_DISTILLERY_UNLOCK_LIGHTNING");
DB_TWN_BrewerData("Fire","Projectile_Belch_Fire_Brewer","TWN_DISTILLERY_UNLOCK_FIRE");
DB_TWN_BrewerData("Radiant","Projectile_Belch_Fire_Brewer","TWN_DISTILLERY_UNLOCK_FIRE");
DB_TWN_BrewerData("Poison","Projectile_Belch_Poison_Brewer","TWN_DISTILLERY_UNLOCK_POISON");
DB_TWN_BrewerData("Necrotic","Projectile_Belch_Necro_Brewer","TWN_DISTILLERY_UNLOCK_NECRO");
DB_TWN_BrewerData("Piercing","Zone_Belch_Physical_Brewer","TWN_DISTILLERY_UNLOCK_PHYSICAL");
DB_TWN_BrewerData("Bludgeoning","Zone_Belch_Physical_Brewer","TWN_DISTILLERY_UNLOCK_PHYSICAL");
DB_TWN_BrewerData("Slashing","Zone_Belch_Physical_Brewer","TWN_DISTILLERY_UNLOCK_PHYSICAL");

DB_TWN_BrewerComboData("Acid","TWN_DISTILLERY_UNLOCK_COLD");
DB_TWN_BrewerComboData("Acid","TWN_DISTILLERY_UNLOCK_LIGHTNING");
DB_TWN_BrewerComboData("Acid","TWN_DISTILLERY_UNLOCK_FIRE");
DB_TWN_BrewerComboData("Acid","TWN_DISTILLERY_UNLOCK_POISON");
DB_TWN_BrewerComboData("Cold","TWN_DISTILLERY_UNLOCK_ACID");
DB_TWN_BrewerComboData("Cold","TWN_DISTILLERY_UNLOCK_LIGHTNING");
DB_TWN_BrewerComboData("Cold","TWN_DISTILLERY_UNLOCK_FIRE");
DB_TWN_BrewerComboData("Cold","TWN_DISTILLERY_UNLOCK_POISON");
DB_TWN_BrewerComboData("Lightning","TWN_DISTILLERY_UNLOCK_ACID");
DB_TWN_BrewerComboData("Lightning","TWN_DISTILLERY_UNLOCK_COLD");
DB_TWN_BrewerComboData("Lightning","TWN_DISTILLERY_UNLOCK_FIRE");
DB_TWN_BrewerComboData("Lightning","TWN_DISTILLERY_UNLOCK_POISON");
DB_TWN_BrewerComboData("Thunder","TWN_DISTILLERY_UNLOCK_ACID");
DB_TWN_BrewerComboData("Thunder","TWN_DISTILLERY_UNLOCK_COLD");
DB_TWN_BrewerComboData("Thunder","TWN_DISTILLERY_UNLOCK_LIGHTNING");
DB_TWN_BrewerComboData("Thunder","TWN_DISTILLERY_UNLOCK_FIRE");
DB_TWN_BrewerComboData("Fire","TWN_DISTILLERY_UNLOCK_ACID");
DB_TWN_BrewerComboData("Fire","TWN_DISTILLERY_UNLOCK_COLD");
DB_TWN_BrewerComboData("Fire","TWN_DISTILLERY_UNLOCK_LIGHTNING");
DB_TWN_BrewerComboData("Fire","TWN_DISTILLERY_UNLOCK_POISON");
DB_TWN_BrewerComboData("Radiant","TWN_DISTILLERY_UNLOCK_ACID");
DB_TWN_BrewerComboData("Radiant","TWN_DISTILLERY_UNLOCK_COLD");
DB_TWN_BrewerComboData("Radiant","TWN_DISTILLERY_UNLOCK_LIGHTNING");
DB_TWN_BrewerComboData("Radiant","TWN_DISTILLERY_UNLOCK_POISON");
DB_TWN_BrewerComboData("Poison","TWN_DISTILLERY_UNLOCK_ACID");
DB_TWN_BrewerComboData("Poison","TWN_DISTILLERY_UNLOCK_COLD");
DB_TWN_BrewerComboData("Poison","TWN_DISTILLERY_UNLOCK_LIGHTNING");
DB_TWN_BrewerComboData("Poison","TWN_DISTILLERY_UNLOCK_FIRE");

DB_TWN_BrewerData_Cosmetic("TWN_DISTILLERY_UNLOCK_ACID","TWN_DISTILLERY_UNLOCK_ACID_SCENERY","d719da31-2c03-4cc0-fa73-230a17ea3366"); //ATM_Default_EV10_SCL_Distillery_Acid
DB_TWN_BrewerData_Cosmetic("TWN_DISTILLERY_UNLOCK_COLD","TWN_DISTILLERY_UNLOCK_COLD_SCENERY","790f9d40-7253-1510-ee2f-c93e41fea5ac"); //ATM_Default_EV10_SCL_Distillery_Cold
DB_TWN_BrewerData_Cosmetic("TWN_DISTILLERY_UNLOCK_FIRE","TWN_DISTILLERY_UNLOCK_FIRE_SCENERY","ccddc763-cd14-6836-b4e3-c01811cb0332"); //ATM_Default_EV10_SCL_Distillery_Fire
DB_TWN_BrewerData_Cosmetic("TWN_DISTILLERY_UNLOCK_LIGHTNING","TWN_DISTILLERY_UNLOCK_LIGHTNING_SCENERY","4ab62758-aa49-4936-e15b-bb3b9fb58152"); //ATM_Default_EV10_SCL_Distillery_Lightning
DB_TWN_BrewerData_Cosmetic("TWN_DISTILLERY_UNLOCK_NECRO","TWN_DISTILLERY_UNLOCK_NECRO_SCENERY","e1de61cc-101e-53df-40cf-98cb36a7eb9d"); //ATM_Default_EV10_SCL_Distillery_Necrotic
DB_TWN_BrewerData_Cosmetic("TWN_DISTILLERY_UNLOCK_POISON","TWN_DISTILLERY_UNLOCK_POISON_SCENERY","b60f77c8-620a-173c-3862-76acdda84fd8"); //ATM_Default_EV10_SCL_Distillery_Poison

ApplyStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5, "TWN_DISTILLERY_NUMB", -1.0,1,S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5);
ApplyStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5, "TWN_DISTILLERY_UNLOCK_PHYSICAL", -1.0,1,S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5);

DB_TWN_BrewerCombatVoiceBarks_Statuses("TWN_DISTILLERY_UNLOCK_PHYSICAL", (DIALOGRESOURCE)TWN_Distillery_PAD_Brewer_Physical_ce41ec30-aa73-f24a-7848-b86360776591);
DB_TWN_BrewerCombatVoiceBarks_Statuses("TWN_DISTILLERY_UNLOCK_FIRE", (DIALOGRESOURCE)TWN_Distillery_PAD_Brewer_Fire_83137f57-6004-8555-6315-89d8dbbc7766);
DB_TWN_BrewerCombatVoiceBarks_Statuses("TWN_DISTILLERY_UNLOCK_COLD", (DIALOGRESOURCE)TWN_Distillery_PAD_Brewer_Cold_41b6f1a8-f909-545e-b723-257a7ad96a5b);
DB_TWN_BrewerCombatVoiceBarks_Statuses("TWN_DISTILLERY_UNLOCK_LIGHTNING", (DIALOGRESOURCE)TWN_Distillery_PAD_Brewer_Lightning_3f8b1a82-43c4-c4d3-2ad5-9708694aee64);
DB_TWN_BrewerCombatVoiceBarks_Statuses("TWN_DISTILLERY_UNLOCK_POISON", (DIALOGRESOURCE)TWN_Distillery_PAD_Brewer_Poison_b5de2ce3-7f1e-3a12-b885-a088a8623e95);
DB_TWN_BrewerCombatVoiceBarks_Statuses("TWN_DISTILLERY_UNLOCK_ACID", (DIALOGRESOURCE)TWN_Distillery_PAD_Brewer_Acid_7a651d80-22a7-d144-4562-d4bf710ae443);
DB_TWN_BrewerCombatVoiceBarks_Statuses("TWN_DISTILLERY_UNLOCK_NECRO", (DIALOGRESOURCE)TWN_Distillery_PAD_Brewer_Necro_147af4e0-37bf-2f3b-e995-d28b5b6fddf6);
DB_TWN_BrewerCombatVoiceBarks_Statuses("TWN_DISTILLERY_FORCE_NECRO", (DIALOGRESOURCE)TWN_Distillery_PAD_Brewer_Necro_147af4e0-37bf-2f3b-e995-d28b5b6fddf6);
DB_TWN_BrewerCombatVoiceBarks_Statuses("TWN_DISTILLERY_DRUNK_02", (DIALOGRESOURCE)TWN_Distillery_PAD_Brewer_Drunk_190fe4c1-b330-b02b-04e6-9574d1599a21);
DB_TWN_BrewerCombatVoiceBarks_Statuses("TWN_DISTILLERY_DRUNK_03", (DIALOGRESOURCE)TWN_Distillery_PAD_Brewer_PassedOut_f6564059-bf3f-88cb-e84d-c5467ded2c4f);

DB_TWN_BrewerCombatVoiceBarks_Spells("Target_Summon_Brewer_Acid", (DIALOGRESOURCE)TWN_Distillery_PAD_Brewer_Hallucinating_0422705f-476c-d445-d425-e3d102be3c34);
DB_TWN_BrewerCombatVoiceBarks_Spells("Target_Summon_Brewer_Cold", (DIALOGRESOURCE)TWN_Distillery_PAD_Brewer_Hallucinating_0422705f-476c-d445-d425-e3d102be3c34);
DB_TWN_BrewerCombatVoiceBarks_Spells("Target_Summon_Brewer_Fire", (DIALOGRESOURCE)TWN_Distillery_PAD_Brewer_Hallucinating_0422705f-476c-d445-d425-e3d102be3c34);
DB_TWN_BrewerCombatVoiceBarks_Spells("Target_Summon_Brewer_Lightning", (DIALOGRESOURCE)TWN_Distillery_PAD_Brewer_Hallucinating_0422705f-476c-d445-d425-e3d102be3c34);
DB_TWN_BrewerCombatVoiceBarks_Spells("Target_Summon_Brewer_Poison", (DIALOGRESOURCE)TWN_Distillery_PAD_Brewer_Hallucinating_0422705f-476c-d445-d425-e3d102be3c34);

// Combat NPC Reactivity
DB_CombatReact_AD_AppliedStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5, (DIALOGRESOURCE)TWN_Distillery_AD_Brewer_Physical_Combat_84faadd5-d1fe-d96c-0ad7-1832caa28a3b, "TWN_DISTILLERY_UNLOCK_PHYSICAL");
DB_CombatReact_AD_AppliedStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5, (DIALOGRESOURCE)TWN_Distillery_AD_Brewer_Fire_Combat_e522ac4a-9fb5-4dff-9316-3c57ca6b8277, "TWN_DISTILLERY_UNLOCK_FIRE");
DB_CombatReact_AD_AppliedStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5, (DIALOGRESOURCE)TWN_Distillery_AD_Brewer_Cold_Combat_5d3f7d99-42f7-cded-4422-fdfbbc772d5b, "TWN_DISTILLERY_UNLOCK_COLD");
DB_CombatReact_AD_AppliedStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5, (DIALOGRESOURCE)TWN_Distillery_AD_Brewer_Lightning_Combat_a2a21fad-82ea-0a8d-f394-332a78ca7bdd, "TWN_DISTILLERY_UNLOCK_LIGHTNING");
DB_CombatReact_AD_AppliedStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5, (DIALOGRESOURCE)TWN_Distillery_AD_Brewer_Poison_Combat_6d8aa2e1-fc55-4079-6932-cabeda1d7300, "TWN_DISTILLERY_UNLOCK_POISON");
DB_CombatReact_AD_AppliedStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5, (DIALOGRESOURCE)TWN_Distillery_AD_Brewer_Acid_Combat_b3f15f90-3939-659f-d617-17ec65a3f155, "TWN_DISTILLERY_UNLOCK_ACID");
DB_CombatReact_AD_AppliedStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5, (DIALOGRESOURCE)TWN_Distillery_AD_Brewer_Necro_Combat_a33aed3f-d10a-d6d1-4bfd-c2b05097d7e1, "TWN_DISTILLERY_UNLOCK_NECRO");
DB_CombatReact_AD_AppliedStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5, (DIALOGRESOURCE)TWN_Distillery_AD_Brewer_Necro_Combat_a33aed3f-d10a-d6d1-4bfd-c2b05097d7e1, "TWN_DISTILLERY_FORCE_NECRO");
DB_CombatReact_AD_AppliedStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5, (DIALOGRESOURCE)TWN_Distillery_AD_Brewer_Drunk_002_Combat_a8a57b05-2861-d947-6b08-71139618f548, "TWN_DISTILLERY_DRUNK_02");
DB_CombatReact_AD_AppliedStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5, (DIALOGRESOURCE)TWN_Distillery_AD_Brewer_Drunk_003_Combat_5a7067b3-1de3-7f2a-0e68-37383341845e, "TWN_DISTILLERY_DRUNK_03");

DB_CombatReact_AD_OnCast(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5, (DIALOGRESOURCE)TWN_Distillery_AD_Brewer_Hallucinating_001_Combat_ca61ee49-aa76-ef1b-3e0a-97aea4efa0c7, "Target_Summon_Brewer_Acid");
DB_CombatReact_AD_OnCast(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5, (DIALOGRESOURCE)TWN_Distillery_AD_Brewer_Hallucinating_002_Combat_0d24b386-546e-946a-1efc-50d28f9b7169, "Target_Summon_Brewer_Cold");
DB_CombatReact_AD_OnCast(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5, (DIALOGRESOURCE)TWN_Distillery_AD_Brewer_Hallucinating_003_Combat_75048c32-7b16-cd03-5c08-f1aa6d438590, "Target_Summon_Brewer_Fire");
DB_CombatReact_AD_OnCast(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5, (DIALOGRESOURCE)TWN_Distillery_AD_Brewer_Hallucinating_004_Combat_e9d6996b-8a41-1e0c-4684-2f464f35815a, "Target_Summon_Brewer_Lightning");
DB_CombatReact_AD_OnCast(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5, (DIALOGRESOURCE)TWN_Distillery_AD_Brewer_Hallucinating_005_Combat_830bf8ce-9e6c-c2db-1c86-dc1d70631ee5, "Target_Summon_Brewer_Poison");
KBSECTION
//REGION Queries
QRY
QRY_TWN_Brewer_StatusChecks()
AND
HasActiveStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5,"TWN_DISTILLERY_NOTTHIRSTY",0)
AND
HasActiveStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5,"TWN_DISTILLERY_DRUNK_03",0)
AND
HasActiveStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5,"TWN_DISTILLERY_FORCE_NECRO",0)
AND
NOT DB_PermaDefeated(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5)
THEN
DB_NOOP(1); //this does nothing at all, we just need something after THEN

QRY
QRY_TWN_Brewer_StatusChecks_Elemental()
AND
HasActiveStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5,"TWN_DISTILLERY_UNLOCK_COLD",0)
AND
HasActiveStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5,"TWN_DISTILLERY_UNLOCK_LIGHTNING",0)
AND
HasActiveStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5,"TWN_DISTILLERY_UNLOCK_FIRE",0)
AND
HasActiveStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5,"TWN_DISTILLERY_UNLOCK_POISON",0)
AND
HasActiveStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5,"TWN_DISTILLERY_UNLOCK_ACID",0)
AND
HasActiveStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5,"TWN_DISTILLERY_UNLOCK_NECRO",0)
THEN
DB_NOOP(1);
//END_REGION

//REGION Belch unlocks
IF
AttackedBy(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5,_,_,_DamageType,_,_,_)
AND
QRY_TWN_Brewer_StatusChecks()
AND
QRY_TWN_Brewer_StatusChecks_Elemental()
AND
DB_TWN_BrewerData(_DamageType,_,_Status)
AND
HasActiveStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5,_Status,0)	//must not already have the status attached to that damagetype
THEN
ApplyStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5, _Status, -1.0,1,NULL_00000000-0000-0000-0000-000000000000);

//if u get attacked by physical, only get physical status if u have no elemental status on u
IF
AttackedBy(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5,_,_,_DamageType,_,_,_)
AND
QRY_TWN_Brewer_StatusChecks()
AND
QRY_TWN_Brewer_StatusChecks_Elemental()
AND
HasActiveStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5,"TWN_DISTILLERY_UNLOCK_PHYSICAL",0)
AND
DB_TWN_BrewerData(_DamageType,_,_)
THEN
ApplyStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5, "TWN_DISTILLERY_UNLOCK_PHYSICAL", -1.0,1,NULL_00000000-0000-0000-0000-000000000000);

//if u get attacked by elemental damagetype & u already have an elemental status, the mix goes bad
IF
AttackedBy(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5,_,_,_DamageType,_,_,_)
AND
HasActiveStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5, "TWN_DISTILLERY_FORCE_NECRO", 0)
AND
DB_TWN_BrewerComboData(_DamageType,_Status)
AND
HasActiveStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5,_Status,1)
THEN
ApplyStatus(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5, "TWN_DISTILLERY_FORCE_NECRO", -1.0,1,NULL_00000000-0000-0000-0000-000000000000); 	//you do need this; you need to lock the transformation

//END_REGION

//REGION Cosmetic
IF
StatusRemoved(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5,_BrewerStatus, _, _)
AND
DB_TWN_BrewerData_Cosmetic(_BrewerStatus,_PipeStatus,_)
THEN
RemoveStatus(S_DEC_Brewery_Distillery_E_c973780c-146c-4cbe-a55a-409457b733eb,_PipeStatus,NULL_00000000-0000-0000-0000-000000000000);
TriggerResetAtmosphere(S_TWN_AtmosphereTrigger_Distillery_13b9eed9-89f3-4b21-8605-f1418ffb3535); //ATM_BlightedArea_Town_02_811cb674-eba7-4708-a644-b0a57ff319e5

IF
StatusApplied(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5,_BrewerStatus, _, _)
AND
DB_TWN_BrewerData_Cosmetic(_BrewerStatus,_PipeStatus,_Atmosphere)
THEN
ApplyStatus(S_DEC_Brewery_Distillery_E_c973780c-146c-4cbe-a55a-409457b733eb,_PipeStatus, -1.0,1,NULL_00000000-0000-0000-0000-000000000000);
TriggerSetAtmosphere(S_TWN_AtmosphereTrigger_Distillery_13b9eed9-89f3-4b21-8605-f1418ffb3535,_Atmosphere);
//END_REGION

//REGION Combat Voice Barks
IF
CombatStarted(_CombatGuid)
AND
DB_Is_InCombat(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5, _CombatGuid)
AND
DB_Players(_Player)
AND
DB_Is_InCombat(_Player, _CombatGuid)
AND
NOT DB_CantTalk_IgnoreCombat(_Player)
AND
HasAppliedStatus(_Player, "TWN_DISTILLERY_DRANK_THRICE", 0)
AND
QRY_OnlyOnce("TWN_Distillery_CombatStarted")
THEN
PROC_TryStartAD(TWN_Distillery_PAD_Brewer_CombatStarted_4d8b7b84-c5f5-28bf-167a-42d20515ff84, _Player);

IF
StatusApplied(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5, _Status, _, _)
AND
DB_TWN_BrewerCombatVoiceBarks_Statuses(_Status, _Voicebark)
AND
DB_Is_InCombat(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5, _CombatGuid)
AND
DB_Players(_Player)
AND
DB_Is_InCombat(_Player, _CombatGuid)
AND
NOT DB_CantTalk_IgnoreCombat(_Player)
AND
GUIDToString(_Voicebark, _Result)
AND
QRY_OnlyOnce(_Result)
THEN
PROC_TryStartAD(_Voicebark, _Player);

IF
CastedSpell(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5, _Spell, _, _, _)
AND
DB_TWN_BrewerCombatVoiceBarks_Spells(_Spell, _Voicebark)
AND
DB_Is_InCombat(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5, _CombatGuid)
AND
DB_Players(_Player)
AND
DB_Is_InCombat(_Player, _CombatGuid)
AND
GUIDToString(_Voicebark, _Result)
AND
QRY_OnlyOnce(_Result)
THEN
PROC_TryStartAD(_Voicebark, _Player);
//END_REGION Combat Voice Barks

IF 
DB_PermaDefeated(S_TWN_Distillery_Brewer_4d9e3db3-9a78-4f4b-8101-1dd73c0f3be5)
THEN
RemoveStatus(S_DEC_Brewery_Distillery_E_c973780c-146c-4cbe-a55a-409457b733eb,"TWN_DISTILLERY_UNLOCK_ACID_SCENERY",NULL_00000000-0000-0000-0000-000000000000);
RemoveStatus(S_DEC_Brewery_Distillery_E_c973780c-146c-4cbe-a55a-409457b733eb,"TWN_DISTILLERY_UNLOCK_COLD_SCENERY",NULL_00000000-0000-0000-0000-000000000000);
RemoveStatus(S_DEC_Brewery_Distillery_E_c973780c-146c-4cbe-a55a-409457b733eb,"TWN_DISTILLERY_UNLOCK_FIRE_SCENERY",NULL_00000000-0000-0000-0000-000000000000);
RemoveStatus(S_DEC_Brewery_Distillery_E_c973780c-146c-4cbe-a55a-409457b733eb,"TWN_DISTILLERY_UNLOCK_LIGHTNING_SCENERY",NULL_00000000-0000-0000-0000-000000000000);
RemoveStatus(S_DEC_Brewery_Distillery_E_c973780c-146c-4cbe-a55a-409457b733eb,"TWN_DISTILLERY_UNLOCK_NECRO_SCENERY",NULL_00000000-0000-0000-0000-000000000000);
RemoveStatus(S_DEC_Brewery_Distillery_E_c973780c-146c-4cbe-a55a-409457b733eb,"TWN_DISTILLERY_UNLOCK_POISON_SCENERY",NULL_00000000-0000-0000-0000-000000000000);
//TriggerResetAtmosphere(REPLACE_ME);
GoalCompleted;
EXITSECTION

ENDEXITSECTION
ParentTargetEdge "Act2"
