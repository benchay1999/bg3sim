Version 1
SubGoalCombiner SGC_AND
INITSECTION
//REGION Player Init Block
DB_OriginNPCAlignment((CHARACTER)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, (FACTION)Origin_Laezel_bee8449b-d682-93c8-e7da-9e4bad369476);
DB_OriginCampFlags(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12,(FLAG)LAEZEL_488052ab-da0d-4463-9158-ab01eb89df86,(FLAG)LAEZELAVATAR_cea30880-6e09-4daa-ad17-5411885097f3,(FLAG)LAEZELCOMPANION_9c5bc0ce-cb2e-4685-b597-89a290837535,(FLAG)LAEZELPARTY_9359b6a5-5579-4c54-acf7-2e8b35726195,(FLAG)LAEZELCAMP_3a157c66-db4a-48ad-95e5-9659c42c4aa0);
DB_OriginInPartyGlobal((CHARACTER)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12,(FLAG)ORI_Laezel_State_IsInParty_3ee6b1f2-24f4-4e85-b7dc-49060e6d2699);
DB_OriginPartOfTheTeamFlag((CHARACTER)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, (FLAG)GLO_Origin_PartOfTheTeam_Laezel_57d93a1d-4400-4307-845f-25d9a250d332,(FLAG)GLO_Origin_Avatar_Laezel_ecbab7a6-0a96-4c30-81d1-f70cc960b749, (FLAG)ORI_Laezel_ControlledByUser_8fe9c9e8-0885-4e69-ac41-e3f3d29d4349);
DB_OriginKickFromPartyFlags((CHARACTER)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, (FLAG)ORI_Laezel_Event_KickCompanion_e032a76b-4966-4fd8-a290-90c76ff1e30a, (FLAG)ORI_Laezel_State_CanBeKicked_b28fa32b-a878-49ba-860b-e44774908595);

DB_OriginRecruitmentDialog((CHARACTER)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12,(DIALOGRESOURCE)Laezel_Recruitment_InCage_131cf573-180d-5307-6d6e-6a369319e161); //Laezel_Recruitment_a914c64a-30d8-0428-683a-99dd7879fc83

DB_OriginInPartyDialog((CHARACTER)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, TUT_Start_Laezel_c62d7e26-beb5-0afe-becd-68a25c7f4314);
//DB_OriginInPartyDialog((CHARACTER)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, Laezel_InParty_93bf58f5-5111-9730-1ee2-62dfb0b00c96);
DB_OriginWarning1Dialog(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12,Laezel_Warning1_2cc7736e-4af6-4235-870f-6b53cf04ae8e);
DB_OriginWarning2Dialog(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12,Laezel_Warning2_78bc67a3-2fa8-a019-eb08-50c56a8f7757);
DB_OriginLeavingDialog(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12,Laezel_Leaving_70e20de2-7314-a9ae-e5a2-be50225f97b1);

DB_Inclusion_Object((GUIDSTRING)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12,(FLAG)ORI_Inclusion_Laezel_49c3c048-b5f7-466c-a996-d87cef44dde9,(FLAG)ORI_Inclusion_End_Laezel_dcf82fba-01b2-44f1-acf6-64254ad40007);

DB_Debug_CharacterAddFlags((FLAG)Debug_AddGith_39ecbda9-cb44-becf-57b9-c3b631a5517b, (CHARACTER)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12,(FLAG)Debug_GithIsPlayer_35795c8f-0daa-5972-e4a0-85f35af25026);
DB_Debug_CharacterRemoveHideFlags((FLAG)Debug_RemoveHideGith_7953fece-dcf5-658b-38b5-58d5d2900824, (CHARACTER)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);

DB_CompanionCanPartner((CHARACTER)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12,(FLAG)ORI_State_DatingLaezel_86eaa84a-350b-401b-8b43-b53eeb534579, (FLAG)ORI_State_PartneredWithLaezel_d169a786-6e56-4f0d-a2eb-33c48d8d1160, (FLAG)ORI_State_WasPartneredWithLaezel_6d402d9b-7af9-43ea-b0eb-98e9612dde27, (FLAG)ORI_State_HandledBreakupWithLaezel_76f44c15-bcc3-4232-9dde-ae522a3db82d, ORI_State_ChosePartnerOverLaezel_35c95a6d-4145-4903-ad73-a773df0e6892, "datelaezel");
DB_CompanionIsDating((CHARACTER)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, (FLAG)ORI_State_LaezelIsDating_1ed37dec-5bd7-489b-bcc4-5185b12918fb);
//END_REGION
/*
//REGION Leave Party Journal Entries
DB_QuestDef_State_CompanionLeft((TAG)REALLY_LAEZEL_b5682d1d-c395-489c-9675-1f9b0c328ea5, "ORI_COM_Laezel", "CompanionHostile");
DB_QuestDef_State_CompanionLeft((TAG)REALLY_LAEZEL_b5682d1d-c395-489c-9675-1f9b0c328ea5, "ORI_COM_Laezel", "CompanionLowRelation");
DB_QuestDef_State_CompanionLeft((TAG)REALLY_LAEZEL_b5682d1d-c395-489c-9675-1f9b0c328ea5, "ORI_COM_Laezel", "CompanionMurdered");
//END_REGION
*/
//REGION Laezel Specific
DB_PermaDefeatedFlag(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12,(FLAG)GLO_Laezel_State_PermaDefeated_43c2fc09-a064-42a9-a722-444b53a768fd);
//END_REGION
/*
//REGION Journal
//Shared
DB_ORI_Laezel_Quests(0, "ORI_COM_Laezel");

DB_ORI_Laezel_SharedQuestEntries((FLAG)ORI_Laezel_Quest_AskedZevlorAboutZorru_aa2a0127-dd70-45c1-bf18-53f0493031ba,"AskedZevlorAboutZorru");
DB_ORI_Laezel_SharedQuestEntries((FLAG)ORI_Laezel_Quest_GotNoInfoFromZorru_2780a235-1089-4135-aa37-6fa03a0467a8,"GotNoInfoFromZorru");
DB_ORI_Laezel_SharedQuestEntries((FLAG)ORI_Laezel_Quest_ZorruLeft_f2a667a1-b1c9-4ead-97c3-54cccf099462,"ZorruLeft");
DB_ORI_Laezel_SharedQuestEntries((FLAG)ORI_Laezel_Quest_ZorruDied_8eb5ece3-b2fb-4818-a924-a4b2f2d36e74,"ZorruDied");
DB_ORI_Laezel_SharedQuestEntries((FLAG)ORI_Laezel_Quest_ZorruPointedWay_f4e84bd1-3352-8545-3c53-9fa62591f5c0, "ZorruPointedWay"); //avatar only
DB_ORI_Laezel_SharedQuestEntries((FLAG)ORI_Laezel_Quest_ZorruMarkedMap_4a9b6719-5f2d-7938-4dde-46605707981f, "ZorruMarkedMap");
DB_ORI_Laezel_SharedQuestEntries((FLAG)ORI_Laezel_Quest_TalkedToDeadTiefling_2dcfd3d8-d17d-461d-acf6-652940194202, "TalkedToDeadTiefling");
DB_ORI_Laezel_SharedQuestEntries((FLAG)ORI_Laezel_Quest_SawDragonRider_b82787bc-316b-417a-ae95-a1abc1f7116a,"SawDragonRider");
DB_ORI_Laezel_SharedQuestEntries((FLAG)ORI_Laezel_Quest_ReadCrecheMap_1b3d8286-1f36-a091-bc54-0803e961279e,"ReadCrecheMap");
//DB_ORI_Laezel_SharedQuestEntries(ORI_Laezel_Quest_,"");

//DEN
DB_ORI_Laezel_PreZorru("RecruitedLaezel"); //COM
DB_ORI_Laezel_PreZorru("RecruitedLaezelGrove"); //COM
DB_ORI_Laezel_PreZorru("AskedZevlorAboutZorru"); //COM and AVATAR
DB_ORI_Laezel_PreZorru("FoundZorruLZAbsent"); //COM
DB_ORI_Laezel_PreZorru("LaezelStarts"); //AVATAR
DB_ORI_Laezel_PreZorru("SawKid"); //AVATAR
PROC_GlobalSetFlagAndCache(ORI_Laezel_State_CaringAboutZorru_05c85d1f-11e6-4219-a047-901b958c3578);

//PLA
//DB_ORI_Laezel_ChokepointOutcome(_CombatHappened, _VossToldCreche, _COMLaezelStep, _GLOTadpoleStep); //TODO/TBD: link properly to Gith Creche / Lae'zel Avatar
DB_ORI_Laezel_ChokepointOutcome(0, 0, "ResolvedPeaceNoCreche", "GithChokepointEnded");
DB_ORI_Laezel_ChokepointOutcome(0, 1, "ResolvedPeaceCreche", "LearnedCreche");
DB_ORI_Laezel_ChokepointOutcome(1, 0, "ChokepointDefeated", "GithChokepointEnded");
DB_ORI_Laezel_ChokepointOutcome(1, 1, "ChokepointDefeated", "GithChokepointEnded");
//END_REGION
*/
//REGION Camp Setup
DB_ORI_OriginCampData((CHARACTER)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, "WLDMAIN", (TRIGGER)S_CAMP_Laezel_A_8d410b28-5270-80e3-1cb8-c9036fc8383b);
DB_ORI_OriginCampData((CHARACTER)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, "WLDCAVGRN", (TRIGGER)S_CAMP_Laezel_A_d2e138b5-935e-8b25-060a-9797da87754b);
DB_ORI_OriginCampData((CHARACTER)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, "WLDCAVSND", (TRIGGER)S_CAMP_Laezel_A_349fdec8-b9c4-8f22-34dd-522f050a0bfb);
DB_ORI_OriginCampData((CHARACTER)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, "WLDDUNABB", (TRIGGER)S_CAMP_Laezel_A_aff47ac4-9013-8a57-1348-9d840d699685);
DB_ORI_OriginCampData((CHARACTER)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, "WLDDUNSHA", (TRIGGER)S_CAMP_Laezel_A_e67329ac-dac5-896b-0704-ac15d952e24c);
DB_ORI_OriginCampData((CHARACTER)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, "WLDBAS", (TRIGGER)S_CAMP_Laezel_A_155372b6-4adf-8c59-025a-6aeebb22b76f);
DB_ORI_OriginCampData((CHARACTER)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, "WLDUND", (TRIGGER)S_CAMP_Laezel_A_175b52c4-efc4-879a-0e96-7d0d1f250fa2);
//END_REGION

//Knowing the Creche's location (particularly important for Lae'zel, but could be moved to another goal)
DB_GLO_CompoundFlag(PLA_GithChokepoint_State_VossRevealedLocation_8e527ca3-eb01-4fe3-acb3-231c8ad18fcb, GLO_GithCreche_Knows_Location_ff285172-c1a0-698d-981f-1b0530e72464);
DB_GLO_CompoundFlag(GLO_GithChokepoint_Knows_DecipheredMap_604768b9-c983-414d-8c3b-ba1dee3da387, GLO_GithCreche_Knows_Location_ff285172-c1a0-698d-981f-1b0530e72464);
DB_GLO_CompoundFlag(GLO_GithCreche_State_EverEnteredBefore_3ebdfeaa-4e83-4878-90db-01adb9fdf629, GLO_GithCreche_Knows_Location_ff285172-c1a0-698d-981f-1b0530e72464);

//PROC_ORI_COM_Laezel_InitJournal();
KBSECTION
//REGION Move to Camp

IF
TextEvent("detachlz")
THEN
DetachFromPartyGroup(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);

//Debug
IF
TextEvent("laezel2camp")
AND
GetHostCharacter(_Player)
THEN
SetFlag(ORI_LaezelRecruitment_Event_InvitedToCamp_5ac352a5-58c2-a8ed-1957-199d8bc284da, NULL_00000000-0000-0000-0000-000000000000, 0);
SetOnStage(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, 1);
PROC_CheckFirstTimeRecruited((CHARACTER)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);
RegisterAsCompanion(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12,(CHARACTER)_Player);
PROC_ORI_SetupCamp((CHARACTER)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, 1);

IF
EntityEvent((CHARACTER)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12,"DebugTeleportedToCamp")
AND
GetHostCharacter(_Player)
THEN
SetFlag(ORI_LaezelRecruitment_Event_InvitedToCamp_5ac352a5-58c2-a8ed-1957-199d8bc284da, NULL_00000000-0000-0000-0000-000000000000, 0);
PROC_CheckFirstTimeRecruited((CHARACTER)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);
RegisterAsCompanion(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12,(CHARACTER)_Player);
PROC_ORI_SetupCamp((CHARACTER)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, 1);


//Invited to camp
IF
FlagSet(ORI_LaezelRecruitment_Event_InvitedToCamp_5ac352a5-58c2-a8ed-1957-199d8bc284da, NULL_00000000-0000-0000-0000-000000000000, _ID)
AND
_ID != 0
THEN
DB_ORI_ToCampAfterDialog(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _ID, "Run");

PROC
PROC_ORI_SendToCampAfterDialog(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _, _, _)
THEN
SetCanJoinCombat(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, 0);

IF
EntityEvent(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, "ORI_ToCamp")
THEN
SetCanJoinCombat(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, 1);

PROC
PROC_GLO_PartyMembers_AddHook((CHARACTER)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12,(CHARACTER)_Player)
AND
QRY_OnlyOnce("RecruitedFirstTime_Laezel")
THEN
PROC_ORI_SetupCamp((CHARACTER)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, 0);
SetFlag((FLAG)ORI_Laezel_HasMet_2e085b0e-8e64-fbad-a009-7ce8e5da8a11, NULL_00000000-0000-0000-0000-000000000000, 0);

//END_REGION

//REGION Queries

QRY
QRY_ORI_Laezel_COM_InCampOrParty()
AND
DB_InCamp(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12)
AND
NOT DB_PermaDefeated(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12)
THEN
DB_NOOP(1);

QRY
QRY_ORI_Laezel_COM_InCampOrParty()
AND
DB_Players(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12)
AND
NOT DB_Avatars(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12)
THEN
DB_NOOP(1);

//END_REGION
/*
//REGION Journal: COM

PROC
PROC_ORI_COM_Laezel_InitJournal()
THEN
DB_ORI_COM_Laezel_GroveLocation((FLAG)DEN_General_State_Entered_26b2dc6a-e5eb-4d99-a4bd-3ecaa3b86a9e);
DB_ORI_COM_Laezel_GroveLocation((FLAG)CHA_LaezelRecruitment_Event_RevealedGroveLocation_30d1c7ea-8377-d7ce-f5ba-fa9d03a19594);


//--- Act1 - CHA
//Start. With Map marker if the Grove is known.
//note: A PLA version also exists and is set in Laezel_Recruitment_Plains
PROC
PROC_CHA_LaezelRecruit_GiveRecruitedUpdate((CHARACTER)_Player)
AND
DB_GlobalFlag(ORI_Laezel_State_CaringAboutZorru_05c85d1f-11e6-4219-a047-901b958c3578) // if not caring about Zorru, entry 'RecruitedLaezelNoZorru' is set in dialog
AND
NOT QRY_ORI_COM_Laezel_StartWithMarker(_Player)
THEN
QuestUpdate(_Player, "ORI_COM_Laezel", "RecruitedLaezel"); //also set in Laezel_Recruitment when inviting LZ to camp.

QRY
QRY_ORI_COM_Laezel_StartWithMarker((CHARACTER)_Player)
AND
DB_ORI_COM_Laezel_GroveLocation(_Flag)
AND
DB_GlobalFlag(_Flag)
THEN
QuestUpdate(_Player, "ORI_COM_Laezel", "RecruitedLaezelGrove");


//--- Act1 - PLA
//Left party to go to knight
PROC
PROC_PLA_GithChokepoint_LaezelRunToKnight((CHARACTER)_Avatar)
AND
DB_Avatars(_Avatar)
THEN
QuestUpdate(_Avatar, "ORI_COM_Laezel", "LaezelRanToKnight");

//Gith Chokepoint - combat
PROC
PROC_GLO_GithChokepoint_Outcome(0)
AND
QRY_GetBestAvatarForCompanion(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12)
AND
DB_QRYRTN_GetBestAvatarForCompanion(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12,_Avatar)
THEN
QuestUpdate(_Avatar, "ORI_COM_Laezel", "ChokepointCombatStarted");

//Gith Chokepoint - combat ends, or was avoided 
PROC
PROC_PLA_GithChokepoint_CheckStartWRD()
AND
GetFlag(PLA_GithChokepoint_Event_AllGithsDefeated_b329e2d8-31c8-4861-ae87-224e86f51682, NULL_00000000-0000-0000-0000-000000000000, _CombatHappened)
AND
GetFlag(PLA_GithChokepoint_State_VossRevealedLocation_8e527ca3-eb01-4fe3-acb3-231c8ad18fcb, NULL_00000000-0000-0000-0000-000000000000, _VossToldCreche)
AND
DB_ORI_Laezel_ChokepointOutcome(_CombatHappened, _VossToldCreche, _COMLaezelStep, _GLOTadpoleStep)
THEN
PROC_ORI_Laezel_TryUpdateChokepointCOM(_COMLaezelStep);
QuestUpdate("GLO_Tadpole", _GLOTadpoleStep); //Update GLO_Tadpole

PROC
PROC_ORI_Laezel_TryUpdateChokepointCOM((STRING)_COMLaezelStep) //Update ORI_COM_Laezel
AND
DB_QuestIsOpened("ORI_COM_Laezel") //will avoid updating Lae'zel's quest silently before recruiting her at the Gith Chokepoint
THEN
QuestUpdate("ORI_COM_Laezel", _COMLaezelStep);

PROC
PROC_PLA_GithChokepoint_CheckStartWRD()
AND
DB_ORI_Laezel_ChokepointOutcome(_CombatHappened, _VossToldCreche, _COMLaezelStep, _GLOTadpoleStep)
THEN
NOT DB_ORI_Laezel_ChokepointOutcome(_CombatHappened, _VossToldCreche, _COMLaezelStep, _GLOTadpoleStep);
//END_REGION

//REGION Journal: shared

IF
FlagSet(_QuestFlag,_,_)
AND
DB_ORI_Laezel_SharedQuestEntries(_QuestFlag, _EntryID)
AND
IsTagged(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, AVATAR_306b9b05-1057-4770-aa17-01af21acd650, _IsAvatar)
AND
DB_ORI_Laezel_Quests(_IsAvatar, _QuestID)
AND
QuestUpdateExists(_QuestID, _EntryID, 1)
THEN
QuestUpdate(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12,_QuestID,_EntryID);


//--- Act1 - DEN
// Talking to Zorru as a githyanki, while LZ is not there
IF
FlagSet(GLO_GithChokepoint_Knows_NearMountain_d68476c7-5ff8-b054-a117-0ef2553e7855, NULL_00000000-0000-0000-0000-000000000000, _Inst)
AND
DB_DialogNPCs(_Inst,S_DEN_Tiefling_011_77439e86-3f60-4456-bd55-931e2f45654f,_)
AND
DB_DialogPlayers(_Inst,_Player,1)
AND
DB_QuestIsOpened("ORI_COM_Laezel") //TODO: handle avatar version
AND
DB_QuestIsOpened("GLO_Tadpole_SUB_Creche")
THEN
QuestUpdate((CHARACTER)_Player,"ORI_COM_Laezel","ZorruMarkedMap");
QuestUpdate((CHARACTER)_Player,"GLO_Tadpole","TieflingToldCreche");


// OM with Zorru ended without getting an update
PROC
PROC_DEN_ThingLikeMe_OMEndedJournalHook()
AND
GetFlag(ORI_Laezel_Quest_ZorruMarkedMap_4a9b6719-5f2d-7938-4dde-46605707981f, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, 0)
AND
GetFlag(ORI_Laezel_Quest_ZorruPointedWay_f4e84bd1-3352-8545-3c53-9fa62591f5c0, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, 0)
THEN
SetFlag(ORI_Laezel_Quest_GotNoInfoFromZorru_2780a235-1089-4135-aa37-6fa03a0467a8, S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);


// Checking if Zorru is still an important step
IF
QuestUpdateUnlocked(_,_Quest,_StateID)
AND
DB_ORI_Laezel_Quests(_,_Quest)
AND
NOT DB_ORI_Laezel_PreZorru(_StateID)
AND
DB_GlobalFlag(ORI_Laezel_State_CaringAboutZorru_05c85d1f-11e6-4219-a047-901b958c3578)
THEN
PROC_ORI_Laezel_StopCaringAboutZorru();

PROC
PROC_ORI_Laezel_StopCaringAboutZorru()
THEN
PROC_GlobalClearFlagAndCache(ORI_Laezel_State_CaringAboutZorru_05c85d1f-11e6-4219-a047-901b958c3578);
ShowMapMarker(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12,"ORI_Laezel_DENZorru",0);

PROC
PROC_ORI_Laezel_StopCaringAboutZorru()
AND
DB_ORI_Laezel_PreZorru(_StateID)
THEN
NOT DB_ORI_Laezel_PreZorru(_StateID);


// Got info about githyanki (either Zorru (DEN_General_TieflingGuard11) or the dead tiefling (FOR_SchoolOgre_Corpse_Dead)) before starting LZ's quest
IF
FlagSet(GLO_GithChokepoint_Knows_NearMountain_d68476c7-5ff8-b054-a117-0ef2553e7855, NULL_00000000-0000-0000-0000-000000000000, _)
AND
NOT DB_QuestIsOpened("ORI_COM_Laezel")
AND
DB_GlobalFlag(ORI_Laezel_State_CaringAboutZorru_05c85d1f-11e6-4219-a047-901b958c3578)
THEN
PROC_ORI_Laezel_StopCaringAboutZorru();


// Zorru died
IF
FlagSet(ORI_Laezel_Quest_SawDeadZorru_10783903-034f-41be-ad6a-e2cbbb73242a, NULL_00000000-0000-0000-0000-000000000000, _)
AND
DB_GlobalFlag(ORI_Laezel_State_CaringAboutZorru_05c85d1f-11e6-4219-a047-901b958c3578)
THEN
PROC_ORI_Laezel_StopCaringAboutZorru();
SetFlag(ORI_Laezel_Quest_ZorruDied_8eb5ece3-b2fb-4818-a924-a4b2f2d36e74,S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12);


// Zorru left

//--- Reading creche map
IF
FlagSet(GLO_GithChokepoint_Knows_DecipheredMap_604768b9-c983-414d-8c3b-ba1dee3da387, NULL_00000000-0000-0000-0000-000000000000, _Inst)
AND
NOT DB_GlobalFlag(GLO_GithCreche_State_EverEnteredBefore_3ebdfeaa-4e83-4878-90db-01adb9fdf629)
AND
DB_DialogPlayers(_Inst,_Player,_)
THEN
SetFlag((FLAG)ORI_Laezel_Quest_ReadCrecheMap_1b3d8286-1f36-a091-bc54-0803e961279e, _Player);

//END_REGION
*/
//REGION Banter condition

//PB_Shadowheart_Laezel_Gale_Creche
//Condition: Lae'zel's creche goal has been established, but they have not reached it yet.
IF
FlagSet(ORI_Laezel_Knows_SeekingCreche_8c71d8b1-0b3d-74ee-2907-67b052538212,_,_)
THEN
SetFlag(ORI_Banter_State_AllowLaezelCreche_19a5ebc9-0c4c-4e6c-b654-d23a89ddf156,NULL_00000000-0000-0000-0000-000000000000);

IF
FlagSet(GLO_GithCreche_State_EverEnteredBefore_3ebdfeaa-4e83-4878-90db-01adb9fdf629,_,_)
THEN
ClearFlag(ORI_Banter_State_AllowLaezelCreche_19a5ebc9-0c4c-4e6c-b654-d23a89ddf156,NULL_00000000-0000-0000-0000-000000000000);

IF
DB_Is_InCombat(S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, _ID)
AND
NOT DB_GlobalFlag(ORI_Laezel_Event_FirstCombat_def8ed0f-1bdf-4134-9412-d71ce2e33f75)
THEN
SetFlag(ORI_Laezel_Event_FirstCombat_def8ed0f-1bdf-4134-9412-d71ce2e33f75, NULL_00000000-0000-0000-0000-000000000000);
//END_REGION

//REGION Laezel origin dialog change after tutorial
PROC
PROC_LevelLoadedOnce("WLD_Main_A")
THEN
NOT DB_OriginInPartyDialog((CHARACTER)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, TUT_Start_Laezel_c62d7e26-beb5-0afe-becd-68a25c7f4314);
DB_OriginInPartyDialog((CHARACTER)S_Player_Laezel_58a69333-40bf-8358-1d17-fff240d7fb12, Laezel_InParty_93bf58f5-5111-9730-1ee2-62dfb0b00c96);
//END_REGION
EXITSECTION

ENDEXITSECTION
ParentTargetEdge "ModWrapper_Gustav"
