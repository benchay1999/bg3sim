Version 1
SubGoalCombiner SGC_AND
INITSECTION
//REGION Player Init Block
DB_OriginNPCAlignment((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, (FACTION)Origin_Wyll_ca92900a-f1b8-443f-885b-c64c1047a423);
DB_OriginCampFlags(S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(FLAG)WYLL_042ed775-0b10-4d41-a4f5-b31e6f144206,(FLAG)WYLLAVATAR_b0d1be97-c501-4a9d-8718-e473210a4694,(FLAG)WYLLCOMPANION_665d86c4-8be9-443f-babb-ae87e3860925,(FLAG)WYLLPARTY_9be726fe-ca22-4fcc-9e20-13be65e7c42d,(FLAG)WYLLCAMP_eaa2fd2e-9a90-4aae-b730-b1af09fda864);
DB_OriginInPartyGlobal((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(FLAG)ORI_Wyll_State_IsInParty_3c0972ef-d7a4-46ac-abdd-0ce6aadd61b0);
DB_OriginPartOfTheTeamFlag((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, (FLAG)GLO_Origin_PartOfTheTeam_Wyll_24e24ca7-3446-440b-b645-19404845e108,(FLAG)GLO_Origin_Avatar_Wyll_4a2d36e6-e036-48dd-9c89-b99a19c053a0, (FLAG)ORI_Wyll_ControlledByUser_6c8a69c4-5c99-45c0-8fb8-6e8f913a9309);
DB_OriginKickFromPartyFlags((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, (FLAG)ORI_Wyll_Event_KickCompanion_8658c26f-a2ae-4a74-9e45-a7a6e75d6ac5, (FLAG)ORI_Wyll_State_CanBeKicked_69d92e21-833d-4bfc-86ab-00ef45683b6f);

SetFlag(ORI_Wyll_State_Alive_1b20bb3c-71a5-4766-9b70-097cf5866ed7);

DB_OriginRecruitmentDialog(S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, (DIALOGRESOURCE)Wyll_Recruitment_ToCave_c1a67c7e-ef27-417c-6ef8-ee4af60860cb);

DB_OriginInPartyDialog(S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, (DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6);
DB_OriginWarning1Dialog(S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, (DIALOGRESOURCE)Wyll_Warning1_537849cc-e615-499a-cf3d-16cd275e68d4);
DB_OriginWarning2Dialog(S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, (DIALOGRESOURCE)Wyll_Warning2_fdb9d889-79f2-2a9b-a348-3ca5ed6c2e68);
DB_OriginLeavingDialog(S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, (DIALOGRESOURCE)Wyll_Leaving_2bea3171-2abb-e19a-97b6-711a5309fd85);

DB_Inclusion_Object(S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(FLAG)ORI_Inclusion_Wyll_31aca0be-c868-47bb-a1c2-601ff756b863,(FLAG)ORI_Inclusion_End_Wyll_51c81a82-b1f7-4cb4-b6a9-abe16240bdd4);
//Not used anywhere?:
DB_Inclusion_Object(S_GLO_Wyll_Cambion_491a7686-3081-405b-983c-289ec8781e0a,(FLAG)ORI_Wyll_Cambion_StartInclusion_617df43c-a25c-408f-a136-1e73b297d5f8,(FLAG)ORI_Wyll_Cambion_EndInclusion_75bc987c-d6a8-4a29-838c-7e674a27c4c3);

DB_Debug_CharacterAddFlags((FLAG)Debug_AddWyll_c84c0e41-3ee5-4ff9-8163-65966c6a5b6a,(CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(FLAG)Debug_WyllIsPlayer_a8067900-c9e6-43b6-853f-dce931d917f4);
DB_Debug_CharacterRemoveHideFlags((FLAG)Debug_RemoveHideWyll_264f4e38-1272-1b8e-1305-7a0b46ff8c11,(CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d);

DB_CompanionCanPartner((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(FLAG)ORI_State_DatingWyll_f1520748-1d36-4500-9f8a-0da4207f8dd5, (FLAG)ORI_State_PartneredWithWyll_5db4c1b6-3c42-43ae-aa85-1844acbf5a1d, (FLAG)ORI_State_WasPartneredWithWyll_2652ff35-a62d-4947-b14b-11050ccfd329, (FLAG)ORI_State_HandledBreakupWithWyll_3657b39e-6766-4395-bb97-d85aae0ca279, (FLAG)ORI_State_ChosePartnerOverWyll_f0b08362-76b7-4cf9-bd01-874fc1d8bf1c, "datewyll");
DB_CompanionIsDating((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, (FLAG)ORI_State_WyllIsDating_f7a14f81-6a3b-4199-81eb-8a45cca71155);
//END_REGION


//REGION Leave Party Journal Entries
DB_QuestDef_State_CompanionLeft((TAG)REALLY_WYLL_5f40def5-d3ec-4698-a367-01a339888956, "ORI_COM_Wyll", "CompanionHostile");
DB_QuestDef_State_CompanionLeft((TAG)REALLY_WYLL_5f40def5-d3ec-4698-a367-01a339888956, "ORI_COM_Wyll", "CompanionLowRelation");
DB_QuestDef_State_CompanionLeft((TAG)REALLY_WYLL_5f40def5-d3ec-4698-a367-01a339888956, "ORI_COM_Wyll", "CompanionMurdered");
//END_REGION


//REGION Wyll Specific
//these are dialog flags. They are used to set a user flag "DEN_Wyll_Knows_UserTalkedToWyll"
//that user flag can be used on simple question nodes likes |Never heard of Wyll| or |Oh yeah Wyll, what about him?|
DB_DEN_HasMet_Wyll((FLAG)DEN_Wyll_HasMet_b584ee3a-7673-9945-f6a8-8092da1dbc01);
DB_DEN_HasMet_Wyll((FLAG)DEN_Wyll_HasMet_PostDruidAttack_42a4b847-497e-59b0-4991-75946532a904);
DB_DEN_HasMet_Wyll((FLAG)DEN_Wyll_HasMet_ToCave_7870fc75-6adc-b880-f1b7-6a5c3d8106d1);

//END_REGION


//REGION Camp Setup
DB_ORI_OriginCampData((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, "WLDMAIN", (TRIGGER)S_CAMP_Wyll_A_7a14651a-3e48-8537-10f2-744c4f4404c8);
DB_ORI_OriginCampData((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, "WLDCAVGRN", (TRIGGER)S_CAMP_Wyll_A_4f8ff18a-4bfb-8460-4f4a-2fbfaddadbca);
DB_ORI_OriginCampData((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, "WLDCAVSND", (TRIGGER)S_CAMP_Wyll_A_d2af83be-ed4a-8e9a-3cff-273a26d1578d);
DB_ORI_OriginCampData((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, "WLDDUNABB", (TRIGGER)S_CAMP_Wyll_A_c6de4ca4-5bdc-85c6-2c09-1b32fbde7316);
DB_ORI_OriginCampData((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, "WLDDUNSHA", (TRIGGER)S_CAMP_Wyll_A_cc455032-0ec5-87db-1321-9ee5827ec6bf);
DB_ORI_OriginCampData((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, "WLDUND", (TRIGGER)S_CAMP_Wyll_A_d6a64637-8bbd-8cbd-23cf-bb17dea63db4);
DB_ORI_OriginCampData((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, "WLDBAS", (TRIGGER)S_CAMP_Wyll_A_62db12e9-9555-8036-32ab-0b73745520ec);

//END_REGION


//REGION Relationship dialogs
//Karlach
DB_RelationshipDialog_WRD_TriggerInCamp((DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty2_Event_PostConfrontation_eb938f58-a165-503d-660e-6498218d18c0);
//Judgement
DB_RelationshipDialog_WRD_TriggerInCamp((DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty_Event_PostJudgementReflection_6d93654c-15c2-cf9f-a48c-868602ec76d4);
//Tavern
DB_RelationshipDialog_WRD_TriggerInCamp((DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_IPRD_Event_NewsOfRavengard_555f802b-8d81-4090-b52d-c5081b94791c);
//Note in Creche
DB_RelationshipDialog_WRD_TriggerInCamp((DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty2_Event_BookAbduction_7586554f-a33f-444f-107b-86f332f4474b);
//Raphael in HAV
DB_RelationshipDialog_WRD_TriggerInCamp((DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty2_Event_MolsDeal_49c98013-6562-728f-22d2-1f19c3672dc6);
//Ravengard tadpoled
DB_RelationshipDialog_WRD_TriggerInCamp((DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty2_Event_AfterRavengardTadpoled_8cb4a17e-5611-3866-3d59-20edd8e106ce);
//Mizora capture
DB_RelationshipDialog_WRD_TriggerInCamp((DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty2_Event_DiscussedLemure_b9e7a27f-b1a3-6f3b-32e7-dddbf17d589c);
//Mizora freed
DB_RelationshipDialog_WRD_TriggerInCamp((DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_IPRD_Event_FreedMizoraBeforeKetheric_dd622810-bb65-4115-b1c7-7c6a2107ea41);
//Refugees in WYR
DB_RelationshipDialog_WRD_TriggerInCamp((DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty2_Event_Refugees_f13d05b7-7116-868c-72b8-054da92a46b6);
//Met Ravengard in ceremony
DB_RelationshipDialog_WRD_TriggerInCamp((DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty2_Event_CeremonyRavengard_76fd2be1-7887-8d49-25c0-41c0d10f4e29);
//Killed Ravengard in ceremony
DB_RelationshipDialog_WRD_TriggerInCamp((DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty2_Event_KilledRavengard_412753ea-dda8-3e96-a729-36d178f25bdb);
//Met Mizora on bridge
DB_RelationshipDialog_WRD_TriggerInCamp((DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty2_Event_ReactToMizoraBridge_deebb97d-84ae-987d-26d2-4eca2f2d5159);
//Wyll pact
DB_RelationshipDialog_WRD_TriggerInCamp((DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty2_Event_AfterPact_a64af098-7121-0913-30e8-5aba415c737c);
//IRN edgecase
DB_RelationshipDialog_WRD_TriggerInCamp((DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty2_Event_ReactedRavengardDeath_374e2383-f0e9-4353-3e35-9dd10c03eb9a);
//Mizora's romancxe
DB_RelationshipDialog_WRD_TriggerInCamp((DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty2_Event_AfterMizoraROM_a63cc1a1-f36a-0821-f445-85917eec0b6f);
//Wyrmway quest from book
DB_RelationshipDialog_WRD_TriggerInCamp((DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty2_Event_TalkedOfLegend_fd103700-84c5-4bcf-04dd-3bdbc79a1668);
//Wyrmway quest from Ravengard
DB_RelationshipDialog_WRD_TriggerInCamp((DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty2_Event_RavengardWyrm_9c7bcda3-56f2-c1f8-13fb-cecd5f4c88fd);
//Wyrmway quest from Florrick
DB_RelationshipDialog_WRD_TriggerInCamp((DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty2_Event_FlorrickEltanWyrm_49cdaaf3-805f-cba6-e0af-ec167bd803d7);
//Ansur is dead, reunite with Ravengard
DB_RelationshipDialog_WRD_TriggerInCamp((DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty2_Event_TalkedAboutHeart_12fecc65-b6f4-4dc3-3832-2f81314fc22d);
//Ansur is dead
DB_RelationshipDialog_WRD_TriggerInCamp((DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_IPRD_Event_Finale_1569ec67-be68-4227-8ed4-d6c2f96ead52);
//Blade of Frontiers or Avernus
DB_RelationshipDialog_WRD_TriggerInCamp((DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty2_Event_MusedBlade_879e7ec6-56a5-bada-f54f-14fd5e5ffe07);
//Grand Duke
DB_RelationshipDialog_WRD_TriggerInCamp((DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty2_Event_MusedGrandDuke_9624400b-e075-f015-b90b-beff3d6adae6);

//END_REGION


//REGION Wyll Companion Journal
DB_QuestDef_State_ConditionalFlag((FLAG)Wyll_Recruitment_Event_RecruitedOnce_6855bdf2-de0a-af66-dc74-0fbf3aaf03d9,"ORI_COM_Wyll","RecruitedWyll",0,(FLAG)ORI_Karlach_HasMet_50a43cde-0702-4c2a-a490-e9ee5f061f45);
DB_QuestDef_State_ConditionalFlag((FLAG)Wyll_Recruitment_Event_RecruitedOnce_6855bdf2-de0a-af66-dc74-0fbf3aaf03d9,"ORI_COM_Wyll","RecrtuitedMetKarlach",1,(FLAG)ORI_Karlach_HasMet_50a43cde-0702-4c2a-a490-e9ee5f061f45);

DB_QuestDef_State((FLAG)PLA_KarlachRecruitmentTollhouse_Quest_AcceptedSearch_3b379a18-9b46-4f66-9baf-0e7ce938c1d0,"ORI_COM_Wyll","MetPaladinsOfTyr");

DB_QuestDef_State_ConditionalFlag((FLAG)ORI_Karlach_State_Recruited_ed56dd05-9a92-4729-88bc-f4e6c6fb5be8,"ORI_COM_Wyll","RecruitedKarlachNoWyll",0,(FLAG)GLO_WyllConfrontation_Event_WyllConfrontedKarlach_b20ae4fa-17df-bd3d-0630-8bef82761600);

DB_QuestDef_State_ConditionalFlag((FLAG)CAMP_Wyll_RecruitedInCamp_3c0a9a55-a6b1-b9cb-f37a-5fc3dc584717,"ORI_COM_Wyll","RecruitedAmbush",0,(FLAG)GLO_Karlach_State_Dead_26f3c3b0-a9c8-40d6-8950-67c9b8e134e2);
DB_QuestDef_State_ConditionalFlag((FLAG)CAMP_Wyll_RecruitedInCamp_3c0a9a55-a6b1-b9cb-f37a-5fc3dc584717,"ORI_COM_Wyll","RecruitedAmbushKarlachKilled",1,(FLAG)GLO_Karlach_State_Dead_26f3c3b0-a9c8-40d6-8950-67c9b8e134e2);

DB_QuestDef_State_ConditionalFlag((FLAG)ORI_Karlach_State_Recruited_ed56dd05-9a92-4729-88bc-f4e6c6fb5be8,"ORI_COM_Wyll","KarlachHired",1,(FLAG)GLO_WyllConfrontation_Event_WyllConfrontedKarlach_b20ae4fa-17df-bd3d-0630-8bef82761600);

DB_QuestDef_State_ConditionalFlag((FLAG)GLO_Karlach_State_Dead_26f3c3b0-a9c8-40d6-8950-67c9b8e134e2,"ORI_COM_Wyll","KarlachKilled",0,(FLAG)Wyll_Recruitment_Event_QueueNight_08a74992-a350-42b8-80d3-2685898281ba);

DB_QuestDef_State_ConditionalFlag((FLAG)ORI_Wyll_State_AwaitingJudgement_fc1db24a-f2c5-4ac2-a807-6acc320ac98b,"ORI_COM_Wyll","PostKarlachSpared",1,(FLAG)ORI_WyllConfrontation_State_ResolvedPeacefuly_fa3b8420-26bc-361d-8fbf-c6da37353446);
DB_QuestDef_State_ConditionalFlag((FLAG)ORI_Wyll_State_AwaitingJudgement_fc1db24a-f2c5-4ac2-a807-6acc320ac98b,"ORI_COM_Wyll","PostKarlachDead",1,(FLAG)GLO_Karlach_State_Dead_26f3c3b0-a9c8-40d6-8950-67c9b8e134e2);

DB_QuestDef_State_ConditionalFlag((FLAG)CAMP_MizorasJudgement_Event_Judged_c6d2140f-312d-65d4-e66e-92de4258b3f4,"ORI_COM_Wyll","MizorasJudgementDevil",1,(FLAG)ORI_WyllConfrontation_State_ResolvedPeacefuly_fa3b8420-26bc-361d-8fbf-c6da37353446);
//DB_QuestDef_State_ConditionalFlag((FLAG)CAMP_MizorasJudgement_Event_Judged_c6d2140f-312d-65d4-e66e-92de4258b3f4,"ORI_COM_Wyll","MizorasJudgementReward",1,(FLAG)GLO_Karlach_State_Dead_26f3c3b0-a9c8-40d6-8950-67c9b8e134e2);

DB_QuestDef_State((FLAG)TWN_Wyll_State_MizorasCaptureHappened_80cb617e-e3c3-3386-3919-6caef51bfd5d,"ORI_COM_Wyll","MizorasCaptureHappened");
DB_QuestDef_State((FLAG)COL_PartyProgress_EnteredColony_666abe92-f197-4c38-85a8-d879a9e258b6,"ORI_COM_Wyll","MizorasCaptureReachedColony");

DB_QuestDef_State_ConditionalFlag((FLAG)COL_MizorasRescue_State_SavedMizora_148bcec2-5367-2b72-3c93-29fb32fc0181,"ORI_COM_Wyll","MizorasRescueHappened",0,(FLAG)COL_MizorasRescue_Event_ConvincedMizora_6e704901-f30c-f715-b5b0-e326b38c5846);
DB_QuestDef_State_ConditionalFlag((FLAG)COL_MizorasRescue_State_SavedMizora_148bcec2-5367-2b72-3c93-29fb32fc0181,"ORI_COM_Wyll","MizorasRescueHappenedPact",1,(FLAG)COL_MizorasRescue_Event_ConvincedMizora_6e704901-f30c-f715-b5b0-e326b38c5846);
DB_QuestDef_State((FLAG)VISITEDREGION_BGO_Main_A_40f06537-814f-4796-b012-5ffaa648a8d9,"ORI_COM_Wyll","ReachedAct3");
DB_QuestDef_State((FLAG)COL_MizorasRescue_State_KilledMizora_55d5833a-c07d-3461-8c88-a98da5207674,"ORI_COM_Wyll","MizoraDied");

DB_QuestDef_State((FLAG)WYR_MeetingMizora_Event_SentWyllUpstairs_cb147c97-f1e7-cfba-ef10-cd2e6adc9f69,"ORI_COM_Wyll","MetMizoraBeforeCeremony");
DB_QuestDef_State((FLAG)WYR_KillDirectorGortash_State_AfterCeremony_a05a6945-21ad-400d-80bc-7b4934571c57,"ORI_COM_Wyll","CeremonyResolved");
DB_QuestDef_State((FLAG)WYR_MeetingMizora_Event_MizoraLeftWYR_03f1d319-d5f4-8aa1-0f0d-d58e5b32bf2e,"ORI_COM_Wyll","MizoraWentToCamp");

DB_QuestDef_State_ConditionalFlag((FLAG)CAMP_MizorasPact_State_WyllReleasedFromPact_79a90490-b009-507c-e0d3-f79b0bdd4cb6,"ORI_COM_Wyll","BrokenPactRavengardSearch",0,(FLAG)GLO_Ravengard_State_Defeated_7bb624ef-09cb-4e55-b035-832c05427a61);
DB_QuestDef_State_ConditionalFlag((FLAG)CAMP_MizorasPact_State_WyllReleasedFromPact_79a90490-b009-507c-e0d3-f79b0bdd4cb6,"ORI_COM_Wyll","BrokenPactRavengardDead",1,(FLAG)GLO_Ravengard_State_Defeated_7bb624ef-09cb-4e55-b035-832c05427a61);
DB_QuestDef_State_ConditionalFlag((FLAG)CAMP_MizorasPact_State_WyllEternalPact_8da8b1fb-5aa9-8cf5-8b45-6f8ca31a1227,"ORI_COM_Wyll","EternalPactRavengardHint",0,(FLAG)GLO_Ravengard_State_Defeated_7bb624ef-09cb-4e55-b035-832c05427a61);
DB_QuestDef_State((FLAG)WYR_Ravengard_State_Resurrected_86c9572d-84e7-b407-0ce6-84fd263418a1,"ORI_COM_Wyll","EternalPactRavengardResurrected");
DB_QuestDef_State((FLAG)IRN_IronThrone_Event_RavengardLeftForCamp_c1492418-89a5-4d48-8a39-0f889281a5e2,"ORI_COM_Wyll","RavengardRescuedIRN");

//Florrick Confrontation, cannot happen before Mizora's Pact
DB_QuestDef_State_ConditionalFlag((FLAG)LOW_FlorrickFight_State_Hostile_b34101ae-27e0-dfbd-5d57-7ee968631f7d,"ORI_COM_Wyll","FlorrickFightHostile",0,(FLAG)GLO_Florrick_State_PermaDefeated_c190fb1f-4c27-4948-87f0-29dc5a9b5b55);
DB_QuestDef_State_ConditionalFlag((FLAG)LOW_FlorrickFight_State_Hostile_b34101ae-27e0-dfbd-5d57-7ee968631f7d,"ORI_COM_Wyll","FlorrickFallbackFightHostile",1,(FLAG)GLO_Florrick_State_PermaDefeated_c190fb1f-4c27-4948-87f0-29dc5a9b5b55);

DB_QuestDef_State((FLAG)LOW_FlorrickFight_Event_WyrmquestFlorrick_b3e70fdc-fc1f-5302-bce6-723d8473efff,"ORI_COM_Wyll","FlorrickFightBookGiven");
DB_QuestDef_State((FLAG)LOW_FlorrickFightFallback_Event_WyrmQuestEltan_d9a028ec-b6a5-233f-19a8-78ff74020fe7,"ORI_COM_Wyll","FlorrickFightFallbackBookGiven");
DB_QuestDef_State((FLAG)GLO_Wyll_Event_RavengardWyrmwayQuest_a0383a14-5576-656c-1030-2439279ffc82,"ORI_COM_Wyll","WyrmwayFromRavengard");

DB_QuestDef_State((FLAG)WYR_AnsurGhost_State_HasAnsurBook_e0aebfc7-5496-4b2d-aeb6-bcd17c9c275a,"ORI_COM_Wyll","FlorrickFightBookTaken");
DB_QuestDef_BookReadState("ORI_COM_Wyll","WyrmwaySubStarted",(ITEM)S_GLO_AnsurGhost_LegendOfAnsurBook_b0ecc3d5-85ad-48fa-bc47-988107507e6c);

//Moved to subquest
//DB_QuestDef_BookReadState("ORI_COM_Wyll","WyrmwayFromBook",(ITEM)S_GLO_AnsurGhost_LegendOfAnsurBook_b0ecc3d5-85ad-48fa-bc47-988107507e6c);
//DB_QuestDef_State((FLAG)WYR_Balduran_Event_OpenDoor_99e8c929-4b71-3e03-2b43-6e7421896f7a,"ORI_COM_Wyll","WyrmwayReached");

//Has to trigger _only_ after ravengard storyline was resolved (either dealt with in IRN, or broken pact+permadefeated)
DB_QuestDef_State_ConditionalFlag((FLAG)WYR_SkeletalDragon_State_Defeated_bafbffed-bb3f-43b0-a006-7bac257a633c,"ORI_COM_Wyll","WyrmwaySolved",1,(FLAG)GLO_Ravengard_State_PermaDefeated_b1b2458c-dd27-4db7-974e-a294ca6e2e9e);
DB_QuestDef_State_ConditionalFlag((FLAG)WYR_SkeletalDragon_State_Defeated_bafbffed-bb3f-43b0-a006-7bac257a633c,"ORI_COM_Wyll","WyrmwayReportRavengard",1,(FLAG)CAMP_Ravengard_State_RavengardInCamp_37309008-04cf-493c-8ca6-43034d331a8a);

//Quest Conclusion, Cannot happen until Ravengard is saved/brought back (which always happens after meeting Mizora one way or another)
DB_QuestDef_State_ConditionalFlag((FLAG)GLO_Wyll_State_GrandDuke_0e223e4d-be63-89f4-380f-5cc755817abd,"ORI_COM_Wyll","RavengardWyllGrandDuke",1,(FLAG)CAMP_Ravengard_State_RavengardInCamp_37309008-04cf-493c-8ca6-43034d331a8a);
DB_QuestDef_State_ConditionalFlag((FLAG)GLO_Wyll_State_BladeOfFrontiers_8c46322f-7965-94c7-1318-62c391f1c8f1,"ORI_COM_Wyll","RavengardWyllFrontiers",1,(FLAG)CAMP_Ravengard_State_RavengardInCamp_37309008-04cf-493c-8ca6-43034d331a8a);
DB_QuestDef_State_ConditionalFlag((FLAG)GLO_Wyll_State_BladeOfAvernus_faeb73da-a609-dc56-7745-ac07f795c137,"ORI_COM_Wyll","RavengardWyllAvernus",1,(FLAG)CAMP_Ravengard_State_RavengardInCamp_37309008-04cf-493c-8ca6-43034d331a8a);

//Quest Conclusion, Cannot happen until Wyll breaks the pact with Mizora AND Florrick/Elton encountered
DB_QuestDef_State_ConditionalFlag((FLAG)GLO_Wyll_State_GrandDuke_0e223e4d-be63-89f4-380f-5cc755817abd,"ORI_COM_Wyll","WyllGrandDuke",1,(FLAG)CAMP_MizorasPact_State_WyllReleasedFromPact_79a90490-b009-507c-e0d3-f79b0bdd4cb6);
DB_QuestDef_State_ConditionalFlag((FLAG)GLO_Wyll_State_BladeOfFrontiers_8c46322f-7965-94c7-1318-62c391f1c8f1,"ORI_COM_Wyll","WyllFrontiers",1,(FLAG)CAMP_MizorasPact_State_WyllReleasedFromPact_79a90490-b009-507c-e0d3-f79b0bdd4cb6);
DB_QuestDef_State_ConditionalFlag((FLAG)GLO_Wyll_State_BladeOfAvernus_faeb73da-a609-dc56-7745-ac07f795c137,"ORI_COM_Wyll","WyllAvernus",1,(FLAG)CAMP_MizorasPact_State_WyllReleasedFromPact_79a90490-b009-507c-e0d3-f79b0bdd4cb6);

DB_QuestDef_LevelLoaded("ORI_COM_Wyll","ReachedEND","END_Main");

//END_REGION


//REGION Duke Companion Journal
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","OrderedBreachInn","ORI_COM_Wyll","InnReached");

DB_QuestDef_State_ConditionalFlag(GLO_Florrick_State_PermaDefeated_c190fb1f-4c27-4948-87f0-29dc5a9b5b55,"ORI_COM_Wyll","CouncillorDead",0,PLA_Desire_Event_HasMet_39ac0b76-1aa6-063e-6f73-73e2292eab12);
DB_QuestDef_State_ConditionalFlag(GLO_Florrick_State_PermaDefeated_c190fb1f-4c27-4948-87f0-29dc5a9b5b55,"ORI_COM_Wyll","CouncillorDeadKnown",1,PLA_Desire_Event_HasMet_39ac0b76-1aa6-063e-6f73-73e2292eab12);
DB_QuestDef_State((FLAG)ORI_Wyll_Knows_RavengardFather_ef46f733-7028-8629-260a-d333d2ef3ad4,"ORI_COM_Wyll","RavengardFather");

DB_QuestDef_ChainedState("PLA_GrandDukeRescue","Counsellor_DidntRescue","ORI_COM_Wyll","TavernBurnt");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","Counsellor_RefusedHelp","ORI_COM_Wyll","CouncillorRefused");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","Counsellor_AcceptedHelp_NoLocation","ORI_COM_Wyll","CouncillorTalked");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","Counsellor_AcceptedHelp_Moonrise","ORI_COM_Wyll","CouncillorTalkedKnowsMT");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","LearnedMoonrise","ORI_COM_Wyll","LearntMT");

DB_QuestDef_ChainedState("PLA_GrandDukeRescue","ReachedMT","ORI_COM_Wyll","ReachedMT");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","Tadpoled","ORI_COM_Wyll","Tadpoled");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","Kidnapped","ORI_COM_Wyll","Kidnapped");

DB_QuestDef_ChainedState("PLA_GrandDukeRescue","PactBroken","ORI_COM_Wyll","PactBroken");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","DiedWyllParty","ORI_COM_Wyll","Died");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","MizoraWentToCamp","ORI_COM_Wyll","MizoraAtCamp");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","MizoraHint","ORI_COM_Wyll","PactedHint");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","ReachedIRN","ORI_COM_Wyll","ReachedIRN");

DB_QuestDef_State((FLAG)IRN_Wyll_Event_MizoraAppearedToHelpRavengard_d0f84a78-d508-4194-b4f1-d663dbb10d8e,"ORI_COM_Wyll","PactedEscort");
DB_QuestDef_State((FLAG)IRN_Wyll_Event_MizoraAppearedToKillRavengard_3775e048-e7ec-48c2-a5cb-83acdd8c72dc,"ORI_COM_Wyll","BrokenEscort");

DB_QuestDef_ChainedState("PLA_GrandDukeRescue","RescuedIRN","ORI_COM_Wyll","RescuedIRN");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","FoundDeadInIRN","ORI_COM_Wyll","FoundDeadInIRN");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","LearnedRavengardDiedInIRNDestruction","ORI_COM_Wyll","LearnedRavengardDiedInIRNDestruction");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","Resurrected","ORI_COM_Wyll","Resurrected");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","BrokenAbandoned","ORI_COM_Wyll","BrokenAbandoned");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","ResurrectedTalked","ORI_COM_Wyll","PactedTalked");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","RescuedTalked","ORI_COM_Wyll","RescuedTalked");

// If Ravengard is permadefeated when he's not in the Iron Throne
DB_QuestDef_State_ConditionalFlag((FLAG)GLO_Ravengard_State_PermaDefeated_b1b2458c-dd27-4db7-974e-a294ca6e2e9e,"ORI_COM_Wyll","DiedIRN",0,(FLAG)IRN_IronThrone_State_RavengardPresent_2e102a34-500a-4cd2-ba93-51d1a8b96496);
// If Ravengard is permadefeated after players have visited the Iron Throne, meaning either the pact has been broken and he can die during or after the escape, or the pact was kept and he died after he was rescued
DB_QuestDef_State_ConditionalFlag((FLAG)GLO_Ravengard_State_PermaDefeated_b1b2458c-dd27-4db7-974e-a294ca6e2e9e,"ORI_COM_Wyll","DiedIRN",1,(FLAG)IRN_IronThrone_State_Visited_5b3fb5a7-61e8-44a9-a0a1-b6b45b59a23c);

DB_QuestDef_LevelLoaded("ORI_COM_Wyll","LeftAct_Duke","END_Main");

//END_REGION


//REGION Wyrmway Companion Journal
DB_QuestDef_BookReadState("ORI_COM_Wyll","FromBook",(ITEM)S_GLO_AnsurGhost_LegendOfAnsurBook_b0ecc3d5-85ad-48fa-bc47-988107507e6c);
DB_QuestDef_State((FLAG)WYR_Wyrmway_State_InWyrmway_d4bc7aa7-82ff-5a3e-df31-8153b372839a,"ORI_COM_Wyll","Reached_Knows");
DB_QuestDef_State((FLAG)WYR_Balduran_Event_OpenDoor_99e8c929-4b71-3e03-2b43-6e7421896f7a,"ORI_COM_Wyll","TalkedStatue");
DB_QuestDef_State((FLAG)WYR_WyrmwayTrials_State_AllSucceeded_af019736-1d77-4609-a33b-dcd8360e5191,"ORI_COM_Wyll","PuzzlesSolved");
DB_QuestDef_State((FLAG)WYR_Wyrmway_State_EnteredLair_NoSolution_aa27b11f-0645-4591-b144-a225fe8067ed,"ORI_COM_Wyll","Entered_NoSolution");
DB_QuestDef_ChainedState("HIDDEN_BGO_Boosters","WYR_Wyrmway_SolvedTrials","ORI_COM_Wyll","Entered");
DB_QuestDef_State((FLAG)WYR_SkeletalDragon_State_Found_5150ff2a-2cee-4a57-bdca-02727a736a39,"ORI_COM_Wyll","DragonFound");
DB_QuestDef_State((FLAG)WYR_SkeletalDragon_State_Defeated_bafbffed-bb3f-43b0-a006-7bac257a633c,"ORI_COM_Wyll","DragonKilled");
DB_QuestDef_LevelLoaded("ORI_COM_Wyll","LeftAct_Wyrmway","END_Main");

//END_REGION


//REGION Wyll Avatar Journal
DB_QuestDef_State((FLAG)PLA_KarlachRecruitmentTollhouse_Quest_AcceptedSearch_3b379a18-9b46-4f66-9baf-0e7ce938c1d0,"ORI_Avatar_Wyll","MetPaladinsOfTyr");

DB_QuestDef_State_ConditionalFlag((FLAG)ORI_Karlach_State_Recruited_ed56dd05-9a92-4729-88bc-f4e6c6fb5be8,"ORI_Avatar_Wyll","RecruitedKarlachNoWyll",0,(FLAG)GLO_WyllConfrontation_Event_WyllConfrontedKarlach_b20ae4fa-17df-bd3d-0630-8bef82761600);

DB_QuestDef_State_ConditionalFlag((FLAG)ORI_Karlach_State_Recruited_ed56dd05-9a92-4729-88bc-f4e6c6fb5be8,"ORI_Avatar_Wyll","KarlachHired",1,(FLAG)GLO_WyllConfrontation_Event_WyllConfrontedKarlach_b20ae4fa-17df-bd3d-0630-8bef82761600);

DB_QuestDef_State((FLAG)GLO_Karlach_State_Dead_26f3c3b0-a9c8-40d6-8950-67c9b8e134e2,"ORI_Avatar_Wyll","KarlachKilled");

DB_QuestDef_State_ConditionalFlag((FLAG)CAMP_MizorasJudgement_Event_Judged_c6d2140f-312d-65d4-e66e-92de4258b3f4,"ORI_Avatar_Wyll","MizorasJudgementDevil",1,(FLAG)ORI_WyllConfrontation_State_ResolvedPeacefuly_fa3b8420-26bc-361d-8fbf-c6da37353446);
//DB_QuestDef_State_ConditionalFlag((FLAG)CAMP_MizorasJudgement_Event_Judged_c6d2140f-312d-65d4-e66e-92de4258b3f4,"ORI_Avatar_Wyll","MizorasJudgementReward",1,(FLAG)GLO_Karlach_State_Dead_26f3c3b0-a9c8-40d6-8950-67c9b8e134e2);

DB_QuestDef_State((FLAG)TWN_Wyll_State_MizorasCaptureHappened_80cb617e-e3c3-3386-3919-6caef51bfd5d,"ORI_Avatar_Wyll","MizorasCaptureHappened");
DB_QuestDef_State((FLAG)COL_PartyProgress_EnteredColony_666abe92-f197-4c38-85a8-d879a9e258b6,"ORI_Avatar_Wyll","MizorasCaptureReachedColony");

DB_QuestDef_State_ConditionalFlag((FLAG)COL_MizorasRescue_State_SavedMizora_148bcec2-5367-2b72-3c93-29fb32fc0181,"ORI_Avatar_Wyll","MizorasRescueHappened",0,(FLAG)COL_MizorasRescue_Event_ConvincedMizora_6e704901-f30c-f715-b5b0-e326b38c5846);
DB_QuestDef_State_ConditionalFlag((FLAG)COL_MizorasRescue_State_SavedMizora_148bcec2-5367-2b72-3c93-29fb32fc0181,"ORI_Avatar_Wyll","MizorasRescueHappenedPact",1,(FLAG)COL_MizorasRescue_Event_ConvincedMizora_6e704901-f30c-f715-b5b0-e326b38c5846);

DB_QuestDef_State((FLAG)VISITEDREGION_BGO_Main_A_40f06537-814f-4796-b012-5ffaa648a8d9,"ORI_Avatar_Wyll","ReachedAct3");

DB_QuestDef_State((FLAG)WYR_MeetingMizora_Event_SentWyllUpstairs_cb147c97-f1e7-cfba-ef10-cd2e6adc9f69,"ORI_Avatar_Wyll","MetMizoraBeforeCeremony");
DB_QuestDef_State((FLAG)WYR_KillDirectorGortash_State_AfterCeremony_a05a6945-21ad-400d-80bc-7b4934571c57,"ORI_Avatar_Wyll","CeremonyResolved");
DB_QuestDef_State((FLAG)WYR_MeetingMizora_Event_MizoraLeftWYR_03f1d319-d5f4-8aa1-0f0d-d58e5b32bf2e,"ORI_Avatar_Wyll","MizoraWentToCamp");

DB_QuestDef_State_ConditionalFlag((FLAG)CAMP_MizorasPact_State_WyllReleasedFromPact_79a90490-b009-507c-e0d3-f79b0bdd4cb6,"ORI_Avatar_Wyll","BrokenPactRavengardSearch",0,(FLAG)GLO_Ravengard_State_Defeated_7bb624ef-09cb-4e55-b035-832c05427a61);
DB_QuestDef_State_ConditionalFlag((FLAG)CAMP_MizorasPact_State_WyllReleasedFromPact_79a90490-b009-507c-e0d3-f79b0bdd4cb6,"ORI_Avatar_Wyll","BrokenPactRavengardDead",1,(FLAG)GLO_Ravengard_State_Defeated_7bb624ef-09cb-4e55-b035-832c05427a61);
DB_QuestDef_State_ConditionalFlag((FLAG)CAMP_MizorasPact_State_WyllEternalPact_8da8b1fb-5aa9-8cf5-8b45-6f8ca31a1227,"ORI_Avatar_Wyll","EternalPactRavengardHint",0,(FLAG)GLO_Ravengard_State_Defeated_7bb624ef-09cb-4e55-b035-832c05427a61);
DB_QuestDef_State((FLAG)WYR_Ravengard_State_Resurrected_86c9572d-84e7-b407-0ce6-84fd263418a1,"ORI_Avatar_Wyll","EternalPactRavengardResurrected");
DB_QuestDef_State((FLAG)IRN_IronThrone_Event_RavengardLeftForCamp_c1492418-89a5-4d48-8a39-0f889281a5e2,"ORI_Avatar_Wyll","RavengardRescuedIRN");

//Florrick Confrontation, cannot happen before Mizora's Pact
DB_QuestDef_State_ConditionalFlag((FLAG)LOW_FlorrickFight_State_Hostile_b34101ae-27e0-dfbd-5d57-7ee968631f7d,"ORI_Avatar_Wyll","FlorrickFightHostile",0,(FLAG)GLO_Florrick_State_PermaDefeated_c190fb1f-4c27-4948-87f0-29dc5a9b5b55);
DB_QuestDef_State_ConditionalFlag((FLAG)LOW_FlorrickFight_State_Hostile_b34101ae-27e0-dfbd-5d57-7ee968631f7d,"ORI_Avatar_Wyll","FlorrickFallbackFightHostile",1,(FLAG)GLO_Florrick_State_PermaDefeated_c190fb1f-4c27-4948-87f0-29dc5a9b5b55);

DB_QuestDef_State((FLAG)LOW_FlorrickFight_Event_WyrmquestFlorrick_b3e70fdc-fc1f-5302-bce6-723d8473efff,"ORI_Avatar_Wyll","FlorrickFightBookGiven");
DB_QuestDef_State((FLAG)LOW_FlorrickFightFallback_Event_WyrmQuestEltan_d9a028ec-b6a5-233f-19a8-78ff74020fe7,"ORI_Avatar_Wyll","FlorrickFightFallbackBookGiven");
DB_QuestDef_State((FLAG)GLO_Wyll_Event_RavengardWyrmwayQuest_a0383a14-5576-656c-1030-2439279ffc82,"ORI_Avatar_Wyll","WyrmwayFromRavengard");

DB_QuestDef_State((FLAG)WYR_AnsurGhost_State_HasAnsurBook_e0aebfc7-5496-4b2d-aeb6-bcd17c9c275a,"ORI_Avatar_Wyll","FlorrickFightBookTaken");
DB_QuestDef_BookReadState("ORI_Avatar_Wyll","WyrmwaySubStarted",(ITEM)S_GLO_AnsurGhost_LegendOfAnsurBook_b0ecc3d5-85ad-48fa-bc47-988107507e6c);

//Moved to subquest
//DB_QuestDef_BookReadState("ORI_Avatar_Wyll","WyrmwayFromBook",(ITEM)S_GLO_AnsurGhost_LegendOfAnsurBook_b0ecc3d5-85ad-48fa-bc47-988107507e6c);
//DB_QuestDef_State((FLAG)WYR_Balduran_Event_OpenDoor_99e8c929-4b71-3e03-2b43-6e7421896f7a,"ORI_Avatar_Wyll","WyrmwayReached");

//Has to trigger _only_ after ravengard storyline was resolved (either dealt with in IRN, or broken pact+permadefeated)
DB_QuestDef_State_ConditionalFlag((FLAG)WYR_SkeletalDragon_State_Defeated_bafbffed-bb3f-43b0-a006-7bac257a633c,"ORI_Avatar_Wyll","WyrmwaySolved",1,(FLAG)GLO_Ravengard_State_PermaDefeated_b1b2458c-dd27-4db7-974e-a294ca6e2e9e);
DB_QuestDef_State_ConditionalFlag((FLAG)WYR_SkeletalDragon_State_Defeated_bafbffed-bb3f-43b0-a006-7bac257a633c,"ORI_Avatar_Wyll","WyrmwayReportRavengard",1,(FLAG)CAMP_Ravengard_State_RavengardInCamp_37309008-04cf-493c-8ca6-43034d331a8a);

//Quest Conclusion, Cannot happen until Ravengard is saved/brought back (which always happens after meeting Mizora one way or another)
DB_QuestDef_State_ConditionalFlag((FLAG)GLO_Wyll_State_GrandDuke_0e223e4d-be63-89f4-380f-5cc755817abd,"ORI_Avatar_Wyll","RavengardWyllGrandDuke",1,(FLAG)CAMP_Ravengard_State_RavengardInCamp_37309008-04cf-493c-8ca6-43034d331a8a);
DB_QuestDef_State_ConditionalFlag((FLAG)GLO_Wyll_State_BladeOfFrontiers_8c46322f-7965-94c7-1318-62c391f1c8f1,"ORI_Avatar_Wyll","RavengardWyllFrontiers",1,(FLAG)CAMP_Ravengard_State_RavengardInCamp_37309008-04cf-493c-8ca6-43034d331a8a);
DB_QuestDef_State_ConditionalFlag((FLAG)GLO_Wyll_State_BladeOfAvernus_faeb73da-a609-dc56-7745-ac07f795c137,"ORI_Avatar_Wyll","RavengardWyllAvernus",1,(FLAG)CAMP_Ravengard_State_RavengardInCamp_37309008-04cf-493c-8ca6-43034d331a8a);
//Quest Conclusion, Cannot happen until Wyll breaks the pact with Mizora AND Florrick/Elton encountered
DB_QuestDef_State_ConditionalFlag((FLAG)GLO_Wyll_State_GrandDuke_0e223e4d-be63-89f4-380f-5cc755817abd,"ORI_Avatar_Wyll","WyllGrandDuke",1,(FLAG)CAMP_MizorasPact_State_WyllReleasedFromPact_79a90490-b009-507c-e0d3-f79b0bdd4cb6);
DB_QuestDef_State_ConditionalFlag((FLAG)GLO_Wyll_State_BladeOfFrontiers_8c46322f-7965-94c7-1318-62c391f1c8f1,"ORI_Avatar_Wyll","WyllFrontiers",1,(FLAG)CAMP_MizorasPact_State_WyllReleasedFromPact_79a90490-b009-507c-e0d3-f79b0bdd4cb6);
DB_QuestDef_State_ConditionalFlag((FLAG)GLO_Wyll_State_BladeOfAvernus_faeb73da-a609-dc56-7745-ac07f795c137,"ORI_Avatar_Wyll","WyllAvernus",1,(FLAG)CAMP_MizorasPact_State_WyllReleasedFromPact_79a90490-b009-507c-e0d3-f79b0bdd4cb6);

DB_QuestDef_LevelLoaded("ORI_Avatar_Wyll","ReachedEND","END_Main");

//END_REGION


//REGION Duke Avatar Journal
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","OrderedBreachInn","ORI_Avatar_Wyll","InnReached");

DB_QuestDef_State_ConditionalFlag(GLO_Florrick_State_PermaDefeated_c190fb1f-4c27-4948-87f0-29dc5a9b5b55,"ORI_Avatar_Wyll","CouncillorDead",0,PLA_Desire_Event_HasMet_39ac0b76-1aa6-063e-6f73-73e2292eab12);
DB_QuestDef_State_ConditionalFlag(GLO_Florrick_State_PermaDefeated_c190fb1f-4c27-4948-87f0-29dc5a9b5b55,"ORI_Avatar_Wyll","CouncillorDeadKnown",1,PLA_Desire_Event_HasMet_39ac0b76-1aa6-063e-6f73-73e2292eab12);

DB_QuestDef_ChainedState("PLA_GrandDukeRescue","Counsellor_DidntRescue","ORI_Avatar_Wyll","TavernBurnt");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","Counsellor_RefusedHelp","ORI_Avatar_Wyll","CouncillorRefused");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","Counsellor_AcceptedHelp_NoLocation","ORI_Avatar_Wyll","CouncillorTalked");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","Counsellor_AcceptedHelp_Moonrise","ORI_Avatar_Wyll","CouncillorTalkedKnowsMT");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","LearnedMoonrise","ORI_Avatar_Wyll","LearntMT");

DB_QuestDef_ChainedState("PLA_GrandDukeRescue","ReachedMT","ORI_Avatar_Wyll","ReachedMT");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","Tadpoled","ORI_Avatar_Wyll","Tadpoled");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","Kidnapped","ORI_Avatar_Wyll","Kidnapped");

DB_QuestDef_ChainedState("PLA_GrandDukeRescue","PactBroken","ORI_Avatar_Wyll","PactBroken");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","DiedWyllParty","ORI_Avatar_Wyll","Died");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","MizoraWentToCamp","ORI_Avatar_Wyll","MizoraAtCamp");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","MizoraHint","ORI_Avatar_Wyll","PactedHint");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","ReachedIRN","ORI_Avatar_Wyll","ReachedIRN");

DB_QuestDef_State((FLAG)IRN_Wyll_Event_MizoraAppearedToHelpRavengard_d0f84a78-d508-4194-b4f1-d663dbb10d8e,"ORI_Avatar_Wyll","PactedEscort");
DB_QuestDef_State((FLAG)IRN_Wyll_Event_MizoraAppearedToKillRavengard_3775e048-e7ec-48c2-a5cb-83acdd8c72dc,"ORI_Avatar_Wyll","BrokenEscort");

DB_QuestDef_ChainedState("PLA_GrandDukeRescue","RescuedIRN","ORI_Avatar_Wyll","RescuedIRN");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","FoundDeadInIRN","ORI_Avatar_Wyll","FoundDeadInIRN");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","LearnedRavengardDiedInIRNDestruction","ORI_Avatar_Wyll","LearnedRavengardDiedInIRNDestruction");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","Resurrected","ORI_Avatar_Wyll","Resurrected");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","BrokenAbandoned","ORI_Avatar_Wyll","BrokenAbandoned");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","ResurrectedTalked","ORI_Avatar_Wyll","PactedTalked");
DB_QuestDef_ChainedState("PLA_GrandDukeRescue","RescuedTalked","ORI_Avatar_Wyll","RescuedTalked");

DB_QuestDef_State_ConditionalFlag((FLAG)GLO_Ravengard_State_PermaDefeated_b1b2458c-dd27-4db7-974e-a294ca6e2e9e,"ORI_Avatar_Wyll","DiedIRN",1,(FLAG)IRN_IronThrone_State_RavengardPresent_2e102a34-500a-4cd2-ba93-51d1a8b96496);
// If Ravengard is permadefeated when he's not in the Iron Throne
DB_QuestDef_State_ConditionalFlag((FLAG)GLO_Ravengard_State_PermaDefeated_b1b2458c-dd27-4db7-974e-a294ca6e2e9e,"ORI_Avatar_Wyll","DiedIRN",0,(FLAG)IRN_IronThrone_State_RavengardPresent_2e102a34-500a-4cd2-ba93-51d1a8b96496);
// If Ravengard is permadefeated after players have visited the Iron Throne, meaning either the pact has been broken and he can die during or after the escape, or the pact was kept and he died after he was rescued
DB_QuestDef_State_ConditionalFlag((FLAG)GLO_Ravengard_State_PermaDefeated_b1b2458c-dd27-4db7-974e-a294ca6e2e9e,"ORI_Avatar_Wyll","DiedIRN",1,(FLAG)IRN_IronThrone_State_Visited_5b3fb5a7-61e8-44a9-a0a1-b6b45b59a23c);

DB_QuestDef_LevelLoaded("ORI_Avatar_Wyll","LeftAct_Duke","END_Main");

//END_REGION


//REGION Wyrmway Avatar Journal
DB_QuestDef_BookReadState("ORI_Avatar_Wyll","FromBook",(ITEM)S_GLO_AnsurGhost_LegendOfAnsurBook_b0ecc3d5-85ad-48fa-bc47-988107507e6c);
DB_QuestDef_State((FLAG)WYR_Wyrmway_State_InWyrmway_d4bc7aa7-82ff-5a3e-df31-8153b372839a,"ORI_Avatar_Wyll","Reached_Knows");
DB_QuestDef_State((FLAG)WYR_Balduran_Event_OpenDoor_99e8c929-4b71-3e03-2b43-6e7421896f7a,"ORI_Avatar_Wyll","TalkedStatue");
DB_QuestDef_State((FLAG)WYR_WyrmwayTrials_State_AllSucceeded_af019736-1d77-4609-a33b-dcd8360e5191,"ORI_Avatar_Wyll","PuzzlesSolved");
DB_QuestDef_State((FLAG)WYR_Wyrmway_State_EnteredLair_NoSolution_aa27b11f-0645-4591-b144-a225fe8067ed,"ORI_Avatar_Wyll","Entered_NoSolution");
DB_QuestDef_ChainedState("HIDDEN_BGO_Boosters","WYR_Wyrmway_SolvedTrials","ORI_Avatar_Wyll","Entered");
DB_QuestDef_State((FLAG)WYR_SkeletalDragon_State_Found_5150ff2a-2cee-4a57-bdca-02727a736a39,"ORI_Avatar_Wyll","DragonFound");
DB_QuestDef_State((FLAG)WYR_SkeletalDragon_State_Defeated_bafbffed-bb3f-43b0-a006-7bac257a633c,"ORI_Avatar_Wyll","DragonKilled");
DB_QuestDef_LevelLoaded("ORI_Avatar_Wyll","LeftAct_Wyrmway","END_Main");

//END_REGION


PROC_CharacterDisableAllCrimes(S_GLO_Wyll_Cambion_491a7686-3081-405b-983c-289ec8781e0a);
SetFlag((FLAG)GLO_State_NoCower_8180293e-4d0d-4e9b-9dfc-b195d4c67ddb,S_GLO_Wyll_Cambion_491a7686-3081-405b-983c-289ec8781e0a);
KBSECTION
//REGION Debug

IF
TextEvent("wyllden")
THEN
TeleportTo(S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, TRIGGERGUID_S_DEN_WyllRecruitPoint_3a3551e1-f5eb-49d7-b46c-c29b60ee470d, "", 0, 0, 1);
SetFlag((FLAG)DEN_RaidingParty_Quest_GoblinRaidOver_98712d90-c46b-20c4-c4df-02c0117e85a5);
SetFlag((FLAG)DEN_RaidingParty_Event_GateIsOpened_735e0e81-bd67-eb67-87ac-40da4c3e6c49);

IF
TextEvent("wyll2camp")
THEN
PROC_DEN_Wyll_CleanTraining();
PROC_ORI_SetupCamp((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, 1);

IF
EntityEvent((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,"DebugTeleportedToCamp")
THEN
PROC_DEN_Wyll_CleanTraining();
PROC_ORI_SetupCamp((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, 1);
//END_REGION

//REGION Journal
IF
FlagSet((FLAG)CAMP_MizorasJudgement_Event_Reward_eb10f6f8-cf1a-a2b2-4421-63b0fbeb7a23,(CHARACTER)_Character,_)
AND
DB_Avatars((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d)
THEN
QuestUpdate(_Character,"ORI_Avatar_Wyll","MizorasJudgementReward");

//Can only be set with wyll present
IF
FlagSet((FLAG)CAMP_MizorasJudgement_Event_Reward_eb10f6f8-cf1a-a2b2-4421-63b0fbeb7a23,(CHARACTER)_Character,_)
AND
NOT DB_Avatars((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d)
THEN
QuestUpdate(_Character,"ORI_COM_Wyll","MizorasJudgementReward");

IF
FlagSet((FLAG)COL_MizorasRescue_Event_Reward_0e2f2a09-604c-2b9d-b8c0-db2baa1e6ac8,(CHARACTER)_Character,_)
AND
DB_Avatars((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d)
THEN
QuestUpdate(_Character,"ORI_Avatar_Wyll","MizorasRescueReward");

//Can only be set with wyll present
IF
FlagSet((FLAG)COL_MizorasRescue_Event_Reward_0e2f2a09-604c-2b9d-b8c0-db2baa1e6ac8,(CHARACTER)_Character,_)
AND
NOT DB_Avatars((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d)
THEN
QuestUpdate(_Character,"ORI_COM_Wyll","MizorasRescueReward");

//END_REGION


//REGION Dead while NPC
IF
TagSet((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, BLOCK_RESURRECTION_22a75dbb-1588-407e-b559-5aa4e6d4e6a6)
THEN
DB_GLO_CharacterCorpseDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_Dead_b6c0a1f8-5078-8819-4044-8425ef1e9c48);

IF
TagCleared((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, BLOCK_RESURRECTION_22a75dbb-1588-407e-b559-5aa4e6d4e6a6)
THEN
NOT DB_GLO_CharacterCorpseDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_Dead_b6c0a1f8-5078-8819-4044-8425ef1e9c48);

IF
DB_Defeated(S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d)
AND
NOT DB_PartOfTheTeam((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d)
THEN
ClearFlag(ORI_Wyll_State_Alive_1b20bb3c-71a5-4766-9b70-097cf5866ed7);
DB_ORI_Wyll_State_WasDefeated(1);

IF
DB_ORI_Wyll_State_WasDefeated(_)
AND
NOT DB_Defeated(S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d)
THEN
SetFlag(ORI_Wyll_State_Alive_1b20bb3c-71a5-4766-9b70-097cf5866ed7);

//END_REGION


//REGION DEN_HasMet 

IF
FlagSet(_HasMetDialogFlag,(CHARACTER)_Player,_)
AND
DB_DEN_HasMet_Wyll(_HasMetDialogFlag)
AND
DB_Players(_Player)
THEN
SetFlag(DEN_Wyll_Knows_UserTalkedToWyll_f0d1a322-e0b5-49d0-b744-cbca6956483b,_Player);

IF
FlagSet(ORI_Wyll_HasMet_e271ef1a-d321-4a77-96fc-9fd80dea1fcd,_,_)
AND
DB_Players(_Player)
THEN
SetFlag(DEN_Wyll_Knows_UserTalkedToWyll_f0d1a322-e0b5-49d0-b744-cbca6956483b,_Player);

//END_REGION


//REGION Post-DruidAttack Recruitment

PROC
PROC_DEN_DruidAttack_CombatEndedCleaning(DEN_DruidAttack_State_PrepAfterDeathOfDruids_b4754af7-07ec-433c-87d2-e78ef4c79e6e)
AND
DB_DEN_DruidAttack_NonDruids((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, _, _, _)
THEN
PROC_GLO_Origins_SetRecruitmentDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,Wyll_Recruitment_PostDruidAttack_PostEA_3c61d907-0397-abae-bf10-6ca114d84d0c);

//END_REGION


//REGION Move to Party Camp

//Act1 Den 
PROC
PROC_DEN_Wyll_CleanTraining()
THEN
ClearFlag((FLAG)DEN_Wyll_State_TrainingChildren_b949d261-4c0f-5eae-bee9-fa0fa0a8cea7); //for the tiefling trainer's dialog
//SetFlag((FLAG)DEN_WyllRecruitement_Event_FirstRecruitDone_d06c2f8c-ff27-8a50-d95f-690c04e84229); //doesn't seem to be used anywhere
//SetEntityEvent(S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, "GLO_Wyll_Event_MadePlayer"); //clean his behaviour
SetEntityEvent(S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, "DEN_States_Disable",1); //clean his behaviour
PROC_DEN_RemoveFromDenNPCs(S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d);
PROC_ForceStopDialog(S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d); //in case Wyll is ADing with a child

IF
FlagSet(DEN_Refugees_State_LeadersAreDead_1e6a42ed-8313-4f46-57e2-20dbdb2df923, _, _) // flagType: Global //TODO: tweak the timing
AND
NOT DB_OnlyOnce("RecruitedFirstTime_Wyll")
THEN
PROC_DEN_Wyll_CleanTraining();


// Camp
PROC
PROC_GLO_PartyMembers_AddHook((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(CHARACTER)_Player)
AND
QRY_OnlyOnce("RecruitedFirstTime_Wyll")
THEN
PROC_DEN_Wyll_CleanTraining();
PROC_ORI_SetupCamp((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, 0);
SetFlag((FLAG)ORI_Wyll_HasMet_e271ef1a-d321-4a77-96fc-9fd80dea1fcd);

IF
FlagSet((FLAG)ORI_WyllRecruitment_Event_InvitedToCamp_3bfee865-9937-07f5-7cc0-1cad51ca0e2e, _, _ID)
THEN
SetFlag(GLO_ORI_Event_InvitedToCamp_Run_07c4d37e-fc82-4055-b768-167650be9956, S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, _ID);

IF
DialogEnded((DIALOGRESOURCE)_Dialog,_)
AND
DB_OriginRecruitmentDialog(S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,_Dialog)
AND
DB_GlobalFlag((FLAG)ORI_WyllRecruitment_Event_InvitedToCamp_3bfee865-9937-07f5-7cc0-1cad51ca0e2e)
AND
QRY_OnlyOnce("ORI_Wyll_ToCamp")
THEN
PROC_DEN_Wyll_CleanTraining();

//END_REGION


//REGION Relationship dialogs
IF
FlagSet(_Flag,(CHARACTER)_Player,_)
AND
DB_RelationshipDialog_WRD_TriggerInCamp((DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,_Flag)
AND
DB_Avatars(_Player)
THEN
DB_ORI_Wyll_RelationshipDialogDone(_Flag);
DB_RelationshipDialogsFinished((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,_Flag);

IF
DB_RelationshipDialogsFinished((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,_Flag)
AND
DB_RelationshipDialog_Queue((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,_Flag,_Region,_PartnerDateOnly,_MinApproval)
THEN
NOT DB_RelationshipDialog_Queue((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,_Flag,_Region,_PartnerDateOnly,_MinApproval);

IF
DB_RelationshipDialogsFinished((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,(FLAG)_Flag)
AND
NOT DB_ORI_Wyll_RelationshipDialogDone(_Flag)
THEN
NOT DB_RelationshipDialogsFinished((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,(FLAG)_Flag);
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,(FLAG)_Flag,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

//REGION Karlach
IF //After Karlach confrontation
FlagSet((FLAG)GLO_WyllConfrontation_Event_WyllConfrontedKarlach_b20ae4fa-17df-bd3d-0630-8bef82761600,_,_)
AND
NOT DB_GlobalFlag((FLAG)ORI_Wyll_State_AwaitingJudgement_fc1db24a-f2c5-4ac2-a807-6acc320ac98b)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty2_Event_PostConfrontation_eb938f58-a165-503d-660e-6498218d18c0,(CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

IF //Party killed Karlach
FlagSet((FLAG)GLO_Karlach_State_Dead_26f3c3b0-a9c8-40d6-8950-67c9b8e134e2,_,_)
AND
NOT DB_GlobalFlag((FLAG)ORI_Wyll_State_AwaitingJudgement_fc1db24a-f2c5-4ac2-a807-6acc320ac98b)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty2_Event_PostConfrontation_eb938f58-a165-503d-660e-6498218d18c0,(CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

IF
FlagSet((FLAG)ORI_Wyll_State_AwaitingJudgement_fc1db24a-f2c5-4ac2-a807-6acc320ac98b,_,_)
THEN
NOT DB_CampNight_CRD((FLAG)NIGHT_WyllConfrontation_NotRecruited_b35ff12a-ceae-4bf8-94e2-5050576e4d6e,(CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty2_Event_PostConfrontation_eb938f58-a165-503d-660e-6498218d18c0);
NOT DB_CampNight_CRD((FLAG)NIGHT_WyllConfrontation_2576ba4e-90a9-4da0-bb40-6f012ed4a888,(CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty2_Event_PostConfrontation_eb938f58-a165-503d-660e-6498218d18c0);
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty2_Event_PostConfrontation_eb938f58-a165-503d-660e-6498218d18c0);

IF
FlagSet((FLAG)CAMP_MizorasJudgement_Event_Judged_c6d2140f-312d-65d4-e66e-92de4258b3f4,_,_)
THEN
NOT DB_CampNight_CRD((FLAG)NIGHT_WyllConfrontation_NotRecruited_b35ff12a-ceae-4bf8-94e2-5050576e4d6e,(CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty2_Event_PostConfrontation_eb938f58-a165-503d-660e-6498218d18c0);
NOT DB_CampNight_CRD((FLAG)NIGHT_WyllConfrontation_2576ba4e-90a9-4da0-bb40-6f012ed4a888,(CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty2_Event_PostConfrontation_eb938f58-a165-503d-660e-6498218d18c0);
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty2_Event_PostConfrontation_eb938f58-a165-503d-660e-6498218d18c0);

//END_REGION

//REGION Judgement
IF
FlagSet((FLAG)CAMP_MizorasJudgement_Event_Judged_c6d2140f-312d-65d4-e66e-92de4258b3f4,_,_)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,Wyll_InParty_Event_PostJudgementReflection_6d93654c-15c2-cf9f-a48c-868602ec76d4,(CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

//END_REGION

//REGION Tavern
//Rescued Florrick
IF
FlagSet((FLAG)PLA_Desire_Event_HasMet_39ac0b76-1aa6-063e-6f73-73e2292eab12,_,_)
AND
NOT DB_GlobalFlag((FLAG)ORI_Wyll_Knows_RavengardFather_ef46f733-7028-8629-260a-d333d2ef3ad4)
AND
NOT DB_GlobalFlag((FLAG)VISITEDREGION_CRE_Main_A_c22062f9-2a42-4e19-8c72-34a2d9ff9c0a)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_IPRD_Event_NewsOfRavengard_555f802b-8d81-4090-b52d-c5081b94791c,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

//Party left inn to burn
IF
FlagSet((FLAG)PLA_TavernInvestigation_State_BurntDown_ad34c392-4499-402c-ae51-8c3d40985f8b,_,_)
AND
DB_GlobalFlag((FLAG)PLA_Tavern_Knows_DukeInTavern_00bc7d69-5e0f-1054-db30-b429f31514f7)
AND
NOT DB_GlobalFlag((FLAG)PLA_Desire_Event_HasMet_39ac0b76-1aa6-063e-6f73-73e2292eab12)
AND
NOT DB_GlobalFlag((FLAG)ORI_Wyll_Knows_RavengardFather_ef46f733-7028-8629-260a-d333d2ef3ad4)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_IPRD_Event_NewsOfRavengard_555f802b-8d81-4090-b52d-c5081b94791c,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

//Entered act 2 without doing burning inn
IF
FlagSet((FLAG)VISITEDREGION_SCL_Main_A_f6e72539-9bc6-42e1-a20f-390f3a17ad8d,_,_)
AND
DB_GlobalFlag((FLAG)CAMP_MizorasJudgement_Event_Judged_c6d2140f-312d-65d4-e66e-92de4258b3f4)
AND
NOT DB_GlobalFlag((FLAG)PLA_Tavern_Knows_DukeInTavern_00bc7d69-5e0f-1054-db30-b429f31514f7)
AND
NOT DB_GlobalFlag((FLAG)PLA_Desire_Event_HasMet_39ac0b76-1aa6-063e-6f73-73e2292eab12)
AND
NOT DB_GlobalFlag((FLAG)ORI_Wyll_Knows_RavengardFather_ef46f733-7028-8629-260a-d333d2ef3ad4)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_IPRD_Event_NewsOfRavengard_555f802b-8d81-4090-b52d-c5081b94791c,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

IF
FlagSet((FLAG)ORI_Wyll_Knows_RavengardFather_ef46f733-7028-8629-260a-d333d2ef3ad4,_,_)
THEN
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
(FLAG)Wyll_IPRD_Event_NewsOfRavengard_555f802b-8d81-4090-b52d-c5081b94791c);

IF
FlagSet((FLAG)VISITEDREGION_BGO_Main_A_40f06537-814f-4796-b012-5ffaa648a8d9,_,_)
THEN
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
(FLAG)Wyll_IPRD_Event_NewsOfRavengard_555f802b-8d81-4090-b52d-c5081b94791c);

//Picked up note in CRE
IF
FlagSet((FLAG)CRE_Knows_DukeAtTowers_e824865c-67e5-ec2d-0778-ccace7ef90cf,_,_)
AND
NOT DB_GlobalFlag((FLAG)PLA_Desire_Event_HasMet_39ac0b76-1aa6-063e-6f73-73e2292eab12)
AND
NOT DB_GlobalFlag((FLAG)GLO_MoonriseTower_EverEnteredBefore_26aeabb0-7644-4897-9bbd-7a95e3e8930f)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_BookAbduction_7586554f-a33f-444f-107b-86f332f4474b,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

IF
FlagSet((FLAG)GLO_MoonriseTower_EverEnteredBefore_26aeabb0-7644-4897-9bbd-7a95e3e8930f,_,_)
THEN
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_BookAbduction_7586554f-a33f-444f-107b-86f332f4474b);

//END_REGION

//REGION Act2
//After seeing Raphael in HAV
IF
FlagSet((FLAG)HAV_MolsDeal_Event_FinishedGame_eadeec6e-e1ea-3aaf-6800-c92f904a9abe,_,_)
AND
NOT DB_GlobalFlag((FLAG)HAV_TakingIsobel_Event_MolKidnapped_1a87fee7-163a-477c-b84d-cc0fbb74dbe2)
AND
NOT DB_GlobalFlag((FLAG)COL_KethericShowdown_Event_SawRavengardTadpoled_4c3514d1-7fe4-6ce5-8cc4-fc061c79d0b7)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_MolsDeal_49c98013-6562-728f-22d2-1f19c3672dc6,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

IF
FlagSet((FLAG)HAV_TakingIsobel_Event_MolKidnapped_1a87fee7-163a-477c-b84d-cc0fbb74dbe2,_,_)
THEN
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_MolsDeal_49c98013-6562-728f-22d2-1f19c3672dc6);

IF
FlagSet((FLAG)COL_KethericShowdown_Event_SawRavengardTadpoled_4c3514d1-7fe4-6ce5-8cc4-fc061c79d0b7,_,_)
THEN
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_MolsDeal_49c98013-6562-728f-22d2-1f19c3672dc6);

//Ravengard was tadpoled
IF
FlagSet(COL_KethericShowdown_Event_SawRavengardTadpoled_4c3514d1-7fe4-6ce5-8cc4-fc061c79d0b7,_,_)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_AfterRavengardTadpoled_8cb4a17e-5611-3866-3d59-20edd8e106ce,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

IF
FlagSet((FLAG)VISITEDREGION_BGO_Main_A_40f06537-814f-4796-b012-5ffaa648a8d9,_,_)
THEN
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
(FLAG)Wyll_InParty2_Event_AfterRavengardTadpoled_8cb4a17e-5611-3866-3d59-20edd8e106ce);

//After Mizora's capture
IF
FlagSet((FLAG)TWN_Wyll_State_MizorasCaptureHappened_80cb617e-e3c3-3386-3919-6caef51bfd5d,_,_)
AND
NOT DB_GlobalFlag((FLAG)COL_MizorasRescue_State_SavedMizora_148bcec2-5367-2b72-3c93-29fb32fc0181)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_DiscussedLemure_b9e7a27f-b1a3-6f3b-32e7-dddbf17d589c,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

IF
FlagSet((FLAG)COL_MizorasRescue_State_SavedMizora_148bcec2-5367-2b72-3c93-29fb32fc0181,_,_)
THEN
NOT DB_CampNight_CRD((FLAG)NIGHT_Wyll_MizorasPact_c9b8d342-34b8-4d2e-a254-fe8bcae71df3,(CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,(FLAG)Wyll_InParty2_Event_DiscussedLemure_b9e7a27f-b1a3-6f3b-32e7-dddbf17d589c);
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_DiscussedLemure_b9e7a27f-b1a3-6f3b-32e7-dddbf17d589c);

//Mizora freed
IF
FlagSet((FLAG)COL_MizorasRescue_State_SavedMizora_148bcec2-5367-2b72-3c93-29fb32fc0181,_,_)
AND
NOT DB_GlobalFlag((FLAG)COL_KethericShowdown_Event_SawRavengardTadpoled_4c3514d1-7fe4-6ce5-8cc4-fc061c79d0b7)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
(FLAG)Wyll_IPRD_Event_FreedMizoraBeforeKetheric_dd622810-bb65-4115-b1c7-7c6a2107ea41,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

IF
FlagSet((FLAG)COL_KethericShowdown_Event_SawRavengardTadpoled_4c3514d1-7fe4-6ce5-8cc4-fc061c79d0b7,_,_)
THEN
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
(FLAG)Wyll_IPRD_Event_FreedMizoraBeforeKetheric_dd622810-bb65-4115-b1c7-7c6a2107ea41);

//END_REGION

//REGION Gortash
//Seeing refugees in WYR
IF
FlagSet((FLAG)WYR_South_State_AccessGranted_3339af4f-3214-4d10-aaab-3d3511b9ab74,_,_)
AND
NOT DB_GlobalFlag((FLAG)WYR_KillDirectorGortash_State_VisitedAudienceHall_8984a8f4-c0fa-4797-967b-b8024a7db9b7)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_Refugees_f13d05b7-7116-868c-72b8-054da92a46b6,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

IF
FlagSet((FLAG)WYR_KillDirectorGortash_State_VisitedAudienceHall_8984a8f4-c0fa-4797-967b-b8024a7db9b7,_,_)
THEN
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_Refugees_f13d05b7-7116-868c-72b8-054da92a46b6);

//Spoke with Ravengard after ceremony
IF
FlagSet((FLAG)WYR_KillDirectorGortash_HasMetRavengard_11646fca-54a8-050f-1277-fe173058e1c6,_,_)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_CeremonyRavengard_76fd2be1-7887-8d49-25c0-41c0d10f4e29,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

IF
FlagSet((FLAG)WYR_MeetingMizora_Event_MizoraLeftWYR_03f1d319-d5f4-8aa1-0f0d-d58e5b32bf2e,_,_)
THEN
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_CeremonyRavengard_76fd2be1-7887-8d49-25c0-41c0d10f4e29);

IF
FlagSet((FLAG)GLO_Ravengard_State_Defeated_7bb624ef-09cb-4e55-b035-832c05427a61,_,_)
THEN
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_CeremonyRavengard_76fd2be1-7887-8d49-25c0-41c0d10f4e29);

//Killed Ravengard in ceremony
IF
FlagSet((FLAG)WYR_KillDirectorGortash_State_RavengardKilledDuringCeremony_40b81270-9d42-4e46-bd96-6295c8b2b7e2,_,_)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_KilledRavengard_412753ea-dda8-3e96-a729-36d178f25bdb,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

IF
FlagSet((FLAG)WYR_MeetingMizora_Event_MizoraLeftWYR_03f1d319-d5f4-8aa1-0f0d-d58e5b32bf2e,_,_)
THEN
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_KilledRavengard_412753ea-dda8-3e96-a729-36d178f25bdb);

//Met Mizora on bridge
IF
FlagSet((FLAG)WYR_MeetingMizora_Event_MizoraLeftWYR_03f1d319-d5f4-8aa1-0f0d-d58e5b32bf2e,_,_)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_ReactToMizoraBridge_deebb97d-84ae-987d-26d2-4eca2f2d5159,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

IF
FlagSet((FLAG)CAMP_MizorasPact_Event_PactScene_022d6a0a-15fe-09b2-2897-268d9a34a381,_,_)
THEN
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
(FLAG)Wyll_InParty2_Event_ReactToMizoraBridge_deebb97d-84ae-987d-26d2-4eca2f2d5159);

//END_REGION

//REGION Pact
//Wyll pacted
IF
FlagSet(CAMP_MizorasPact_Event_PactScene_022d6a0a-15fe-09b2-2897-268d9a34a381,_,_)
AND
NOT DB_GlobalFlag((FLAG)IRN_IronThrone_State_Visited_5b3fb5a7-61e8-44a9-a0a1-b6b45b59a23c)
AND
NOT DB_GlobalFlag((FLAG)LOW_FlorrickFight_Event_FlorrickFightStarted_dd53d2e3-09f8-edaf-162c-1ecd6a2f27d3)
AND
NOT DB_GlobalFlag((FLAG)LOW_FlorrickFighFallback_Event_Occurred_06b38288-ee5f-630c-153d-39c2e90ae55f)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
(FLAG)Wyll_InParty2_Event_AfterPact_a64af098-7121-0913-30e8-5aba415c737c,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

IF
FlagSet((FLAG)IRN_IronThrone_State_Visited_5b3fb5a7-61e8-44a9-a0a1-b6b45b59a23c,_,_)
THEN
NOT DB_CampNight_CRD((FLAG)NIGHT_Wyll_MizorasPact_c9b8d342-34b8-4d2e-a254-fe8bcae71df3,(CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,(FLAG)Wyll_InParty2_Event_AfterPact_a64af098-7121-0913-30e8-5aba415c737c);
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
(FLAG)Wyll_InParty2_Event_AfterPact_a64af098-7121-0913-30e8-5aba415c737c);

IF
FlagSet((FLAG)LOW_FlorrickFight_Event_FlorrickFightStarted_dd53d2e3-09f8-edaf-162c-1ecd6a2f27d3,_,_)
THEN
NOT DB_CampNight_CRD((FLAG)NIGHT_Wyll_MizorasPact_c9b8d342-34b8-4d2e-a254-fe8bcae71df3,(CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,(FLAG)Wyll_InParty2_Event_AfterPact_a64af098-7121-0913-30e8-5aba415c737c);
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
(FLAG)Wyll_InParty2_Event_AfterPact_a64af098-7121-0913-30e8-5aba415c737c);

IF
FlagSet((FLAG)LOW_FlorrickFighFallback_Event_Occurred_06b38288-ee5f-630c-153d-39c2e90ae55f,_,_)
THEN
NOT DB_CampNight_CRD((FLAG)NIGHT_Wyll_MizorasPact_c9b8d342-34b8-4d2e-a254-fe8bcae71df3,(CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,(FLAG)Wyll_InParty2_Event_AfterPact_a64af098-7121-0913-30e8-5aba415c737c);
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
(FLAG)Wyll_InParty2_Event_AfterPact_a64af098-7121-0913-30e8-5aba415c737c);

IF
FlagSet((FLAG)WYR_Ravengard_State_Resurrected_86c9572d-84e7-b407-0ce6-84fd263418a1,_,_)
THEN
NOT DB_CampNight_CRD((FLAG)NIGHT_Wyll_MizorasPact_c9b8d342-34b8-4d2e-a254-fe8bcae71df3,(CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,(FLAG)Wyll_InParty2_Event_AfterPact_a64af098-7121-0913-30e8-5aba415c737c);
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
(FLAG)Wyll_InParty2_Event_AfterPact_a64af098-7121-0913-30e8-5aba415c737c);

//Ravengard died offscreen (either cause of SWF or before pact happened)
IF
FlagSet((FLAG)GLO_Ravengard_State_SeenDeadRavengardDuringIRN_43cea123-9650-46f3-99d4-64c6d284ef1f, _, _)
AND
DB_GlobalFlag((FLAG)IRN_Ravengard_State_KilledOffscreenByMizoraBeforePactScene_f4a0eace-8c06-4d5e-a446-7b5e64d3b80f)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_ReactedRavengardDeath_374e2383-f0e9-4353-3e35-9dd10c03eb9a,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

IF
FlagSet((FLAG)CAMP_MizorasPact_Event_PactScene_022d6a0a-15fe-09b2-2897-268d9a34a381,_,_)
THEN
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
(FLAG)Wyll_InParty2_Event_ReactedRavengardDeath_374e2383-f0e9-4353-3e35-9dd10c03eb9a);

//END_REGION

//REGION Mizora ROM

//After sleeping with Mizora
IF
FlagSet((FLAG)CAMP_Mizora_Event_RomancedMizora_b5bb0f61-64ac-255e-a7c7-9d3b6f84ea31,_,_)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_AfterMizoraROM_a63cc1a1-f36a-0821-f445-85917eec0b6f,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

//END_REGION

//REGION Ansur book
//Learned of Ansur from book
IF
FlagSet(WYR_AnsurGhost_Knows_ReadAnsurBook_f3b0cdca-7994-499f-bb8e-528240fdf0a3,_,_)
AND
NOT DB_GlobalFlag(GLO_Wyll_Event_RavengardWyrmwayQuest_a0383a14-5576-656c-1030-2439279ffc82)
AND
NOT DB_GlobalFlag(LOW_FlorrickFight_Event_WyrmquestFlorrick_b3e70fdc-fc1f-5302-bce6-723d8473efff)
AND
NOT DB_GlobalFlag(LOW_FlorrickFightFallback_Event_WyrmQuestEltan_d9a028ec-b6a5-233f-19a8-78ff74020fe7)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_TalkedOfLegend_fd103700-84c5-4bcf-04dd-3bdbc79a1668,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

IF
FlagSet(WYR_Wyrmway_State_EntryOpened_d8cad828-82f3-4a9b-ad0d-6f1637792d4e,_,_)
THEN
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_TalkedOfLegend_fd103700-84c5-4bcf-04dd-3bdbc79a1668);

//Ravengard sent after Ansur
IF
FlagSet(GLO_Wyll_Event_RavengardWyrmwayQuest_a0383a14-5576-656c-1030-2439279ffc82,_,_)
AND
NOT DB_GlobalFlag((FLAG)WYR_SkeletalDragon_State_Defeated_bafbffed-bb3f-43b0-a006-7bac257a633c)
AND
NOT DB_GlobalFlag((FLAG)WYR_Wyrmway_State_EntryOpened_d8cad828-82f3-4a9b-ad0d-6f1637792d4e)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_RavengardWyrm_9c7bcda3-56f2-c1f8-13fb-cecd5f4c88fd,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

IF
FlagSet(WYR_SkeletalDragon_State_Defeated_bafbffed-bb3f-43b0-a006-7bac257a633c,_,_)
THEN
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_RavengardWyrm_9c7bcda3-56f2-c1f8-13fb-cecd5f4c88fd);

IF
FlagSet(WYR_Wyrmway_State_EntryOpened_d8cad828-82f3-4a9b-ad0d-6f1637792d4e,_,_)
THEN
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_RavengardWyrm_9c7bcda3-56f2-c1f8-13fb-cecd5f4c88fd);

//END_REGION

//REGION Florrick Fight
//Killed Eltan 
IF
FlagSet((FLAG)LOW_FlorrickFighFallback_State_EltanDefeated_23009487-3277-46ca-b376-d2c998c5ef2f,_,_)
AND
NOT DB_GlobalFlag((FLAG)WYR_SkeletalDragon_State_Defeated_bafbffed-bb3f-43b0-a006-7bac257a633c)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_FlorrickEltanWyrm_49cdaaf3-805f-cba6-e0af-ec167bd803d7,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

//Killed Florrick
IF
FlagSet((FLAG)GLO_Florrick_State_PermaDefeated_c190fb1f-4c27-4948-87f0-29dc5a9b5b55,_,_)
AND
NOT DB_GlobalFlag((FLAG)WYR_SkeletalDragon_State_Defeated_bafbffed-bb3f-43b0-a006-7bac257a633c)
AND
DB_GlobalFlag(LOW_FlorrickFight_State_Hostile_b34101ae-27e0-dfbd-5d57-7ee968631f7d)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_FlorrickEltanWyrm_49cdaaf3-805f-cba6-e0af-ec167bd803d7,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

//Eltan sent after Ansur
IF
FlagSet((FLAG)LOW_FlorrickFightFallback_Event_WyrmQuestEltan_d9a028ec-b6a5-233f-19a8-78ff74020fe7,_,_)
AND
NOT DB_GlobalFlag((FLAG)WYR_SkeletalDragon_State_Defeated_bafbffed-bb3f-43b0-a006-7bac257a633c)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_FlorrickEltanWyrm_49cdaaf3-805f-cba6-e0af-ec167bd803d7,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

// Florrick sent after Ansur
IF
FlagSet((FLAG)LOW_FlorrickFight_Event_WyrmquestFlorrick_b3e70fdc-fc1f-5302-bce6-723d8473efff,_,_)
AND
NOT DB_GlobalFlag((FLAG)WYR_SkeletalDragon_State_Defeated_bafbffed-bb3f-43b0-a006-7bac257a633c)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_FlorrickEltanWyrm_49cdaaf3-805f-cba6-e0af-ec167bd803d7,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

IF
FlagSet(WYR_Wyrmway_State_EntryOpened_d8cad828-82f3-4a9b-ad0d-6f1637792d4e,_,_)
THEN
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_FlorrickEltanWyrm_49cdaaf3-805f-cba6-e0af-ec167bd803d7);

//END_REGION

//REGION Wyrmway
//Ansur dead, Ravengard in camp
IF
DB_GlobalFlag((FLAG)WYR_SkeletalDragon_State_Defeated_bafbffed-bb3f-43b0-a006-7bac257a633c)
AND
DB_GlobalFlag((FLAG)CAMP_Ravengard_State_RavengardInCamp_37309008-04cf-493c-8ca6-43034d331a8a)
AND
DB_GlobalFlag((FLAG)CAMP_MizorasPact_Event_PactScene_022d6a0a-15fe-09b2-2897-268d9a34a381)
AND
NOT DB_GlobalFlag((FLAG)GLO_Ravengard_State_Defeated_7bb624ef-09cb-4e55-b035-832c05427a61)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_TalkedAboutHeart_12fecc65-b6f4-4dc3-3832-2f81314fc22d,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

IF
FlagSet((FLAG)CAMP_Ravengard_Event_TurnedInQuest_d7e46c3c-e6a1-b962-d7c8-04fa3eaa2242,_,_)
THEN
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_TalkedAboutHeart_12fecc65-b6f4-4dc3-3832-2f81314fc22d);

IF
FlagSet((FLAG)END_General_State_Started_a0fd5f91-e4b3-4d01-84d3-9ff484139e99,_,_)
THEN
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_TalkedAboutHeart_12fecc65-b6f4-4dc3-3832-2f81314fc22d);

IF
FlagSet((FLAG)GLO_Ravengard_State_Defeated_7bb624ef-09cb-4e55-b035-832c05427a61,_,_)
THEN
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_TalkedAboutHeart_12fecc65-b6f4-4dc3-3832-2f81314fc22d);

//Ansur dead, Ravengard not available
IF
DB_GlobalFlag((FLAG)WYR_SkeletalDragon_State_Defeated_bafbffed-bb3f-43b0-a006-7bac257a633c)
AND
DB_GlobalFlag((FLAG)CAMP_MizorasPact_State_WyllReleasedFromPact_79a90490-b009-507c-e0d3-f79b0bdd4cb6)
AND
DB_GlobalFlag((FLAG)LOW_FlorrickFight_Event_FlorrickFightStarted_dd53d2e3-09f8-edaf-162c-1ecd6a2f27d3)
AND
NOT DB_GlobalFlag((FLAG)CAMP_Ravengard_State_RavengardInCamp_37309008-04cf-493c-8ca6-43034d331a8a)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_IPRD_Event_Finale_1569ec67-be68-4227-8ed4-d6c2f96ead52,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

IF
DB_GlobalFlag((FLAG)WYR_SkeletalDragon_State_Defeated_bafbffed-bb3f-43b0-a006-7bac257a633c)
AND
DB_GlobalFlag((FLAG)CAMP_MizorasPact_State_WyllReleasedFromPact_79a90490-b009-507c-e0d3-f79b0bdd4cb6)
AND
DB_GlobalFlag((FLAG)LOW_FlorrickFighFallback_Event_Occurred_06b38288-ee5f-630c-153d-39c2e90ae55f)
AND
NOT DB_GlobalFlag((FLAG)CAMP_Ravengard_State_RavengardInCamp_37309008-04cf-493c-8ca6-43034d331a8a)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_IPRD_Event_Finale_1569ec67-be68-4227-8ed4-d6c2f96ead52,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

IF
FlagSet((FLAG)CAMP_Ravengard_Event_TurnedInQuest_d7e46c3c-e6a1-b962-d7c8-04fa3eaa2242,_,_)
THEN
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_IPRD_Event_Finale_1569ec67-be68-4227-8ed4-d6c2f96ead52);

IF
FlagSet((FLAG)END_General_State_Started_a0fd5f91-e4b3-4d01-84d3-9ff484139e99,_,_)
THEN
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_IPRD_Event_Finale_1569ec67-be68-4227-8ed4-d6c2f96ead52);

//END_REGION

//REGION  Finale
//Wyll chose to be Grand Duke
IF
FlagSet((FLAG)GLO_Wyll_State_GrandDuke_0e223e4d-be63-89f4-380f-5cc755817abd,_,_)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_MusedGrandDuke_9624400b-e075-f015-b90b-beff3d6adae6,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

//Wyll chose to be Blade of Frontiers
IF
FlagSet((FLAG)GLO_Wyll_State_BladeOfFrontiers_8c46322f-7965-94c7-1318-62c391f1c8f1,_,_)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_MusedBlade_879e7ec6-56a5-bada-f54f-14fd5e5ffe07,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

//Wyll chose to be Blade of Avernus
IF
FlagSet((FLAG)GLO_Wyll_State_BladeOfAvernus_faeb73da-a609-dc56-7745-ac07f795c137,_,_)
THEN
PROC_RelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_MusedBlade_879e7ec6-56a5-bada-f54f-14fd5e5ffe07,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,0);

IF
FlagSet((FLAG)END_General_State_Started_a0fd5f91-e4b3-4d01-84d3-9ff484139e99,_,_)
THEN
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_MusedGrandDuke_9624400b-e075-f015-b90b-beff3d6adae6);
PROC_CancelRelationshipDialog((CHARACTER)S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(DIALOGRESOURCE)Wyll_InParty_6dff0a1f-1a51-725d-6e9a-52b5742ba9e6,
Wyll_InParty2_Event_MusedBlade_879e7ec6-56a5-bada-f54f-14fd5e5ffe07);

//END_REGION

//END_REGION


//REGION Wyll transform into devil
IF
TagSet(S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,(TAG)WYLL_DEVIL_5e844f0e-d822-4210-a28e-6af149a7bd4b)
THEN
Transform(S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d,ORIGIN_Wyll_Devil_7ea87604-e604-4a6d-a7ac-b7b2f293c000,(SHAPESHIFTRULE)WyllDevil_884b16b1-e4e1-474a-8de4-fb1836491f01);

//END_REGION


//REGION Mizora is always up for a chat with Wyll.

QRY
QRY_SpeakerIsInDialogRange(S_GLO_Wyll_Cambion_491a7686-3081-405b-983c-289ec8781e0a, S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d)
THEN
DB_NOOP(1);

//END_REGION


//REGION Mizora avoiding conflict
IF
AttackedBy(S_GLO_Wyll_Cambion_491a7686-3081-405b-983c-289ec8781e0a,_,_,_,_,_,_)
AND
HasActiveStatus(S_GLO_Wyll_Cambion_491a7686-3081-405b-983c-289ec8781e0a,"GLO_MIZORA_INVULNERABLE",1)
AND
NOT DB_GLO_Mizora_DisappearedAfterHit(1)
THEN
PROC_GLO_Monitor_EntityPoof(S_GLO_Wyll_Cambion_491a7686-3081-405b-983c-289ec8781e0a); //TODO: change to mizora's teleport
DB_GLO_Mizora_DisappearedAfterHit(1);
ObjectTimerLaunch(S_GLO_Wyll_Cambion_491a7686-3081-405b-983c-289ec8781e0a,"MizoraWasAttacked_RespawnDelay",10000);

IF
ObjectTimerFinished(S_GLO_Wyll_Cambion_491a7686-3081-405b-983c-289ec8781e0a,"MizoraWasAttacked_RespawnDelay")
THEN
SetHitpointsPercentage(S_GLO_Wyll_Cambion_491a7686-3081-405b-983c-289ec8781e0a,100.0);
RemoveHarmfulStatuses(S_GLO_Wyll_Cambion_491a7686-3081-405b-983c-289ec8781e0a);
PROC_GLO_Monitor_EntityFoop(S_GLO_Wyll_Cambion_491a7686-3081-405b-983c-289ec8781e0a); //TODO: change to mizora's teleport
NOT DB_GLO_Mizora_DisappearedAfterHit(1);

//END_REGION


//REGION Banter

IF
DB_Is_InCombat(S_Player_Gale_ad9af97d-75da-406a-ae13-7071c563f604, _ID)
AND
DB_Is_InCombat(S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d, _ID)
THEN
SetFlag(GLO_Gale_Wyll_State_WereInCombatTogether_e06efcf9-bff3-4a80-8a25-c5704b06533f);

IF
DB_GlobalFlag(DEN_Wyll_State_TrainingChildren_b949d261-4c0f-5eae-bee9-fa0fa0a8cea7)
AND
NOT DB_GlobalFlag(ORI_Wyll_Event_SawTraining_a5dd3ffa-04f0-4c40-a867-c4ede30076ab)
AND
DB_Sees(_Char,S_Player_Wyll_c774d764-4a17-48dc-b470-32ace9ce447d)
AND
DB_Players(_Char)
THEN
SetFlag(ORI_Wyll_Event_SawTraining_a5dd3ffa-04f0-4c40-a867-c4ede30076ab);
//END_REGION


//REGION Mizora Animations
//Move Entity to Destination level first
PROC
PROC_GLO_MizoraAppear((GUIDSTRING)_Entity,(GUIDSTRING)_Destination, (STRING)_String)
AND
Exists(_Entity, 1)
AND
GetPosition(_Destination, _X, _Y, _Z)
THEN
TeleportTo(_Entity, _Destination, "GLO_MizoraAppear_TeleportedToDestination", 0, 0, 0, 0, 1);
DB_GLO_MizoraAppear_TeleportingEntity((GUIDSTRING)_Entity, (REAL)_X, (REAL)_Y, (REAL)_Z, (STRING)_String); 

PROC
PROC_GLO_MizoraAppear((GUIDSTRING)_Entity,(REAL)_X,(REAL)_Y, (REAL)_Z, (STRING)_String)
AND
Exists(_Entity, 1)
THEN
TeleportToPosition(_Entity, _X, _Y, _Z, "GLO_MizoraAppear_TeleportedToDestination", 0, 0, 0, 0, 1);
DB_GLO_MizoraAppear_TeleportingEntity((GUIDSTRING)_Entity, (REAL)_X, (REAL)_Y, (REAL)_Z, (STRING)_String); 

IF
EntityEvent(_Entity, "GLO_MizoraAppear_TeleportedToDestination")
AND
DB_GLO_MizoraAppear_TeleportingEntity(_Entity, _X, _Y, _Z, _String)
AND
NOT QRY_GLO_MizoraAppear_Override(_Entity, _X, _Y, _Z, _String)
THEN
PROC_GLO_Monitor_EntityFoop(_Entity);
RealtimeObjectTimerLaunch(_Entity, _String, 2000);
DB_GLO_MizoraAppear_Delay((GUIDSTRING)_Entity, (STRING)_String);

IF
EntityEvent(_Entity, "GLO_MizoraAppear_TeleportedToDestination")
AND
DB_GLO_MizoraAppear_TeleportingEntity(_Entity, _X, _Y, _Z, _String)
THEN
NOT DB_GLO_MizoraAppear_TeleportingEntity(_Entity, _X, _Y, _Z, _String);

QRY
QRY_GLO_MizoraAppear_Override((GUIDSTRING)_Entity, (REAL)_X, (REAL)_Y, (REAL)_Z, (STRING)_String)
AND
1 == 0
THEN
DB_NOOP(1);

QRY
QRY_GLO_MizoraAppear_Override((CHARACTER)S_GLO_Wyll_Cambion_491a7686-3081-405b-983c-289ec8781e0a, (REAL)_X, (REAL)_Y, (REAL)_Z, (STRING)_String)
THEN
PROC_SetOnStage((CHARACTER)S_GLO_Wyll_Cambion_491a7686-3081-405b-983c-289ec8781e0a, 1);
AppearAtPosition((CHARACTER)S_GLO_Wyll_Cambion_491a7686-3081-405b-983c-289ec8781e0a, _X, _Y, _Z, 1, CUST_MizoraTeleIn_01_99069369-88a0-4580-84ab-aa34788cb509, "", 0);
RealtimeObjectTimerLaunch(S_GLO_Wyll_Cambion_491a7686-3081-405b-983c-289ec8781e0a, _String, 2000);
DB_GLO_MizoraAppear_Delay((CHARACTER)S_GLO_Wyll_Cambion_491a7686-3081-405b-983c-289ec8781e0a, (STRING)_String);

QRY
QRY_GLO_MizoraAppear_Override((CHARACTER)S_GLO_Ravengard_f6620372-ebd0-4511-a39d-8c2d4ad03f03, (REAL)_X, (REAL)_Y, (REAL)_Z, (STRING)_String)
THEN
PROC_SetOnStage((CHARACTER)S_GLO_Ravengard_f6620372-ebd0-4511-a39d-8c2d4ad03f03, 1);
AppearAtPosition((CHARACTER)S_GLO_Ravengard_f6620372-ebd0-4511-a39d-8c2d4ad03f03, _X, _Y, _Z, 1, CUST_DukeRavengardTeleIn_01_b8635076-a1e5-4e33-b0be-2f280f2d5c87, "", 0);
RealtimeObjectTimerLaunch(S_GLO_Ravengard_f6620372-ebd0-4511-a39d-8c2d4ad03f03, _String, 2000);
DB_GLO_MizoraAppear_Delay((CHARACTER)S_GLO_Ravengard_f6620372-ebd0-4511-a39d-8c2d4ad03f03, (STRING)_String);

IF
ObjectTimerFinished(_Entity, _String)
AND
DB_GLO_MizoraAppear_Delay((GUIDSTRING)_Entity,_String)
THEN
NOT DB_GLO_MizoraAppear_Delay((GUIDSTRING)_Entity, _String);
SetEntityEvent(_Entity,_String, 1);
PROC_GLO_MizoraAppear_AppearedHook(_Entity, _String);

PROC
PROC_GLO_MizoraAppear_AppearedHook((GUIDSTRING)_Entity, (STRING)_String)
THEN
DB_NOOP(1);

PROC
PROC_GLO_MizoraDisappear((GUIDSTRING)_Entity, (STRING)_String)
AND
Exists(_Entity, 1)
AND
NOT QRY_GLO_MizoraDisappear_Override(_Entity, _String)
THEN
PROC_GLO_Monitor_EntityPoof(_Entity);
PROC_GLO_MizoraDisappear_DisappearedHook(_Entity, _String);

QRY
QRY_GLO_MizoraDisappear_Override((GUIDSTRING)_Entity, (STRING)_String)
AND
1 == 0
THEN
DB_NOOP(1);

QRY
QRY_GLO_MizoraDisappear_Override((CHARACTER)S_GLO_Wyll_Cambion_491a7686-3081-405b-983c-289ec8781e0a, (STRING)_String)
THEN
DB_GLO_MizoraDisappear_Disappearing(S_GLO_Wyll_Cambion_491a7686-3081-405b-983c-289ec8781e0a, _String);
PlayAnimation((CHARACTER)S_GLO_Wyll_Cambion_491a7686-3081-405b-983c-289ec8781e0a, CUST_MizoraTeleOut_01_74c0de2d-e834-4613-a5ea-02bd8be9ab2f,"");

QRY
QRY_GLO_MizoraDisappear_Override((CHARACTER)S_GLO_Ravengard_f6620372-ebd0-4511-a39d-8c2d4ad03f03, (STRING)_String)
THEN
DB_GLO_MizoraDisappear_Disappearing(S_GLO_Ravengard_f6620372-ebd0-4511-a39d-8c2d4ad03f03, _String);
PlayAnimation((CHARACTER)S_GLO_Ravengard_f6620372-ebd0-4511-a39d-8c2d4ad03f03, CUST_DukeRavengardTeleOut_01_6c40557c-1688-4dfe-ac0f-4d70db4f9dff,"");

IF
AnimationEvent(_Character, "AnimationSetOffStage", 0)
AND
DB_GLO_MizoraDisappear_Disappearing((CHARACTER)_Character, _String)
THEN
NOT DB_GLO_MizoraDisappear_Disappearing(_Character, _String);
PROC_SetOnStage((CHARACTER)_Character, 0);
PROC_GLO_MizoraDisappear_DisappearedHook(_Character, _String);

PROC
PROC_GLO_MizoraDisappear_DisappearedHook((GUIDSTRING)_Character, (STRING)_String)
THEN
DB_NOOP(1);
//END_REGION
EXITSECTION

ENDEXITSECTION
ParentTargetEdge "ModWrapper_Gustav"
