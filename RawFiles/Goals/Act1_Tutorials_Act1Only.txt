Version 1
SubGoalCombiner SGC_AND
INITSECTION
//Tutorials that are confined within Act 1
DB_Act1_TutorialTriggers_SeeingInDark((TRIGGER)S_Tutorials_SeeingInTheDark_01_8a85e7a7-0389-468a-8b1e-662c4fdf6c0f);
DB_Act1_TutorialTriggers_SeeingInDark((TRIGGER)S_FOR_ThayanCellar_SafeBubble_cc621ff4-1971-4084-9a5b-c47d3050640d);
DB_Act1_TutorialTriggers_SeeingInDark((TRIGGER)S_FOR_Bottomless_WellCave_2ae9c8b4-c714-49aa-97e4-675050ce3a6d);
DB_Act1_TutorialTriggers_SeeingInDark((TRIGGER)S_UND_Underdark_SUB_b379a862-a59f-4e52-9166-23fbe0e8976e);

DB_Act1_TutorialTriggers_Sneak((TRIGGER)S_Tutorials_Sneak_01_202e3e76-f42f-45bf-bdac-e56163b28603);
DB_Act1_TutorialTriggers_Sneak((TRIGGER)S_Tutorials_Sneak_02_6bb8607a-4938-4ac4-823f-be77404f9017);
DB_Act1_TutorialTriggers_Sneak((TRIGGER)S_Tutorials_Sneak_03_97d6bd8b-ca63-439a-b4d0-d67d4e39ff25);
DB_Act1_TutorialTriggers_Sneak((TRIGGER)S_Tutorials_Sneak_04_61d2b81f-34f2-4117-8614-55a865ea66a5);
DB_Act1_TutorialTriggers_Sneak((TRIGGER)S_Tutorials_Sneak_05_d39d00b2-64c2-40ee-a1f3-d5f3a61115a4);
DB_Act1_TutorialTriggers_Sneak((TRIGGER)S_Tutorials_Sneak_06_62bfd292-611b-482d-beda-f62aa6f3a9c0);

DB_Act1_TutorialEntities_NonLethalAttacks_Opponents((CHARACTER)S_CHA_CagerLaezel2_863d6788-5887-45c8-bafa-87128631904e);
DB_Act1_TutorialEntities_NonLethalAttacks_Opponents((CHARACTER)S_CHA_CagerLaezel1_2c8537fb-bf73-43a2-a8ff-48e41453adea);
DB_Act1_TutorialEntities_NonLethalAttacks_Opponents((CHARACTER)S_HAG_Hag_MaskedVictim1_d2832662-4a12-4565-bfe2-094b93ae8af8);
DB_Act1_TutorialEntities_NonLethalAttacks_Opponents((CHARACTER)S_HAG_Hag_MaskedVictim2_535f23bc-2d27-4c40-a1f3-1cf58bfd1698);
DB_Act1_TutorialEntities_NonLethalAttacks_Opponents((CHARACTER)S_HAG_Hag_MaskedVictim3_d7707fd3-301b-49a3-b7f1-2fb92cfa9805);
DB_Act1_TutorialEntities_NonLethalAttacks_Opponents((CHARACTER)S_HAG_Hag_MaskedVictim4_74dcb337-e6d1-4329-ac2b-5a3723346159);

DB_Act1_TutorialEntities_HighGroundAdvantage_Opponents((CHARACTER)S_CHA_Exterior_Bandit_Ranger_01_fa1a1fbd-2152-40e4-b53d-29e95d54279e);
DB_Act1_TutorialEntities_HighGroundAdvantage_Opponents((CHARACTER)S_CHA_Exterior_Bandit_Melee_02_b5c913f9-f081-45bd-8e95-e34d0735b645);
DB_Act1_TutorialEntities_HighGroundAdvantage_Opponents((CHARACTER)S_CHA_Exterior_Bandit_Caster_01_0f4300f6-0e1e-4d6c-a582-5da588d64ea7);
DB_Act1_TutorialEntities_HighGroundAdvantage_Opponents((CHARACTER)S_CHA_Exterior_Bandit_Melee_01_538e38b9-e3a4-452a-8369-60eb1fe8c40d);
DB_Act1_TutorialEntities_HighGroundAdvantage_Opponents((CHARACTER)S_FOR_GnomeGoblin1_b2c582af-bc69-48b3-a004-648562dab404);
DB_Act1_TutorialEntities_HighGroundAdvantage_Opponents((CHARACTER)S_FOR_GnomeGoblin2_51300d83-e9f1-4f01-a27e-27c73f9e6318);
DB_Act1_TutorialEntities_HighGroundAdvantage_Opponents((CHARACTER)S_FOR_GnomeGoblin3_bff8ab5f-739d-422a-9ad3-92f4b897f1bc);
DB_Act1_TutorialEntities_HighGroundAdvantage_Opponents((CHARACTER)S_FOR_GnomeGoblin4_20eba5fb-3e93-4887-9700-d7fd7f2c418f);
DB_Act1_TutorialEntities_HighGroundAdvantage_Opponents((CHARACTER)S_FOR_GnomeGoblin5_0e54fa5d-e2dd-4e15-acbb-82a4e0c63012);
DB_Act1_TutorialEntities_HighGroundAdvantage_Opponents((CHARACTER)S_FOR_GnomeGoblin6_f0f4d3e2-8081-489a-b4ee-aee7b1ecee12);
DB_Act1_TutorialEntities_HighGroundAdvantage_Opponents((CHARACTER)S_FOR_GnomeGoblin7_4b2be2ad-f9e3-4aa0-9a0a-aae7f7813fd3);
DB_Act1_TutorialEntities_HighGroundAdvantage_Opponents((CHARACTER)S_FOR_Ambush_Goblins_Caster_01_826000b8-c6cd-4018-af55-31ee7e6a4668);
DB_Act1_TutorialEntities_HighGroundAdvantage_Opponents((CHARACTER)S_FOR_Ambush_Goblins_Caster_02_1f3d846e-f26c-49d4-b917-d9f43fd137b4);
DB_Act1_TutorialEntities_HighGroundAdvantage_Opponents((CHARACTER)S_FOR_Ambush_Goblins_Ranger_01_8e553c24-5100-4939-9041-4dec8499d553);
DB_Act1_TutorialEntities_HighGroundAdvantage_Opponents((CHARACTER)S_FOR_Ambush_Goblins_Ranger_02_70a50383-e377-45c0-a793-b44d36d2df55);
DB_Act1_TutorialEntities_HighGroundAdvantage_Opponents((CHARACTER)S_FOR_Ambush_Goblins_Ranger_03_e3d96e92-39fa-4ec1-9503-bd00f40285aa);
DB_Act1_TutorialEntities_HighGroundAdvantage_Opponents((CHARACTER)S_CRA_Escape_IntDevourer2_a2838af7-698b-8761-2004-d118d80cf848);
DB_Act1_TutorialEntities_HighGroundAdvantage_Opponents((CHARACTER)S_CRA_Escape_IntDevourer1_edd4c1c0-422f-82de-1b22-4a3d734da5c8);
DB_Act1_TutorialEntities_HighGroundAdvantage_Opponents((CHARACTER)S_CRA_Escape_IntDevourer3_c158fa86-3ecf-4d1b-a502-34618f77e3a9);

DB_GLO_Tutorials_Pickpocketing_Triggers((TRIGGER)S_Tutorials_Pickpocketing_01_a6161fdd-c562-4c44-bb87-e19a81677e00);
DB_GLO_Tutorials_Pickpocketing_Triggers((TRIGGER)S_Tutorials_Pickpocketing_02_7d96ec8a-3d1d-439d-be74-324f27a39a76);

DB_GLO_Tutorials_TargetCyclingItems_Triggers((TRIGGER)S_Tutorials_TargetCyclingItems_01_69bf2361-f567-48c2-9d40-20b8962126ff);
DB_GLO_Tutorials_TargetCyclingItems_Triggers((TRIGGER)S_Tutorials_TargetCyclingItems_02_1fc01d48-d86c-422b-89db-7f715a61a236);
DB_GLO_Tutorials_TargetCyclingItems_Triggers((TRIGGER)S_Tutorials_TargetCyclingItems_03_75080fd5-d500-468d-9a85-269f1a03e36d);
DB_GLO_Tutorials_TargetCyclingItems_Triggers((TRIGGER)S_Tutorials_TargetCyclingItems_04_16530fe8-402b-48ce-9606-bc78a2145fff);
DB_GLO_Tutorials_TargetCyclingItems_Triggers((TRIGGER)S_Tutorials_TargetCyclingItems_05_1f745ac4-af4d-4d4d-8b61-a7d1f82813b5);

PROC_TriggerRegisterForPlayers((TRIGGER)S_Tutorials_HighlightItems_01_0332d491-9971-4170-ac6e-c35bee53db95);

DB_GLO_Tutorials_CampTravellerChest_AllTriggers((TRIGGER)Act1_CAMP_GLO_Tutorials_TravellersChestTutorial_DungeonAbbey_dcedaf36-e07a-4958-8381-bace09915d4b);
DB_GLO_Tutorials_CampTravellerChest_AllTriggers((TRIGGER)Act1_CAMP_GLO_Tutorials_TravellersChestTutorial_Basement_06fd7bf0-04fc-418b-9241-b353926ddf45);
DB_GLO_Tutorials_CampTravellerChest_AllTriggers((TRIGGER)Act1_CAMP_GLO_Tutorials_TravellersChestTutorial_CaveGranite_abe5f3b3-800f-4399-9980-830b4f7bb457);
DB_GLO_Tutorials_CampTravellerChest_AllTriggers((TRIGGER)Act1_CAMP_GLO_Tutorials_TravellersChestTutorial_DungeonShar_3d80f141-13a0-4b1f-b739-34d5e86fd1c2);
DB_GLO_Tutorials_CampTravellerChest_AllTriggers((TRIGGER)Act1_CAMP_GLO_Tutorials_TravellersChestTutorial_MainCamp_01_34647f6f-4ecc-4cce-9804-776bf98dab88);
DB_GLO_Tutorials_CampTravellerChest_AllTriggers((TRIGGER)Act1_CAMP_GLO_Tutorials_TravellersChestTutorial_MainCamp_02_79651bae-b26e-472e-9607-abfec91945e7);
DB_GLO_Tutorials_CampTravellerChest_AllTriggers((TRIGGER)Act1_CAMP_GLO_Tutorials_TravellersChestTutorial_CaveSandstone_1e0de99d-6512-4af2-9ab5-af0a6efe4b9b);
DB_GLO_Tutorials_CampTravellerChest_AllTriggers((TRIGGER)Act1_CAMP_GLO_Tutorials_TravellersChestTutorial_Underdark_37d9d90a-c683-4c2d-a58e-d132170bd336);

DB_GLO_Tutorials_CampTravellerChestRoots((ITEMROOT)CONT_PlayerCampChest_A_96eab9d1-74b1-42f7-b1ad-061a9fcea8c4);
DB_GLO_Tutorials_CampTravellerChestRoots((ITEMROOT)CONT_PlayerCampChest_B_f68b5862-887c-4adf-b9f8-bb29e4d73b0f);
DB_GLO_Tutorials_CampTravellerChestRoots((ITEMROOT)CONT_PlayerCampChest_C_b5de2260-8e6b-4c2f-91eb-6f3133682a2f);
DB_GLO_Tutorials_CampTravellerChestRoots((ITEMROOT)CONT_PlayerCampChest_D_9b293d36-29f0-460c-bc81-2bdd4610a478);

DB_GLO_Tutorials_MovingObjects_Triggers((TRIGGER)S_Tutorials_MovingObjects_01_f923751f-d2fa-429f-8560-c74a6dfe00b4);
DB_GLO_Tutorials_MovingObjects_Triggers((TRIGGER)S_Tutorials_MovingObjects_02_bd1e53de-2ebb-4369-a238-8cd1fe670f11);
DB_GLO_Tutorials_MovingObjects_Triggers((TRIGGER)S_Tutorials_MovingObjects_03_f2f4bfd5-2855-4a9f-963b-d290358718e8);

DB_GLO_Tutorials_PingSystem_Triggers((TRIGGER)S_Tutorials_Ping_01_ed03f405-5311-4a64-9c88-5f7d7e98c444);
DB_GLO_Tutorials_PingSystem_Triggers((TRIGGER)S_Tutorials_Ping_02_209a2305-530f-4d47-8a3b-8c19f8dfab81);

DB_GLO_Tutorials_Outmatched_ExcludedEnemies((CHARACTER)S_DEN_GoblinRaider_001_6a03d0ff-a930-4347-bba2-9f3fd6bc317a);
DB_GLO_Tutorials_Outmatched_ExcludedEnemies((CHARACTER)S_GOB_AttackOnDen_Sapper_001_392146c2-0849-4250-b907-e4fb9a13ddcf);
DB_GLO_Tutorials_Outmatched_ExcludedEnemies((CHARACTER)S_DEN_Tiefling_008_03b6fae4-d250-4ce9-9a01-19cb427deb17);
DB_GLO_Tutorials_Outmatched_ExcludedEnemies((CHARACTER)S_DEN_TieflingLeader_475200ee-cc3c-4dbe-84b1-1820c02ea26a);
DB_GLO_Tutorials_Outmatched_ExcludedEnemies((CHARACTER)S_DEN_Tiefling_011_77439e86-3f60-4456-bd55-931e2f45654f);
DB_GLO_Tutorials_Outmatched_ExcludedEnemies((CHARACTER)S_DEN_Tiefling_004_c9562174-44af-4ffa-9e5e-da58538f23d8);
DB_GLO_Tutorials_Outmatched_ExcludedEnemies((CHARACTER)S_DEN_Tiefling_001_82f8662d-76da-4352-b37e-01ba433b5d43);
DB_GLO_Tutorials_Outmatched_ExcludedEnemies((CHARACTER)S_DEN_Weaponsmith_e2ad06ec-8034-479a-9f69-b86faea6dc79);
DB_GLO_Tutorials_Outmatched_ExcludedEnemies((CHARACTER)S_DEN_TieflingRefugee_RangerTrader_001_637d8d68-2a04-409e-a77d-cf31ac9478ee);
DB_GLO_Tutorials_Outmatched_ExcludedEnemies((CHARACTER)S_DEN_PrisonGuard_3ff71f38-28e9-4e72-ba17-9f6d3bb2a995);
DB_GLO_Tutorials_Outmatched_ExcludedEnemies((CHARACTER)S_GLO_IrritatedTiefling_65ad9da0-0efb-4cc3-bf82-c006f43dda6c);
DB_GLO_Tutorials_Outmatched_ExcludedEnemies((CHARACTER)S_DEN_Trainer_02025646-347a-4235-aef7-e46b7c94b435);
DB_GLO_Tutorials_Outmatched_ExcludedEnemies((CHARACTER)S_HAG_Hag_c457d064-83fb-4ec6-b74d-1f30dfafd12d);
DB_GLO_Tutorials_Outmatched_ExcludedEnemies((CHARACTER)S_GOB_DrowCommander_25721313-0c15-4935-8176-9f134385451b);
DB_GLO_Tutorials_Outmatched_ExcludedEnemies((CHARACTER)S_GLO_OathbreakerKnight_3939625d-86cc-4395-9d50-4f8b846c4231);
DB_GLO_Tutorials_Outmatched_ExcludedEnemies((CHARACTER)S_GLO_Halsin_7628bc0e-52b8-42a7-856a-13a6fd413323);
DB_GLO_Tutorials_Outmatched_ExcludedEnemies((CHARACTER)S_PLA_ZhentShipment_Spectator_2c214b80-1d72-431d-bc0b-1997a646c99b);
DB_GLO_Tutorials_Outmatched_ExcludedEnemies((CHARACTER)S_CRE_Templar_378ac93e-03a0-40b4-904c-f37989ac7a8c);

PROC_TriggerRegisterForPlayers(S_CRA_Escape_StartBox_53d01e20-6685-40f4-be98-5b967bf69e07);

DB_GLO_Tutorials_AdvancedMovement_Triggers((TRIGGER)S_Tutorials_AdvancedMovement_01_02afd033-7bf9-436e-b8eb-649c814ac7b9);
DB_GLO_Tutorials_AdvancedMovement_Triggers((TRIGGER)S_Tutorials_AdvancedMovement_02_580ed137-be30-4235-91c0-cddf4a48abcd);
DB_GLO_Tutorials_AdvancedMovement_Triggers((TRIGGER)S_Tutorials_AdvancedMovement_03_a98a98cf-d674-4b43-ab91-cff4e536101b);

PROC_TriggerRegisterForPlayers(S_Tutorials_GateCombatArea_add9f8e2-e578-42eb-b1bd-859f26ab7c9b);
KBSECTION
//REGION Tutorials
// Enemy Sightlines Tutorial
IF
StatusRemoved(_Player, "SNEAKING", _, _)
AND
DB_PartyMembers((CHARACTER)_Player)
AND
DB_Is_InCombat(_Player, _)
THEN
PROC_ShowUnifiedTutorialForPlayer((CHARACTER)_Player, (UNIFIEDTUTORIAL)Enemy_Sightlines_703761da-a5fa-4c67-ad79-d0c903aed948);


// Seeing in the Dark Tutorial
IF
DB_Act1_TutorialTriggers_SeeingInDark(_Trigger)
THEN
PROC_TriggerRegisterForParty(_Trigger);

IF // entering dark area
DB_InRegion(_Player, _Trigger)
AND
DB_Act1_TutorialTriggers_SeeingInDark(_Trigger)
THEN
PROC_GLO_Tutorials_EvaluateSeeingInTheDarkTutorial(_Player);

IF //for switching to characters who can't see
GainedControl(_Player)
AND
DB_InRegion(_Player, _Trigger)
AND
DB_Act1_TutorialTriggers_SeeingInDark(_Trigger)
THEN
PROC_GLO_Tutorials_EvaluateSeeingInTheDarkTutorial(_Player);

PROC
PROC_GLO_Tutorials_EvaluateSeeingInTheDarkTutorial((CHARACTER)_Player)
AND
HasPassive((GUIDSTRING)_Player,"Darkvision",0)
AND
HasPassive(_Player,"SuperiorDarkvision",0)
AND
HasActiveStatus(_Player, "LIGHT", 0)
AND
CanShowSpellForCharacter((CHARACTER)_Player, "Target_Light", 0)
AND
NOT QRY_GLO_Tutorials_HasTorchEquipped(_Player)
AND
NOT DB_Is_InCombat(_Player, _)
THEN
PROC_ShowUnifiedTutorialForPlayer((CHARACTER)_Player, (UNIFIEDTUTORIAL)Seeing_in_the_Dark_6416f467-7c3b-4470-9bfd-764fc67a2633);

QRY
QRY_GLO_Tutorials_HasTorchEquipped((CHARACTER)_Player)
AND
DB_EquippedItemSlots(_Slot)
AND
GetEquippedItem(_Player,_Slot,_Torch)
AND
IsTorch(_Torch,1)
THEN
DB_NOOP(1);

IF
CombatEnded(_)
AND
DB_PartyMembers(_Player)
AND
DB_InRegion(_Player, _Trigger)
AND
DB_Act1_TutorialTriggers_SeeingInDark(_Trigger)
THEN
PROC_GLO_Tutorials_EvaluateSeeingInTheDarkTutorial(_Player);


//Sneak Tutorial
IF
DB_Act1_TutorialTriggers_Sneak((TRIGGER)_Trigger)
THEN
PROC_TriggerRegisterForParty(_Trigger);

PROC
PROC_RevealAmbush((TRIGGER)S_FOR_Ambush_PerceptionTrigger_837f941a-db5b-49a2-b34d-f62e555c5acd, _Player)
AND
DB_Players(_OtherPlayer)
AND
QRY_IsInRange(_OtherPlayer, _OtherPlayer, 20.0)
THEN
PROC_ShowUnifiedTutorialForPlayer(_OtherPlayer, (UNIFIEDTUTORIAL)Sneak_afe064b0-ac1c-41ab-9ec9-f985dbcc3418);

IF 
DB_InRegion(_Player, _Trigger)
AND
DB_Act1_TutorialTriggers_Sneak(_Trigger)
AND
QRY_Act1_Tutorials_Sneak_ShoudlTriggerTutorial(_Trigger)
THEN
PROC_ShowUnifiedTutorialForPlayer((CHARACTER)_Player, (UNIFIEDTUTORIAL)Sneak_afe064b0-ac1c-41ab-9ec9-f985dbcc3418);

QRY
QRY_Act1_Tutorials_Sneak_ShoudlTriggerTutorial((TRIGGER)_Trigger)
AND
_Trigger == S_Tutorials_Sneak_01_202e3e76-f42f-45bf-bdac-e56163b28603
THEN
DB_NOOP(1);

QRY
QRY_Act1_Tutorials_Sneak_ShoudlTriggerTutorial((TRIGGER)_Trigger)
AND
DB_PartyFollowers((CHARACTER)S_DEN_CapturedGoblin_783d7572-a846-455f-b686-247a95263ebb)
AND
_Trigger == S_Tutorials_Sneak_02_6bb8607a-4938-4ac4-823f-be77404f9017
THEN
DB_NOOP(1);

QRY
QRY_Act1_Tutorials_Sneak_ShoudlTriggerTutorial((TRIGGER)_Trigger)
AND
_Trigger == S_Tutorials_Sneak_03_97d6bd8b-ca63-439a-b4d0-d67d4e39ff25
THEN
DB_NOOP(1);

QRY
QRY_Act1_Tutorials_Sneak_ShoudlTriggerTutorial((TRIGGER)_Trigger)
AND
_Trigger == S_Tutorials_Sneak_04_61d2b81f-34f2-4117-8614-55a865ea66a5
THEN
DB_NOOP(1);

QRY
QRY_Act1_Tutorials_Sneak_ShoudlTriggerTutorial((TRIGGER)_Trigger)
AND
_Trigger == S_Tutorials_Sneak_05_d39d00b2-64c2-40ee-a1f3-d5f3a61115a4
THEN
DB_NOOP(1);

IF //trigger Sneak_02 hide conditions
DB_Is_InCombat((GUIDSTRING)S_DEN_CapturedGoblin_783d7572-a846-455f-b686-247a95263ebb, _CombatID)
AND
DB_PartyFollowers((CHARACTER)S_DEN_CapturedGoblin_783d7572-a846-455f-b686-247a95263ebb)
AND
CharacterGetOwner((CHARACTER)S_DEN_CapturedGoblin_783d7572-a846-455f-b686-247a95263ebb, _Player)
AND
DB_Is_InCombat((GUIDSTRING)_Player, _CombatID)
THEN
HideTutorial((CHARACTER)_Player, (UNIFIEDTUTORIAL)Sneak_afe064b0-ac1c-41ab-9ec9-f985dbcc3418);


//Non Lethal Attacks
IF
DB_Is_InCombat(_NonLethalAttackOpponent, _CombatID)
AND
DB_Act1_TutorialEntities_NonLethalAttacks_Opponents((CHARACTER)_NonLethalAttackOpponent)
AND
DB_Players(_Player)
AND
DB_Is_InCombat((GUIDSTRING)_Player, _CombatID)
THEN
PROC_ShowUnifiedTutorialForPlayer((CHARACTER)_Player, (UNIFIEDTUTORIAL)Non_Lethal_Attacks_140eab81-0fe8-4c8b-8b28-1b4b632cda3e);

IF
TurnEnded(_Player)
AND
DB_Is_InCombat(_NonLethalAttackOpponent, _CombatID)
AND
DB_Act1_TutorialEntities_NonLethalAttacks_Opponents((CHARACTER)_NonLethalAttackOpponent)
AND
DB_Players((CHARACTER)_Player)
AND
DB_Is_InCombat((GUIDSTRING)_Player, _CombatID)
THEN
HideTutorial((CHARACTER)_Player, (UNIFIEDTUTORIAL)Non_Lethal_Attacks_140eab81-0fe8-4c8b-8b28-1b4b632cda3e);


//High Ground Bonus Tutorial
IF
CombatStarted(_CombatID)
AND
DB_Act1_TutorialEntities_HighGroundAdvantage_Opponents(_HighGroundOpponent)
AND
DB_Is_InCombat(_HighGroundOpponent, _CombatID)
AND
DB_PartyMembers(_Player)
AND
DB_Is_InCombat((GUIDSTRING)_Player, _CombatID)
THEN
PROC_ShowUnifiedTutorialForPlayer((CHARACTER)_Player, (UNIFIEDTUTORIAL)High_Ground_Advantage_29428463-06bb-4e0c-8c68-8cb7656f1f46);

IF //for late-comers
EnteredCombat(_Player, _CombatID)
AND
DB_CombatStarted(_CombatID)
AND
DB_PartyMembers((CHARACTER)_Player)
AND
DB_Act1_TutorialEntities_HighGroundAdvantage_Opponents(_HighGroundOpponent)
AND
DB_Is_InCombat(_HighGroundOpponent, _CombatID)
THEN
PROC_ShowUnifiedTutorialForPlayer((CHARACTER)_Player, (UNIFIEDTUTORIAL)High_Ground_Advantage_29428463-06bb-4e0c-8c68-8cb7656f1f46);


//Target Cycling (enemies) Tutorial (gamepad)
IF
DB_Is_InCombat(S_DEN_GoblinRaider_Captain_22d80f21-7f31-4240-b981-9137d53ad77d, _CombatId)
THEN
DB_GLO_Tutorials_DEN_PleaAtTheGate_CombatId(_CombatId);

IF
TurnStarted(_Player)
AND
DB_Is_InCombat(_Player, _CombatId)
AND
DB_GLO_Tutorials_DEN_PleaAtTheGate_CombatId(_CombatId)
AND
DB_Players((CHARACTER)_Player)
THEN
PROC_ShowUnifiedTutorialForPlayer((CHARACTER)_Player, (UNIFIEDTUTORIAL)Target_Cycling__Enemies__2707a1ee-a1a4-412e-9192-48309dfe7345);

// Pickpocketing Tutorial
IF
DB_GLO_Tutorials_Pickpocketing_Triggers(_Trigger)
THEN
PROC_TriggerRegisterForParty(_Trigger);

IF //record premature learning
RequestPickpocket(_Player, _)
THEN
SetTutorialShown((CHARACTER)_Player, (UNIFIEDTUTORIAL)Pickpocketing_c158eea5-cd10-4454-816a-b33cfebf8f28);

IF
DB_InRegion(_Player, _PickpocketingTrigger)
AND
DB_PartyMembers(_Player)
AND
DB_GLO_Tutorials_Pickpocketing_Triggers(_PickpocketingTrigger)
AND
QRY_GLO_Tutorials_AttemptStartPickpocketingTimerOrTestFinished(_Player)
THEN
DB_NOOP(1);

QRY
QRY_GLO_Tutorials_AttemptStartPickpocketingTimerOrTestFinished((CHARACTER)_Player)
AND
NOT DB_GLO_Tutorials_TrackedTimers((GUIDSTRING)_Player, "PickpocketingTutorial", _)
THEN
PROC_GLO_Tutorials_TrackedTimerStart((GUIDSTRING)_Player, "PickpocketingTutorial", 60000);

QRY
QRY_GLO_Tutorials_AttemptStartPickpocketingTimerOrTestFinished((CHARACTER)_Player)
AND
DB_GLO_Tutorials_TrackedTimers((GUIDSTRING)_Player, "PickpocketingTutorial", "Finished")
THEN
PROC_GLO_Tutorials_EvaluatePickpocketTutorial((CHARACTER)_Player);

PROC
PROC_GLO_Tutorials_TrackedTimerFinished(_Player, "PickpocketingTutorial")
THEN
PROC_GLO_Tutorials_EvaluatePickpocketTutorial((CHARACTER)_Player);

PROC
PROC_GLO_Tutorials_EvaluatePickpocketTutorial((CHARACTER)_Player)
AND
DB_GLO_Tutorials_Pickpocketing_Triggers(_PickpocketingTrigger)
AND
IsInTrigger((GUIDSTRING)_Player, _PickpocketingTrigger, 1)
AND
NOT DB_Is_InCombat((GUIDSTRING)_Player, _)
THEN
PROC_ShowUnifiedTutorialForPlayer((CHARACTER)_Player, (UNIFIEDTUTORIAL)Pickpocketing_c158eea5-cd10-4454-816a-b33cfebf8f28);


// Active Search Tutorial
PROC
PROC_DEN_RaidingParty_GoblinRaidEnded()
THEN
PROC_GLO_Tutorials_TrackedTimerStart("GLO_Tutorials_ActiveSearchDelay", 3000);

IF
DialogEnded(DEN_RaidingParty_OpenGate_0310abff-a694-177e-1aa0-a431556a3f3c, _)
THEN
PROC_GLO_Tutorials_EvaluateActiveSearchTutorial();

PROC
PROC_GLO_Tutorials_TrackedTimerFinished("GLO_Tutorials_ActiveSearchDelay")
THEN
PROC_GLO_Tutorials_EvaluateActiveSearchTutorial();

PROC
PROC_GLO_Tutorials_EvaluateActiveSearchTutorial()
AND
DB_Players(_Player)
AND
IsInTrigger(_Player, (TRIGGER)S_Tutorials_GateCombatArea_add9f8e2-e578-42eb-b1bd-859f26ab7c9b, 1)
THEN
PROC_ShowUnifiedTutorialForPlayer((CHARACTER)_Player, (UNIFIEDTUTORIAL)Active_Search_b1eb92d6-5e73-4e28-9c59-f52b5b0cb308);

IF
EnteredTrigger(_Player, S_Tutorials_GateCombatArea_add9f8e2-e578-42eb-b1bd-859f26ab7c9b)
AND
DB_GlobalFlag(DEN_RaidingParty_Quest_GoblinRaidOver_98712d90-c46b-20c4-c4df-02c0117e85a5)
THEN
PROC_ShowUnifiedTutorialForPlayer((CHARACTER)_Player, (UNIFIEDTUTORIAL)Active_Search_b1eb92d6-5e73-4e28-9c59-f52b5b0cb308);

IF
TutorialEvent(_Player, (TUTORIALEVENT)UserAction_ActiveSearch_Activated_7af4bc1f-0eed-44d5-88d4-f856b20aaecb)
THEN
SetTutorialShown(_Player, (UNIFIEDTUTORIAL)Active_Search_b1eb92d6-5e73-4e28-9c59-f52b5b0cb308);
HideTutorial(_Player, (UNIFIEDTUTORIAL)Active_Search_b1eb92d6-5e73-4e28-9c59-f52b5b0cb308);

IF
CombatEnded(_CombatId)
AND
DB_GLO_Tutorials_DEN_PleaAtTheGate_CombatId(_CombatId)
THEN
NOT DB_GLO_Tutorials_DEN_PleaAtTheGate_CombatId(_CombatId);


//Highlight Items (aka World Tooltips) Tutorial
IF
DB_InRegion(_Player, (TRIGGER)S_Tutorials_HighlightItems_01_0332d491-9971-4170-ac6e-c35bee53db95)
THEN
PROC_ShowUnifiedTutorialForPlayer(_Player, (UNIFIEDTUTORIAL)World_Tooltips_d21aef2e-4ad4-4666-958c-1f29da43d1d5);

IF
TutorialEvent(_Player, (TUTORIALEVENT)UserAction_DisplayWorldTooltips_26c70aed-2b7b-4562-baeb-c48d45f4879e)
THEN
HideTutorial(_Player, (UNIFIEDTUTORIAL)World_Tooltips_d21aef2e-4ad4-4666-958c-1f29da43d1d5);

IF
LeftTrigger(_Player, (TRIGGER)S_Tutorials_HighlightItems_01_0332d491-9971-4170-ac6e-c35bee53db95)
AND
DB_Players(_Player)
THEN
HideTutorial(_Player, (UNIFIEDTUTORIAL)World_Tooltips_d21aef2e-4ad4-4666-958c-1f29da43d1d5);

IF //must disable the event at a point that is guaranteed to happen later
LeftTrigger(_Player, (TRIGGER)S_Tutorials_HighlightItems_End_b20ad674-613f-407e-896c-5fb307a82de0)
AND
DB_Players(_Player)
THEN
DisableTutorialEvent(_Player, (TUTORIALEVENT)UserAction_DisplayWorldTooltips_26c70aed-2b7b-4562-baeb-c48d45f4879e);


//Traveller's Chest Tutorial
IF
DB_GLO_Tutorials_CampTravellerChest_AllTriggers(_Trigger)
THEN
PROC_TriggerRegisterForPlayers(_Trigger);
TriggerRegisterForItems(_Trigger);

IF
TemplateEnteredTrigger(_CampChest, _, _CampChestTrigger, _Owner, _)
AND
DB_GLO_Tutorials_CampTravellerChestRoots(_CampChest)
AND
DB_GLO_Tutorials_CampTravellerChest_AllTriggers(_CampChestTrigger)
THEN
DB_GLO_Tutorials_CampTravellerChest_RelevantTrigger(_CampChestTrigger);

PROC
PROC_CAMP_LastPlayerLeftCamp()
AND
DB_GLO_Tutorials_CampTravellerChest_RelevantTrigger(_Trigger)
THEN
NOT DB_GLO_Tutorials_CampTravellerChest_RelevantTrigger(_Trigger);

IF
DB_InRegion(_Player, _Trigger)
AND
DB_GLO_Tutorials_CampTravellerChest_RelevantTrigger(_Trigger)
THEN
PROC_ShowUnifiedTutorialForPlayer(_Player, (UNIFIEDTUTORIAL)Travellers_Chest_6091a3af-0c06-4f6f-90e8-ac6bf8687b67);

IF
TutorialEvent(_Player, (TUTORIALEVENT)SendToCamp_0204e362-7cbe-4d8b-b2d6-1884e5ff00e0)
THEN
PROC_ShowUnifiedTutorialForPlayer(_Player, (UNIFIEDTUTORIAL)Travellers_Chest_6091a3af-0c06-4f6f-90e8-ac6bf8687b67);

IF
TemplateUseStarted(_Player, (ITEMROOT)_CampChestRoot, _)
AND
DB_GLO_Tutorials_CampTravellerChestRoots((ITEMROOT)_CampChestRoot)
THEN
HideTutorial(_Player, (UNIFIEDTUTORIAL)Travellers_Chest_6091a3af-0c06-4f6f-90e8-ac6bf8687b67);


//REGION Your Journal + DLC items in chest tutorial

IF
TimerFinished("CRA_PerformAutosave")
THEN
DB_OnlyOnce("DLC_DLCRewardsInCamp_CanPromptMessage");

IF
TimerFinished("CRA_PerformAutosave")
AND
DB_Players(_Player)
THEN
PROC_GLO_Tutorials_ChainOptionalTutorial((CHARACTER)_Player,(UNIFIEDTUTORIAL)DLC_Items_0f69a7be-e9ae-4470-a371-f0ec7bad2ade,(UNIFIEDTUTORIAL)Your_Journal_504d7a73-a518-4a6e-ac55-6d47fe04f44d);

PROC
PROC_DLC_GiveReward((GUIDSTRING)_,(CHARACTER)_,1)
AND
QRY_OnlyOnce("DLC_Gustav_RewardsAreInCamp")
THEN
DB_NOOP(1);

//Show message prompt that rewards are in camp
//Shown once per user
QRY
QRY_GLO_Tutorials_ShouldShowOptionalTutorial((CHARACTER)_Player,(UNIFIEDTUTORIAL)DLC_Items_0f69a7be-e9ae-4470-a371-f0ec7bad2ade)
AND
DB_DLC_CampChestWithReward(_,_Player)
THEN
DB_NOOP(1);

QRY
QRY_GLO_Tutorials_ShouldShowOptionalTutorial((CHARACTER)_Player,(UNIFIEDTUTORIAL)Your_Journal_504d7a73-a518-4a6e-ac55-6d47fe04f44d)
AND
DB_InRegion(_Player,S_CRA_Escape_StartBox_53d01e20-6685-40f4-be98-5b967bf69e07)
THEN
DB_NOOP(1);

//If DLC installed after tutorial
PROC
PROC_DLC_GiveReward((GUIDSTRING)_,(CHARACTER)_,1)
AND
DB_OnlyOnce("DLC_DLCRewardsInCamp_CanPromptMessage")
AND
NOT DB_DLC_DLCRewardsInCamp_Message(1)
THEN
DB_DLC_DLCRewardsInCamp_Message(1);

IF
DB_DLC_DLCRewardsInCamp_Message(1)
AND
DB_DLC_CampChestWithReward(_,_Player)
THEN
PROC_ShowUnifiedTutorialForPlayer(_Player, (UNIFIEDTUTORIAL)DLC_Items_0f69a7be-e9ae-4470-a371-f0ec7bad2ade);

//END_REGION


//Moving objects Tutorial
IF
DB_GLO_Tutorials_MovingObjects_Triggers(_Trigger)
THEN
TriggerRegisterForPlayers(_Trigger);

IF
DB_InRegion(_Player, _Trigger)
AND
DB_GLO_Tutorials_MovingObjects_Triggers(_Trigger)
AND
DB_Players(_Player)
THEN
PROC_ShowUnifiedTutorialForPlayer(_Player, (UNIFIEDTUTORIAL)Moving_Objects_1c031b43-8c35-4563-ad06-255d293251ac);


//Target Cycling (items) Tutorial (gamepad)
IF
DB_GLO_Tutorials_TargetCyclingItems_Triggers(_Trigger)
THEN
PROC_TriggerRegisterForPlayers(_Trigger);

IF
DB_InRegion(_Player, _Trigger)
AND
DB_GLO_Tutorials_TargetCyclingItems_Triggers(_Trigger)
AND
NOT DB_Is_InCombat(_Player, _)
THEN
PROC_ShowUnifiedTutorialForPlayer((CHARACTER)_Player, (UNIFIEDTUTORIAL)Target_Cycling__Items__384d29df-237b-4b0d-af51-bcfd5571be33);


//Ping System Tutorial
IF
DB_GLO_Tutorials_PingSystem_Triggers(_Trigger)
THEN
PROC_TriggerRegisterForParty(_Trigger);

IF
DB_InRegion(_Player, _Trigger)
AND
DB_GLO_Tutorials_PingSystem_Triggers(_Trigger)
AND
QRY_IsMultiPlayer()
THEN
PROC_ShowUnifiedTutorialForPlayer((CHARACTER)_Player, (UNIFIEDTUTORIAL)Ping_System_317bfe49-8c4d-4947-8852-46dfa8b51ef9);


// Outmatched Tutorial
IF
EnteredCombat(_ExcludedEnemy, _ExcludedCombat)
AND
DB_GLO_Tutorials_Outmatched_ExcludedEnemies((CHARACTER)_ExcludedEnemy)
THEN
DB_GLO_Tutorials_Outmatched_ExcludedCombats(_ExcludedCombat);

IF //get enemy levels, cache the highest
EnteredCombat(_Enemy, _CombatID)
AND
NOT DB_PartyMembers((CHARACTER)_Enemy)
AND
IsCharacter((GUIDSTRING)_Enemy, 1)
AND
QRY_IsEnemyToAnyPlayerInCombat((CHARACTER)_Enemy, _CombatID)
AND
GetLevel(_Enemy,_Level)
THEN
DB_GLO_Tutorials_CombatEnemyLevelCache(_CombatID, _Level);

IF
DB_GLO_Tutorials_CombatEnemyLevelCache(_CombatID, _LevelNew)
AND
DB_GLO_Tutorials_CombatEnemyLevelCache(_CombatID, _LevelPrevious)
AND
_LevelNew > _LevelPrevious
THEN
NOT DB_GLO_Tutorials_CombatEnemyLevelCache(_CombatID, _LevelPrevious);

IF //fired at the end of adding combat participants
CombatStarted(_CombatID)
AND
DB_Is_InCombat(_Player, _CombatID)
AND
DB_PartyMembers((CHARACTER)_Player)
AND
NOT DB_GLO_Tutorials_Outmatched_ExcludedCombats(_CombatID)
AND
DB_GLO_Tutorials_CombatEnemyLevelCache(_CombatID, _HighestEnemyLevelInCombat)
THEN
PROC_GLO_Tutorials_CombatCheckPlayerCombatLevelTutorial(_CombatID, _Player, _HighestEnemyLevelInCombat);

IF //for late-coming player haracters
EnteredCombat(_Player, _CombatID)
AND
DB_CombatStarted(_CombatID) //ignore if still being added to the combat roster
AND
DB_PartyMembers((CHARACTER)_Player)
AND
DB_GLO_Tutorials_CombatEnemyLevelCache(_CombatID, _EnemyLevel)
AND
NOT DB_GLO_Tutorials_Outmatched_ExcludedCombats(_CombatID)
THEN
PROC_GLO_Tutorials_CombatCheckPlayerCombatLevelTutorial(_CombatID, (CHARACTER)_Player, _EnemyLevel);

PROC
PROC_GLO_Tutorials_CombatCheckPlayerCombatLevelTutorial((GUIDSTRING)_CombatID, (CHARACTER)_Player, (INTEGER)_EnemyLevel)
AND
GetLevel((GUIDSTRING)_Player, _PlayerLevel)
AND
IntegerSubtract(_EnemyLevel, _PlayerLevel, _LevelDiff)
AND
_LevelDiff > 1
THEN
PROC_ShowUnifiedTutorialForPlayer((CHARACTER)_Player, (UNIFIEDTUTORIAL)Outmatched_3b07be6d-5af5-4cfb-955d-b6fda15b461f);

IF
CombatEnded(_CombatID)
AND
DB_GLO_Tutorials_CombatEnemyLevelCache(_CombatID, _EnemyLevel)
THEN
NOT DB_GLO_Tutorials_CombatEnemyLevelCache(_CombatID, _EnemyLevel);

IF
CombatEnded(_CombatID)
AND
DB_GLO_Tutorials_Outmatched_ExcludedCombats(_CombatID)
THEN
NOT DB_GLO_Tutorials_Outmatched_ExcludedCombats(_CombatID);
//END_REGION

//REGION DB Cleanups
IF
DB_GlobalFlag((FLAG)Act2_PointOfNoReturnReached_a3155f30-b8f3-4db5-ac21-d3036f4426e3)
AND
DB_Act1_TutorialTriggers_SeeingInDark(_SeeingInDark)
THEN
PROC_TriggerUnregisterForParty(_SeeingInDark);

IF
DB_GlobalFlag((FLAG)Act2_PointOfNoReturnReached_a3155f30-b8f3-4db5-ac21-d3036f4426e3)
AND
DB_Act1_TutorialTriggers_Sneak(_Sneak)
THEN
PROC_TriggerUnregisterForParty(_Sneak);

IF
DB_GlobalFlag((FLAG)Act2_PointOfNoReturnReached_a3155f30-b8f3-4db5-ac21-d3036f4426e3)
AND
DB_GLO_Tutorials_Pickpocketing_Triggers(_Pickpocketing)
AND
DB_GLO_Tutorials_TrackedTimers(_Object, "PickpocketingTutorial", "Finished")
THEN
PROC_TriggerUnregisterForParty(_Pickpocketing);
NOT DB_GLO_Tutorials_TrackedTimers(_Object, "PickpocketingTutorial", "Finished");

IF
DB_GlobalFlag((FLAG)Act2_PointOfNoReturnReached_a3155f30-b8f3-4db5-ac21-d3036f4426e3)
AND 
DB_GLO_Tutorials_TargetCyclingItems_Triggers(_TargetCyclingItems)
THEN
PROC_TriggerUnregisterForPlayers(_TargetCyclingItems);

IF
DB_GlobalFlag((FLAG)Act2_PointOfNoReturnReached_a3155f30-b8f3-4db5-ac21-d3036f4426e3)
AND 
DB_GLO_Tutorials_PingSystem_Triggers(_PingSystem)
THEN
PROC_TriggerUnregisterForPlayers(_PingSystem);

IF
DB_GlobalFlag((FLAG)Act2_PointOfNoReturnReached_a3155f30-b8f3-4db5-ac21-d3036f4426e3)
AND
DB_GLO_Tutorials_CampTravellerChest_AllTriggers(_Trigger)
THEN
PROC_TriggerUnregisterForItemsWhenInLevel(_Trigger,"WLD_Main_A");

IF
DB_GlobalFlag((FLAG)Act2_PointOfNoReturnReached_a3155f30-b8f3-4db5-ac21-d3036f4426e3)
THEN
SysClear("DB_Act1_TutorialTriggers_SeeingInDark", 1);
SysClear("DB_Act1_TutorialTriggers_Sneak", 1);
SysClear("DB_Act1_TutorialEntities_NonLethalAttacks_Opponents", 1);
SysClear("DB_Act1_TutorialEntities_HighGroundAdvantage_Opponents", 1);
SysClear("DB_GLO_Tutorials_Pickpocketing_Triggers", 1);
SysClear("DB_GLO_Tutorials_CampTravellerChest_AllTriggers", 1);
SysClear("DB_GLO_Tutorials_TargetCyclingItems_Triggers", 1);
SysClear("DB_GLO_Tutorials_PingSystem_Triggers", 1);
SysClear("DB_GLO_Tutorials_CampTravellerChestRoots", 1);
//END_REGION

IF
DB_GLO_Tutorials_AdvancedMovement_Triggers(_Trigger)
THEN
PROC_TriggerRegisterForParty(_Trigger);

IF
FlagSet(Act2_PointOfNoReturnReached_a3155f30-b8f3-4db5-ac21-d3036f4426e3, _, _)
THEN
PROC_TriggerUnregisterForPlayers(S_Tutorials_GateCombatArea_add9f8e2-e578-42eb-b1bd-859f26ab7c9b);

IF
DB_GlobalFlag((FLAG)Act2_PointOfNoReturnReached_a3155f30-b8f3-4db5-ac21-d3036f4426e3)
THEN
GoalCompleted;
EXITSECTION

ENDEXITSECTION
ParentTargetEdge "Act1"
