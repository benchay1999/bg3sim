Version 1
SubGoalCombiner SGC_AND
INITSECTION
DB_Dialogs(S_MOO_Cat_8da4c9e8-e962-4b58-a34c-da99c79a7e37, MOO_CatBusiness_0901be87-2a53-487a-7197-bc6bd23031bc);

PROC_SetCorpseOwner(S_MOO_DeadTadpole_4410c5a1-9c3f-4fe5-8a73-8873240c2705, S_MOO_Cat_8da4c9e8-e962-4b58-a34c-da99c79a7e37);

DB_ItemOwnerShipClearItem("SCL_Main_A", S_MOO_Cat_DockExit_a79049c3-28fc-4dfe-b6aa-eefe724c447f);

DB_GlobalFlagReactionAfterDialog(MOO_CatBusiness_Event_Flee_83ae60a1-9a6f-1995-bf2e-176caeced71e, MOO_CatBusiness_0901be87-2a53-487a-7197-bc6bd23031bc);

TriggerRegisterForCharacter(S_MOO_PlaygroundBox_fb14e417-6cba-4dea-a1ea-f2dcd9e5002c, S_MOO_DeadTadpole_4410c5a1-9c3f-4fe5-8a73-8873240c2705);
KBSECTION
IF
LeftTrigger(S_MOO_DeadTadpole_4410c5a1-9c3f-4fe5-8a73-8873240c2705, S_MOO_PlaygroundBox_fb14e417-6cba-4dea-a1ea-f2dcd9e5002c)
AND
NOT DB_GlobalFlag(MOO_CatBusiness_State_TadpoleMissing_acc24f97-970d-43a3-b204-0169444dd6e0)
THEN
SetFlag(MOO_CatBusiness_State_TadpoleMissing_acc24f97-970d-43a3-b204-0169444dd6e0);

IF
EnteredTrigger(S_MOO_DeadTadpole_4410c5a1-9c3f-4fe5-8a73-8873240c2705, S_MOO_PlaygroundBox_fb14e417-6cba-4dea-a1ea-f2dcd9e5002c)
AND
DB_GlobalFlag(MOO_CatBusiness_State_TadpoleMissing_acc24f97-970d-43a3-b204-0169444dd6e0)
THEN
ClearFlag(MOO_CatBusiness_State_TadpoleMissing_acc24f97-970d-43a3-b204-0169444dd6e0);

//Moved tadpole within trigger
QRY
QRY_CRIME_BlockRegisterCrime(_Criminal, _CrimeType, _, _, S_MOO_Cat_8da4c9e8-e962-4b58-a34c-da99c79a7e37, _)
AND
DB_Players(_Criminal)
AND
HasActiveStatus(S_MOO_Cat_8da4c9e8-e962-4b58-a34c-da99c79a7e37, "SLEEPING", 0)
AND
QRY_CRIME_IsCrimeFamilyMember(_CrimeType, "MoveOwnedCorpse")
AND
IsInTrigger(S_MOO_DeadTadpole_4410c5a1-9c3f-4fe5-8a73-8873240c2705, S_MOO_PlaygroundBox_fb14e417-6cba-4dea-a1ea-f2dcd9e5002c, 1)
AND
QRY_StartDialog(MOO_CatBusiness_AD_CrimeReaction_e536d0a9-eed4-8d9f-d842-57eb8bdeadde, S_MOO_Cat_8da4c9e8-e962-4b58-a34c-da99c79a7e37)
THEN
DB_NOOP(1);

QRY
QRY_CRIME_BlockRegisterCrime((CHARACTER)_Criminal,_CrimeType, S_MOO_DeadTadpole_4410c5a1-9c3f-4fe5-8a73-8873240c2705, S_MOO_Cat_8da4c9e8-e962-4b58-a34c-da99c79a7e37, _)
AND
DB_Players(_Criminal)
AND
QRY_CRIME_IsCrimeFamilyMember(_CrimeType, "PickUpOwnedCorpse")
AND
_CrimeType != "MOO_CatBusiness_PickedUpTadpole"
AND
GetPosition(_Criminal, _X, _Y, _Z)
THEN
PROC_CharacterRegisterCrimeWithPosition((CHARACTER)_Criminal, "MOO_CatBusiness_PickedUpTadpole",S_MOO_DeadTadpole_4410c5a1-9c3f-4fe5-8a73-8873240c2705, _X, _Y, _Z, S_MOO_Cat_8da4c9e8-e962-4b58-a34c-da99c79a7e37,0);

//Moved tadpole outside of trigger
QRY
QRY_CRIME_BlockRegisterCrime((CHARACTER)_Criminal,_CrimeType, S_MOO_DeadTadpole_4410c5a1-9c3f-4fe5-8a73-8873240c2705, S_MOO_Cat_8da4c9e8-e962-4b58-a34c-da99c79a7e37, _)
AND
DB_Players(_Criminal)
AND
QRY_CRIME_IsCrimeFamilyMember(_CrimeType, "MoveOwnedCorpse")
AND
IsInTrigger(S_MOO_DeadTadpole_4410c5a1-9c3f-4fe5-8a73-8873240c2705, S_MOO_PlaygroundBox_fb14e417-6cba-4dea-a1ea-f2dcd9e5002c, 0)
AND
_CrimeType != "MOO_CatBusiness_PickedUpTadpole"
AND
GetPosition(_Criminal, _X, _Y, _Z)
THEN
PROC_CharacterRegisterCrimeWithPosition((CHARACTER)_Criminal, "MOO_CatBusiness_PickedUpTadpole",S_MOO_DeadTadpole_4410c5a1-9c3f-4fe5-8a73-8873240c2705, _X, _Y, _Z, S_MOO_Cat_8da4c9e8-e962-4b58-a34c-da99c79a7e37,0);

IF
CharacterOnCrimeSensibleActionNotification(S_MOO_Cat_8da4c9e8-e962-4b58-a34c-da99c79a7e37, "SCL_Main_A_MOO", _ID, _, _, _Criminal, _, _, _, 1)
AND
CrimeGetType(_ID, "MOO_CatBusiness_PickedUpTadpole")
THEN
SetFlag(MOO_CatBusiness_State_PlayerTookTadpole_ccb494bb-c5f3-49fc-81ac-83d1a5db0e7e);

PROC
PROC_GlobalFlagReactionAfterDialog(MOO_CatBusiness_Event_Flee_83ae60a1-9a6f-1995-bf2e-176caeced71e)
THEN
PROC_CharacterMoveTo(S_MOO_Cat_8da4c9e8-e962-4b58-a34c-da99c79a7e37, S_MOO_Cat_DockEntrance_c584a23f-daf5-47b3-bccf-6d751e84c04b, "Run", "MOO_Cat_RunningAway");

IF
EntityEvent((CHARACTER)_Cat, "MOO_Cat_RunningAway")
THEN
PROC_PlayPerceptionRevealEffect(S_MOO_Cat_DockEntrance_c584a23f-daf5-47b3-bccf-6d751e84c04b, "MOO_Cat_RunAwayReveal"); 
Use(_Cat, S_MOO_Cat_DockEntrance_c584a23f-daf5-47b3-bccf-6d751e84c04b, "");
PROC_DisappearOutOfSight(_Cat, "Run", 0, "MOO_Cat_LeftTower");

IF
EntityEvent((CHARACTER)_Cat, "MOO_Cat_LeftTower")
THEN
GoalCompleted;

PROC
PROC_StateSet_PermaDefeated(S_MOO_Cat_8da4c9e8-e962-4b58-a34c-da99c79a7e37)
THEN 
GoalCompleted;
EXITSECTION

ENDEXITSECTION
ParentTargetEdge "Act2"
